import{d as B,u as P,r as x,w as W,c as H,a,e as R,f as m,l as S,h as tt,i as o,t as w,b as g,j as I,k as j,m as U,U as k,R as A,o as L,_ as V,F as et,y as at,z as st,n as O,D as lt,E as ot,s as nt,G as it,K as ut,x as dt,I as rt}from"./index-De4U6Qew.js";import{w as mt,a as vt,b as pt,P as ft}from"./Search-BRk08DvK.js";import{w as ct}from"./Total-DFmTiaob.js";import{w as wt}from"./index-DtELT80z.js";import{w as gt}from"./index-yMd_J0k7.js";const xt={class:"label"},_t={class:"red_dot"},bt={colspan:"3"},ht={class:"label"},kt={class:"red_dot"},yt={style:{width:"30%"}},$t={class:"label"},St={colspan:"3"},Ct=B({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(y,{emit:C}){const c=y,$=C,u=P().state,_=u.langs,d=x(!1),v=x({id:0,status:!0,name:"",sort:"0",remark:""});x({city_name:[],class_name:[]}),W(()=>c.show,s=>{d.value=s,s&&(v.value.id=c.data.id||0,v.value.status=typeof c.data.status<"u"?c.data.status:!0,v.value.name=c.data.name||"",v.value.sort=c.data.sort||"0",v.value.remark=c.data.remark||"")},{deep:!0});const f=s=>s.name.length<2||s.name.length>16?k.Toast("名称2～16字符!"):isNaN(s.sort)?k.Toast("请输入排序数字"):s,n=()=>{const s=f(v.value);if(!s)return;const l=k.Loading();A.Post("erp_base_category/save?lang="+u.lang,{token:u.token,data:s},p=>{l.clear();const{code:h,msg:D}=p.data;k.Toast(D),$("submit",h==0)})},i=()=>{$("update:show",!1)};return(s,l)=>(L(),H(R,{show:d.value,"onUpdate:show":l[5]||(l[5]=p=>d.value=p),title:y.title,width:"720px",bottom:"40px",onClose:l[6]||(l[6]=p=>i())},{bottom:a(()=>[m(U,{height:"40px",padding:"0 32px",onClick:l[4]||(l[4]=p=>n())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[m(wt,null,{default:a(()=>[...l[7]||(l[7]=[S("提示: 请认证填写如下信息",-1)])]),_:1}),m(j,null,{default:a(()=>[m(tt,null,{default:a(()=>[o("tr",null,[o("td",xt,[o("span",_t,w(g(_).status),1)]),o("td",bt,[m(gt,{value:v.value.status,"onUpdate:value":l[0]||(l[0]=p=>v.value.status=p)},null,8,["value"])])]),o("tr",null,[o("td",ht,[o("span",kt,w(g(_).name),1)]),o("td",null,[m(I,{value:v.value.name,"onUpdate:value":l[1]||(l[1]=p=>v.value.name=p),maxlength:"16"},null,8,["value"])]),l[8]||(l[8]=o("td",{class:"label"},[o("span",{class:"red_dot"},"排序")],-1)),o("td",yt,[m(I,{value:v.value.sort,"onUpdate:value":l[2]||(l[2]=p=>v.value.sort=p),maxlength:"4"},null,8,["value"])])]),o("tr",null,[o("td",$t,w(g(_).remark),1),o("td",St,[m(I,{value:v.value.remark,"onUpdate:value":l[3]||(l[3]=p=>v.value.remark=p),type:"textarea",height:"160px",maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),Tt=V(Ct,[["__scopeId","data-v-b308f7ac"]]),Ut=["innerHTML"],At=B({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(y,{emit:C}){const c=y,$=C,u=P().state,_=u.langs,d=x(!1);W(()=>c.show,n=>{d.value=n},{deep:!0});const v=()=>{const n=k.Loading();A.Post("erp_base_category/del?lang="+u.lang,{token:u.token,data:c.data},i=>{n.clear();const{code:s,msg:l}=i.data;k.Toast(l),$("submit",s==0)})},f=()=>{$("update:show",!1)};return(n,i)=>(L(),H(R,{show:d.value,"onUpdate:show":i[1]||(i[1]=s=>d.value=s),title:y.title||g(_).del,width:"360px",bottom:"40px",onClose:i[2]||(i[2]=s=>f())},{bottom:a(()=>[m(U,{effect:"dark",type:"danger",height:"40px",onClick:i[0]||(i[0]=s=>v())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[m(j,{lineHeight:"60px"},{default:a(()=>[o("span",{innerHTML:g(_).del_warn(y.data.length)},null,8,Ut)]),_:1})]),_:1},8,["show","title"]))}}),Lt=["innerHTML"],Dt=B({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(y,{emit:C}){const c=y,$=C,u=P().state,_=u.langs,d=x(!1);W(()=>c.show,n=>{d.value=n},{deep:!0});const v=()=>{const n=k.Loading();A.Post("erp_base_category/export?lang="+u.lang,{token:u.token,data:c.data,order:c.order},i=>{n.clear();const{code:s,msg:l,data:p}=i.data;k.Toast(l),s==0&&et.Down(p.path+p.filename,p.filename),$("submit",s==0)})},f=()=>{$("update:show",!1)};return(n,i)=>(L(),H(R,{show:d.value,"onUpdate:show":i[1]||(i[1]=s=>d.value=s),title:y.title||g(_).export,width:"360px",bottom:"40px",onClose:i[2]||(i[2]=s=>f())},{bottom:a(()=>[m(U,{height:"40px",padding:"0 32px",onClick:i[0]||(i[0]=s=>v())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[m(j,{lineHeight:"60px"},{default:a(()=>[o("span",{innerHTML:g(_).export_warn(y.num)},null,8,Lt)]),_:1})]),_:1},8,["show","title"]))}}),Bt=["innerHTML"],Pt={class:"app_action flex"},Ht={class:"app_action_tools scrollbar"},Mt={class:"app_action_search flex"},Nt={class:"app_ct"},It={class:"tCenter"},Wt={class:"tCenter"},Rt={class:"tCenter"},jt={class:"tCenter"},Ft={class:"tCenter"},Kt={key:1},Ot={class:"tCenter"},Vt={class:"tCenter"},zt={class:"app_page"},Et=B({__name:"index",setup(y){const C=x(!1),c=x(),b=P().state,u=b.langs,_=ft.isAction,d=x({show:!1,key:"",placeholder:"名称、备注",columns:[{label:"状态",value:"",slot:"status"},{label:u.name,value:"",name:"name"},{label:"制单员",value:"",name:"creator_name"},{label:"操作员",value:"",name:"operator_name"},{label:u.remark,value:"",name:"remark"}],status:""}),v=x({time:"",list:{}}),f=x({columns:[{title:"ID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:u.date,slot:"date",textAlign:"center",width:"120px",minWidth:"110px"},{title:"名称",index:"name",order:"",width:"160px",minWidth:"160px"},{title:"排序",slot:"sort",textAlign:"center",width:"60px",minWidth:"60px"},{title:u.status,index:"status",slot:"status",width:"60px",textAlign:"center"},{title:u.action,slot:"action",textAlign:"center",width:"90px"},{title:"制单员",slot:"creator_name",textAlign:"center",width:"90px"},{title:"操作员",slot:"operator_name",textAlign:"center",width:"90px"},{title:u.remark,index:"remark"}],data:[],num:0,total:0,order:""}),n=x({total:0,num:1,limit:100}),i=x({show:!1,title:"添加/编辑",data:{}}),s=x({show:!1,title:"删除",data:[]}),l=x({show:!1,title:"导出",num:0}),p=x({status_name:[]});at(()=>{b.token&&Z()}),st(()=>{C&&b.isLogin&&h()});const h=()=>{d.value.show=!1,f.value.data=[];const r=k.Loading();A.Post("erp_base_category/list?lang="+b.lang,{token:b.token,data:D(),page:n.value.num,limit:n.value.limit,order:f.value.order},t=>{r.clear();const{code:e,msg:T,time:M,data:N}=t.data;e===0?(v.value.time=M,f.value.data=N,F()):k.Toast(T)}),n.value.total=0,A.Post("erp_base_category/total?lang="+b.lang,{token:b.token,data:D()},t=>{const{code:e,msg:T,time:M,data:N}=t.data;e==0?(v.value.time=M,n.value.total=N.total):k.Toast(T)})},D=()=>{const r={key:d.value.key,status:d.value.status};for(let t of d.value.columns)t.name&&(r[t.name]=t.value);return r},z=(r,t)=>{f.value.num=r,f.value.total=t},E=r=>{f.value.order=r,h()},q=()=>{d.value.key="",d.value.status="";for(let r of d.value.columns)r.value="";f.value.order="",n.value.num=1,h()},F=()=>{it(()=>{f.value.num=0,c.value.checkboxAll(!1)})},K=(r,t={})=>{i.value.show=!0,i.value.data=t,r=="add"?i.value.title=u.add:r=="edit"&&(i.value.title=u.edit+"( "+t.name+" )")},G=r=>{r&&(i.value.show=!1,h())},J=()=>{s.value.show=!0;const r=c.value.getData();let t=[];for(let e of r)t.push(e.id);s.value.data=t},Q=r=>{r&&(s.value.show=!1,h())},X=r=>{l.value.show=!0,l.value.num=r},Y=r=>{r&&(l.value.show=!1,F())},Z=()=>{A.Post("erp_base_category/get_select?lang="+b.lang,{token:b.token},r=>{const{code:t,msg:e,data:T}=r.data;t==0?(p.value.status_name=T.status_name,C.value=!0):k.Toast(e)})};return(r,t)=>(L(),O(nt,null,[m(ct,{time:v.value.time,onRefresh:t[0]||(t[0]=e=>h())},{default:a(()=>[o("span",{innerHTML:g(u).sys_role_total(n.value.total)},null,8,Bt)]),_:1},8,["time"]),o("div",Pt,[o("div",Ht,[m(mt,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line"},{action:"export",slot:"export",is_action:!0}]},{add:a(()=>[m(U,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:t[1]||(t[1]=e=>K("add"))},{default:a(()=>[S(w(g(u).add),1)]),_:1})]),del:a(()=>[m(U,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:f.value.num==0,onClick:t[2]||(t[2]=e=>J())},{default:a(()=>[S(w(g(u).del)+"("+w(f.value.num)+")",1)]),_:1},8,["disabled"])]),line:a(()=>[...t[21]||(t[21]=[o("span",{class:"line"},"|",-1)])]),export:a(()=>[m(U,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!n.value.total,onClick:t[3]||(t[3]=e=>X(n.value.total))},{default:a(()=>[S(w(g(u).export)+"("+w(n.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),o("div",Mt,[m(vt,{show:d.value.show,"onUpdate:show":t[5]||(t[5]=e=>d.value.show=e),keys:d.value.key,"onUpdate:keys":t[6]||(t[6]=e=>d.value.key=e),columns:d.value.columns,onKeyup:t[7]||(t[7]=lt(e=>{n.value.num=1,h()},["enter"])),onSearch:t[8]||(t[8]=e=>{n.value.num=1,h()}),onReset:t[9]||(t[9]=e=>q())},{status:a(e=>[m(ut,{value:d.value.status,"onUpdate:value":t[4]||(t[4]=T=>d.value.status=T),options:p.value.status_name,placeholder:e.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),o("div",Nt,[m(ot,{ref_key:"tableList",ref:c,overflow:"auto",columns:f.value.columns,options:f.value.data,onOrderBy:E,onPartially:z},{id:a(e=>[o("div",It,w(e.id),1)]),date:a(e=>[o("div",Wt,[m(rt,{title:"创建: "+e.ctime+`
更新: `+e.utime},{default:a(()=>[S(w(e.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),sort:a(e=>[o("div",Rt,w(e.sort),1)]),status:a(e=>[o("div",jt,[o("span",{class:dt(e.status?"c_success":"c_danger")},w(e.status?g(u).enable:g(u).disable),3)])]),action:a(e=>[o("div",Ft,[g(_)("save")?(L(),H(U,{key:0,onClick:T=>K("edit",e)},{default:a(()=>[S(w(g(u).edit),1)]),_:1},8,["onClick"])):(L(),O("span",Kt,"-"))])]),creator_name:a(e=>[o("div",Ot,w(e.creator_name),1)]),operator_name:a(e=>[o("div",Vt,w(e.operator_name),1)]),_:1},8,["columns","options"])]),o("div",zt,[m(pt,{total:n.value.total,"onUpdate:total":t[10]||(t[10]=e=>n.value.total=e),page:n.value.num,"onUpdate:page":[t[11]||(t[11]=e=>n.value.num=e),t[12]||(t[12]=e=>h())],limit:n.value.limit,"onUpdate:limit":[t[13]||(t[13]=e=>n.value.limit=e),t[14]||(t[14]=e=>{n.value.num=1,h()})]},null,8,["total","page","limit"])]),m(Tt,{show:i.value.show,"onUpdate:show":t[15]||(t[15]=e=>i.value.show=e),title:i.value.title,data:i.value.data,onSubmit:t[16]||(t[16]=e=>G(e))},null,8,["show","title","data"]),m(At,{show:s.value.show,"onUpdate:show":t[17]||(t[17]=e=>s.value.show=e),data:s.value.data,onSubmit:t[18]||(t[18]=e=>Q(e))},null,8,["show","data"]),m(Dt,{show:l.value.show,"onUpdate:show":t[19]||(t[19]=e=>l.value.show=e),data:D(),order:f.value.order,num:l.value.num,onSubmit:t[20]||(t[20]=e=>Y(e))},null,8,["show","data","order","num"])],64))}}),Yt=V(Et,[["__scopeId","data-v-4bff94cb"]]);export{Yt as default};
