import{d as z,g as W,u as E,r as S,w as M,c as N,a as d,b as w,e as R,f,h as X,i as o,t as x,j as Y,k as q,l as U,m as L,U as C,R as O,o as m,F as Z,n as $,p as V,q as re,s as A,v as J,x as K,_ as ee,y as fe,z as pe,A as me}from"./index-CM4InG2j.js";import{w as ve}from"./Total-BwB9umOs.js";const ce={class:"label"},he=z({__name:"mkdir",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(g,{emit:F}){const _=g,{proxy:T}=W(),B=F,v=E().state,t=v.langs,i=S(!1);M(()=>_.show,l=>{i.value=l},{deep:!0});const y=l=>l.name.length<2||l.name.length>32?C.Toast(t.sys_file_verify_name):T.$parent.isExist(l.name)?C.Toast(t.sys_file_verify_name_exist):l,k=()=>{const l=y(_.data);if(!l)return;const n=C.Loading();O.Post("sys_file/mkdir?lang="+v.lang,{token:v.token,path:l.path,name:l.name},r=>{n.clear();const{code:c}=r.data;B("submit",c==0)})},u=()=>{B("update:show",!1)};return(l,n)=>(m(),N(R,{show:i.value,"onUpdate:show":n[2]||(n[2]=r=>i.value=r),title:g.title||w(t).mkdir,width:"420px",bottom:"40px",onClose:n[3]||(n[3]=r=>u())},{bottom:d(()=>[f(L,{height:"40px",padding:"0 32px",onClick:n[1]||(n[1]=r=>k())},{default:d(()=>[U(x(w(t).confirm),1)]),_:1})]),default:d(()=>[f(q,{lineHeight:"60px"},{default:d(()=>[f(X,null,{default:d(()=>[o("tr",null,[o("td",ce,x(w(t).folder),1),o("td",null,[f(Y,{value:g.data.name,"onUpdate:value":n[0]||(n[0]=r=>g.data.name=r),maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),we={class:"label"},ge=z({__name:"rename",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(g,{emit:F}){const _=g,{proxy:T}=W(),B=F,v=E().state,t=v.langs,i=S(!1);M(()=>_.show,l=>{i.value=l},{deep:!0});const y=l=>l.name.length<2||l.name.length>32?C.Toast(t.sys_file_verify_name):T.$parent.isExist(l.name)?C.Toast(t.sys_file_verify_name_exist):l,k=()=>{const l=y(_.data);if(!l)return;const n=C.Loading();O.Post("sys_file/rename?lang="+v.lang,{token:v.token,path:l.path,rename:l.rename,name:l.name},r=>{n.clear();const{code:c}=r.data;B("submit",c==0)})},u=()=>{B("update:show",!1)};return(l,n)=>(m(),N(R,{show:i.value,"onUpdate:show":n[2]||(n[2]=r=>i.value=r),title:g.title||w(t).rename,width:"420px",bottom:"40px",onClose:n[3]||(n[3]=r=>u())},{bottom:d(()=>[f(L,{height:"40px",padding:"0 32px",onClick:n[1]||(n[1]=r=>k())},{default:d(()=>[U(x(w(t).confirm),1)]),_:1})]),default:d(()=>[f(q,{lineHeight:"60px"},{default:d(()=>[f(X,null,{default:d(()=>[o("tr",null,[o("td",we,x(w(t).name),1),o("td",null,[f(Y,{value:g.data.name,"onUpdate:value":n[0]||(n[0]=r=>g.data.name=r),maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),_e=["innerHTML"],xe=z({__name:"remove",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(g,{emit:F}){const _=g,T=F,p=E().state,v=p.langs,t=S(!1);M(()=>_.show,u=>{t.value=u},{deep:!0});const i=u=>u.names.length<1?C.Toast(v.select):u,y=()=>{const u=i(_.data);if(!u)return;const l=C.Loading();O.Post("sys_file/remove?lang="+p.lang,{token:p.token,path:u.path,data:u.names},n=>{l.clear();const{code:r,msg:c}=n.data;C.Toast(c),T("submit",r==0)})},k=()=>{T("update:show",!1)};return(u,l)=>(m(),N(R,{show:t.value,"onUpdate:show":l[1]||(l[1]=n=>t.value=n),title:g.title||w(v).del,width:"360px",bottom:"40px",onClose:l[2]||(l[2]=n=>k())},{bottom:d(()=>[f(L,{effect:"dark",type:"danger",height:"40px",onClick:l[0]||(l[0]=n=>y())},{default:d(()=>[U(x(w(v).confirm),1)]),_:1})]),default:d(()=>[f(q,{lineHeight:"60px"},{default:d(()=>[o("span",{innerHTML:w(v).del_warn(g.data.names.length)},null,8,_e)]),_:1})]),_:1},8,["show","title"]))}}),ke=z({__name:"down",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(g,{emit:F}){const _=g,T=F,p=E().state,v=p.langs,t=S(!1);M(()=>_.show,k=>{t.value=k},{deep:!0});const i=()=>{const k=C.Loading();O.Post("sys_file/down?lang="+p.lang,{token:p.token,path:_.data.path,filename:_.data.filename},u=>{k.clear(),Z.DownBlob(u.data,_.data.filename),T("submit",!0)},()=>{C.Toast(v.network_err)},{responseType:"blob"})},y=()=>{T("update:show",!1)};return(k,u)=>(m(),N(R,{show:t.value,"onUpdate:show":u[1]||(u[1]=l=>t.value=l),title:g.title||w(v).download,width:"420px",bottom:"40px",onClose:u[2]||(u[2]=l=>y())},{bottom:d(()=>[f(L,{height:"40px",padding:"0 32px",onClick:u[0]||(u[0]=l=>i())},{default:d(()=>[U(x(w(v).confirm),1)]),_:1})]),default:d(()=>[f(q,{lineHeight:"60px"},{default:d(()=>[o("b",null,x(g.data.filename),1)]),_:1})]),_:1},8,["show","title"]))}}),ye={class:"file_up_top flex_center"},be={class:"file_up_body scrollbar"},$e={key:0,class:"file_up_list"},Ce={class:"img"},Se={key:1,class:"ui ui_image"},Te={class:"text nowrap"},Ue=["onClick"],Le={key:1,class:"null"},Be=z({__name:"upload",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(g,{emit:F}){const _=g,T=F,p=E().state,v=p.langs,t=S(!1),i=S([]);M(()=>_.show,c=>{t.value=c,c&&(i.value=_.data.files)},{deep:!0});const y=()=>{let c=0;Z.Select({multiple:!0,mimeType:[]},b=>{for(let h of b)u(h.name)||(c=i.value.length,i.value.push({path:_.data.path,name:h.name,state:0,load:0}),k(c,h))})},k=(c,b)=>{let h=new FormData;h.append("token",p.token),h.append("path",_.data.path),h.append("file",b),O.Post("sys_file/upload?lang="+p.lang,h,I=>{const{code:P}=I.data;P==0?(i.value[c].state=1,T("submit",!0)):(i.value[c].state=2,T("submit",!1))},I=>{C.Toast(v.network_err)},{headers:{"Content-Type":"multipart/form-data;charset=utf-8"},onUploadProgress:I=>{let P=I.loaded/I.total*100|0;i.value[c].load=P}})},u=c=>{for(let b of i.value)if(b.name==c)return!0;return!1},l=c=>{i.value.splice(c,1)},n=()=>{i.value.length!=0&&i.value.splice(0,i.value.length)},r=()=>{T("update:show",!1)};return(c,b)=>(m(),$("div",{class:"file_up",style:V({visibility:t.value?"inherit":"hidden"})},[f(re,{height:"100%",width:"320px",show:t.value,"onUpdate:show":b[2]||(b[2]=h=>t.value=h),position:"right",bgColor:"#F2F4F8",onClose:b[3]||(b[3]=h=>r())},{default:d(()=>[o("div",ye,[f(L,{effect:"text",type:"primary",padding:"0 8px",onClick:b[0]||(b[0]=h=>y())},{default:d(()=>[U(x(w(v).sys_file_select_file),1)]),_:1}),b[4]||(b[4]=o("span",null,"|",-1)),f(L,{effect:"text",type:"danger",padding:"0 8px",onClick:b[1]||(b[1]=h=>n()),disabled:i.value.length==0},{default:d(()=>[U(x(w(v).clear),1)]),_:1},8,["disabled"])]),o("div",be,[i.value.length>0?(m(),$("ul",$e,[(m(!0),$(A,null,J(i.value,(h,I)=>(m(),$("li",{class:"flex",key:I},[o("div",{class:"load",style:V({width:h.load+"%"})},null,4),o("div",Ce,[h.state==1?(m(),$("div",{key:0,style:V({backgroundImage:"url("+g.data.url+h.path+h.name+")"})},null,4)):(m(),$("i",Se))]),o("div",Te,x(h.name),1),o("i",{class:K(["ui close",h.state==1?"ui_close":"ui_more"]),title:"移除",onClick:P=>l(I)},null,10,Ue)]))),128))])):(m(),$("div",Le))])]),_:1},8,["show"])],4))}}),De=ee(Be,[["__scopeId","data-v-bbf2fb8c"]]),Fe=["innerHTML"],Ie={class:"app_action flex"},je={class:"flex"},He={class:"text"},Ne={class:"flex"},Pe={class:"app_ct none_search file_body scrollbar"},ze={key:0,class:"flex_left"},Ee={class:"file_center"},Oe=["onClick"],Me={class:"file"},Ve=["onClick"],Ae=["title"],Re={class:"file_center"},qe=["onClick"],Ge={class:"file"},Je=["onClick"],Ke={key:1,class:"ui ui_file"},Qe=["title"],We={key:1,class:"null"},Xe=z({__name:"index",setup(g,{expose:F}){const _=S(!1),B=E().state,p=B.langs,v=S({time:"",list:{}}),t=S({url:"",path:"/",check:!1,data:{path:"",dirNum:0,fileNum:0,size:0,folder:[],files:[]}}),i=S({show:!1,data:{path:"",name:""}}),y=S({show:!1,data:{path:"",name:"",rename:""}}),k=S({show:!1,data:{path:"",names:[]}}),u=S({show:!1,data:{path:"",filename:""}}),l=S({show:!1,data:{url:"",path:"",files:[]}}),n=S({show:!1,imgs:[],index:0});fe(()=>{_.value=!0}),pe(()=>{_&&B.isLogin&&r()});const r=()=>{const s=C.Loading();O.Post("sys_file/list?lang="+B.lang,{token:B.token,path:t.value.path},e=>{s.clear();const{code:a,msg:D,time:j,data:H}=e.data;a==0?(v.value.time=j,t.value.check=!1,t.value.url=H.url,t.value.data=H.list):C.Toast(D)})},c=s=>{t.value.check=s;const e=t.value.data.folder;for(let D in e)e[D].check=s;const a=t.value.data.files;for(let D in a)a[D].check=s},b=()=>{const s=t.value.path.split("/").filter(e=>e);if(s.length<=1)t.value.path="/";else{t.value.path="/";for(let e=0;e<s.length-1;e++)t.value.path+=s[e]+"/"}r()},h=s=>{t.value.path+=s+"/",r()},I=s=>{const e=de(s);if(!G(e)){u.value.show=!0,u.value.data={path:t.value.path,filename:s};return}let a=0,D=[],j=0;for(let H of t.value.data.files)G(H.ext)&&(s==H.name&&(a=j),D.push({label:H.name,value:t.value.url+t.value.path+H.name,size:H.size}),j++);D.length>0&&(n.value.show=!0,n.value.index=a,n.value.imgs=D)},P=()=>{i.value.show=!0,i.value.data.path=t.value.path},te=s=>{s&&(i.value.show=!1,r())},ae=()=>{const s=Q();if(!s)return C.Toast(p.select);y.value.show=!0,y.value.data.path=t.value.path,y.value.data.name=s[0],y.value.data.rename=s[0]},se=s=>{s&&(y.value.show=!1,r())},le=()=>{const s=Q();if(!s)return C.Toast(p.select);k.value.show=!0,k.value.data.path=t.value.path,k.value.data.names=s},ne=s=>{s&&(k.value.show=!1,r())},oe=s=>{s&&(u.value.show=!1,r())},ie=()=>{l.value.show=!0,l.value.data.url=t.value.url,l.value.data.path=t.value.path},ue=s=>{s&&r()},de=s=>{const e=s.lastIndexOf(".")+1,a=s.length;return s.substring(e,a)},Q=()=>{let s=[];for(let e of t.value.data.folder)e.check&&s.push(e.name);for(let e of t.value.data.files)e.check&&s.push(e.name);return s.length>0?s:!1},G=s=>["png","jpg","jpeg","gif","svg"].indexOf(s)>=0;return F({isExist:s=>{for(let e of t.value.data.folder)if(e.name==s)return!0;for(let e of t.value.data.files)if(e.name==s)return!0;return!1}}),(s,e)=>(m(),$(A,null,[f(ve,{time:v.value.time,onRefresh:e[0]||(e[0]=a=>r())},{default:d(()=>[o("span",{innerHTML:w(p).sys_file_total(t.value.data.dirNum,t.value.data.fileNum,t.value.data.size)},null,8,Fe)]),_:1},8,["time"]),o("div",Ie,[o("div",je,[t.value.path=="/"?(m(),N(L,{key:0,effect:"text",type:"primary",padding:"0 8px",disabled:""},{default:d(()=>[U(x(w(p).sys_file_rootdir),1)]),_:1})):(m(),N(L,{key:1,effect:"text",type:"primary",padding:"0 8px",onClick:e[1]||(e[1]=a=>b())},{default:d(()=>[U(x(w(p).sys_file_back),1)]),_:1})),e[19]||(e[19]=o("span",{class:"line"},"|",-1)),t.value.check?(m(),N(L,{key:3,effect:"text",type:"primary",padding:"0 8px",onClick:e[3]||(e[3]=a=>c(!1))},{default:d(()=>[U(x(w(p).select_not),1)]),_:1})):(m(),N(L,{key:2,effect:"text",type:"primary",padding:"0 8px",onClick:e[2]||(e[2]=a=>c(!0))},{default:d(()=>[U(x(w(p).select_all),1)]),_:1})),e[20]||(e[20]=o("span",{class:"line"},"|",-1)),o("span",He,x(t.value.path),1)]),o("div",Ne,[f(L,{icon:"ui ui_add",padding:"0 16px 0 8px",onClick:e[4]||(e[4]=a=>P())},{default:d(()=>[U(x(w(p).mkdir),1)]),_:1}),f(L,{icon:"ui ui_edit",padding:"0 16px 0 8px",onClick:e[5]||(e[5]=a=>ae())},{default:d(()=>[U(x(w(p).rename),1)]),_:1}),f(L,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",onClick:e[6]||(e[6]=a=>le())},{default:d(()=>[U(x(w(p).del),1)]),_:1}),e[21]||(e[21]=o("span",{class:"line"},"|",-1)),f(L,{effect:"dark",type:"primary",icon:"ui ui_upload",padding:"0 16px 0 8px",onClick:e[7]||(e[7]=a=>ie())},{default:d(()=>[U(x(w(p).upload),1)]),_:1})])]),o("div",Pe,[t.value.data.folder.length!=0||t.value.data.files.length!=0?(m(),$("ul",ze,[(m(!0),$(A,null,J(t.value.data.folder,(a,D)=>(m(),$("li",{key:"dir"+D,class:K(a.check?"file_active":"file_state")},[o("div",Ee,[o("div",{class:"file_click",onClick:j=>a.check=!a.check},e[22]||(e[22]=[o("i",{class:"check"},null,-1)]),8,Oe),o("div",Me,[o("div",{class:"file_ct",onClick:j=>h(a.name)},e[23]||(e[23]=[o("i",{class:"ui ui_folder"},null,-1)]),8,Ve),o("div",{class:"name nowrap",title:a.name},x(a.name),9,Ae)])])],2))),128)),(m(!0),$(A,null,J(t.value.data.files,(a,D)=>(m(),$("li",{key:"file"+D,class:K(a.check?"file_active":"file_state")},[o("div",Re,[o("div",{class:"file_click",onClick:j=>a.check=!a.check},e[24]||(e[24]=[o("i",{class:"check"},null,-1)]),8,qe),o("div",Ge,[o("div",{class:"file_ct",onClick:j=>I(a.name)},[G(a.ext)?(m(),$("div",{key:0,class:"file_img bgImg",style:V({backgroundImage:"url("+t.value.url+t.value.data.path+a.name+")"})},null,4)):(m(),$("i",Ke))],8,Je),o("div",{class:"name nowrap",title:a.name},x(a.name),9,Qe)])])],2))),128))])):(m(),$("div",We))]),f(he,{show:i.value.show,"onUpdate:show":e[8]||(e[8]=a=>i.value.show=a),data:i.value.data,onSubmit:e[9]||(e[9]=a=>te(a))},null,8,["show","data"]),f(ge,{show:y.value.show,"onUpdate:show":e[10]||(e[10]=a=>y.value.show=a),data:y.value.data,onSubmit:e[11]||(e[11]=a=>se(a))},null,8,["show","data"]),f(xe,{show:k.value.show,"onUpdate:show":e[12]||(e[12]=a=>k.value.show=a),data:k.value.data,onSubmit:e[13]||(e[13]=a=>ne(a))},null,8,["show","data"]),f(ke,{show:u.value.show,"onUpdate:show":e[14]||(e[14]=a=>u.value.show=a),data:u.value.data,onSubmit:e[15]||(e[15]=a=>oe(a))},null,8,["show","data"]),f(De,{show:l.value.show,"onUpdate:show":e[16]||(e[16]=a=>l.value.show=a),data:l.value.data,onSubmit:e[17]||(e[17]=a=>ue(a))},null,8,["show","data"]),f(me,{show:n.value.show,"onUpdate:show":e[18]||(e[18]=a=>n.value.show=a),index:n.value.index,options:n.value.imgs},null,8,["show","index","options"])],64))}}),tt=ee(Xe,[["__scopeId","data-v-360c8c07"]]);export{tt as default};
