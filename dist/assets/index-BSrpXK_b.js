import{d as j,u as O,r as x,w as q,c as Y,a as u,e as G,f as r,H as se,h as ne,i as s,t as _,b as f,j as M,k as J,l as $,m as L,U,R,S as F,o as A,E as Q,_ as X,F as oe,T as I,y as ue,z as ie,n as N,D as de,s as re,G as me,x as pe}from"./index-CnF5AvoE.js";import{d as K,w as ve,a as fe,b as _e,c as ye,P as ce}from"./Search-CvnSry-k.js";import{w as ge}from"./index-Cz1UrKEg.js";import{w as we}from"./index-GCe5NAAQ.js";import{w as xe}from"./Total-D1VoWU1A.js";import{w as ke}from"./index-DYzwSGVj.js";import{w as be}from"./index-Byh7Ej69.js";import{w as he}from"./index-D2Wb6jXq.js";const $e={class:"label"},Ue={colspan:"3"},Se={class:"label"},Ce={class:"label"},Te={colspan:"4",class:"c_info"},De={class:"label"},Ae={colspan:"3"},Le={class:"label"},Pe={class:"label"},Ie={class:"label"},Be={class:"label"},He={class:"label"},Re={colspan:"3"},Me=j({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(T,{emit:B}){const m=T,P=B,l=O().state,p=l.langs,n=x(!1),D=x("base"),w=x([{label:p.info,value:"base",slot:"base"},{label:p.sys_user_role,value:"sole",slot:"sole"},{label:p.sys_user_perm,value:"perm",slot:"perm"}]),a=x({id:0,status:!0,uname:"",passwd:"",type:"",role:"",nickname:"",name:"",department:"",position:"",remark:"",perm:""}),d=x({type_name:[],role_name:[],perm:[]});q(()=>m.show,y=>{n.value=y,y&&(a.value.id=m.data.id||0,a.value.status=typeof m.data.status<"u"?m.data.status:!0,a.value.uname=m.data.uname||m.data.tel||m.data.email||"",a.value.passwd=m.data.passwd||"",a.value.nickname=m.data.nickname||"",a.value.name=m.data.name||"",a.value.department=m.data.department||"",a.value.position=m.data.position||"",a.value.remark=m.data.remark||"",c(),a.value.type=typeof m.data.type<"u"?[m.data.type]:[],a.value.role=m.data.role||"",a.value.perm=m.data.perm||"",C())},{deep:!0});const c=()=>{R.Post("sys_user/get_select?lang="+l.lang,{token:l.token},y=>{const{code:o,msg:i,data:h}=y.data;o==0?(d.value.type_name=h.type_name,d.value.role_name=h.role_name,Q(()=>{a.value.type=typeof m.data.type<"u"?[parseInt(m.data.type)]:[],a.value.role=m.data.role||""})):U.Toast(i)})},C=()=>{R.Post("sys_user/get_perm?lang="+l.lang,{token:l.token,perm:a.value.perm},y=>{const{code:o,data:i}=y.data;o==0&&(d.value.perm=i)})},k=y=>{let o={},i=[];for(let H of y)i=H.split(":"),o[i[0]]?o[i[0]]+=parseInt(i[1]):o[i[0]]=parseInt(i[1]);let h="";for(let H in o)h+=H+":"+o[H].toString()+" ";a.value.perm=h.trim()},b=y=>!F.IsRight("uname",y.uname)&&!F.IsRight("tel",y.uname)&&!F.IsRight("email",y.uname)?U.Toast(p.sys_user_verify_uname):(!y.id||y.passwd)&&!F.IsRight("passwd",y.passwd)?U.Toast(p.sys_user_verify_passwd):y,W=()=>{const y=b(a.value);if(!y)return;const o=U.Loading();R.Post("sys_user/save?lang="+l.lang,{token:l.token,data:y},i=>{o.clear();const{code:h,msg:H}=i.data;U.Toast(H),P("submit",h==0)})},V=()=>{P("update:show",!1)};return(y,o)=>(A(),Y(G,{show:n.value,"onUpdate:show":o[12]||(o[12]=i=>n.value=i),title:T.title,width:"720px",bottom:"40px",overflow:D.value=="perm"?"hidden auto":"hidden",onClose:o[13]||(o[13]=i=>V())},{bottom:u(()=>[r(L,{height:"40px",padding:"0 32px",onClick:o[11]||(o[11]=i=>W())},{default:u(()=>[$(_(f(p).confirm),1)]),_:1})]),default:u(()=>[r(J,{paddingY:"0"},{default:u(()=>[r(be,{value:D.value,"onUpdate:value":o[10]||(o[10]=i=>D.value=i),columns:w.value},{base:u(()=>[r(ne,null,{default:u(()=>[s("tr",null,[s("td",$e,_(f(p).status),1),s("td",Ue,[r(ke,{value:a.value.status,"onUpdate:value":o[0]||(o[0]=i=>a.value.status=i)},null,8,["value"])])]),s("tr",null,[s("td",Se,_(f(p).sys_user_uname),1),s("td",null,[r(M,{value:a.value.uname,"onUpdate:value":o[1]||(o[1]=i=>a.value.uname=i),placeholder:f(p).sys_user_uname_placeholder,maxlength:"16"},null,8,["value","placeholder"])]),s("td",Ce,_(f(p).sys_user_passwd),1),s("td",null,[r(M,{value:a.value.passwd,"onUpdate:value":o[2]||(o[2]=i=>a.value.passwd=i),placeholder:f(p).sys_user_passwd_placeholder,maxlength:"32"},null,8,["value","placeholder"])])]),s("tr",null,[s("td",Te,[s("b",null,_(f(p).sys_user_base),1)])]),s("tr",null,[s("td",De,_(f(p).sys_user_type),1),s("td",Ae,[r(K,{value:a.value.type,"onUpdate:value":o[3]||(o[3]=i=>a.value.type=i),options:d.value.type_name},null,8,["value","options"])])]),s("tr",null,[s("td",Le,_(f(p).sys_user_nickname),1),s("td",null,[r(M,{value:a.value.nickname,"onUpdate:value":o[4]||(o[4]=i=>a.value.nickname=i),maxlength:"16"},null,8,["value"])]),s("td",Pe,_(f(p).sys_user_name),1),s("td",null,[r(M,{value:a.value.name,"onUpdate:value":o[5]||(o[5]=i=>a.value.name=i),maxlength:"16"},null,8,["value"])])]),s("tr",null,[s("td",Ie,_(f(p).sys_user_department),1),s("td",null,[r(M,{value:a.value.department,"onUpdate:value":o[6]||(o[6]=i=>a.value.department=i),maxlength:"16"},null,8,["value"])]),s("td",Be,_(f(p).sys_user_position),1),s("td",null,[r(M,{value:a.value.position,"onUpdate:value":o[7]||(o[7]=i=>a.value.position=i),maxlength:"16"},null,8,["value"])])]),s("tr",null,[s("td",He,_(f(p).remark),1),s("td",Re,[r(M,{value:a.value.remark,"onUpdate:value":o[8]||(o[8]=i=>a.value.remark=i),type:"textarea",height:"120px",maxlength:"32"},null,8,["value"])])])]),_:1})]),sole:u(()=>[r(se,{value:a.value.role,"onUpdate:value":o[9]||(o[9]=i=>a.value.role=i),options:d.value.role_name},null,8,["value","options"])]),perm:u(()=>[r(he,{"onUpdate:value":k,options:d.value.perm},null,8,["options"])]),_:1},8,["value","columns"])]),_:1})]),_:1},8,["show","title","overflow"]))}}),Ye=X(Me,[["__scopeId","data-v-e9f5012c"]]),We=["innerHTML"],Fe=j({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(T,{emit:B}){const m=T,P=B,l=O().state,p=l.langs,n=x(!1);q(()=>m.show,a=>{n.value=a},{deep:!0});const D=()=>{const a=U.Loading();R.Post("sys_user/del?lang="+l.lang,{token:l.token,data:m.data},d=>{a.clear();const{code:c,msg:C,data:k}=d.data;U.Toast(C),P("submit",c==0)})},w=()=>{P("update:show",!1)};return(a,d)=>(A(),Y(G,{show:n.value,"onUpdate:show":d[1]||(d[1]=c=>n.value=c),title:T.title||f(p).del,width:"360px",bottom:"40px",onClose:d[2]||(d[2]=c=>w())},{bottom:u(()=>[r(L,{effect:"dark",type:"danger",height:"40px",onClick:d[0]||(d[0]=c=>D())},{default:u(()=>[$(_(f(p).confirm),1)]),_:1})]),default:u(()=>[r(J,{lineHeight:"60px"},{default:u(()=>[s("span",{innerHTML:f(p).del_warn(T.data.length)},null,8,We)]),_:1})]),_:1},8,["show","title"]))}}),Ne=["innerHTML"],je=j({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(T,{emit:B}){const m=T,P=B,l=O().state,p=l.langs,n=x(!1);q(()=>m.show,a=>{n.value=a},{deep:!0});const D=()=>{const a=U.Loading();R.Post("sys_user/export?lang="+l.lang,{token:l.token,data:m.data,order:m.order},d=>{a.clear();const{code:c,msg:C,data:k}=d.data;U.Toast(C),c==0&&oe.Down(k.path+k.filename,k.filename),P("submit",c==0)})},w=()=>{P("update:show",!1)};return(a,d)=>(A(),Y(G,{show:n.value,"onUpdate:show":d[1]||(d[1]=c=>n.value=c),title:T.title||f(p).export,width:"360px",bottom:"40px",onClose:d[2]||(d[2]=c=>w())},{bottom:u(()=>[r(L,{height:"40px",padding:"0 32px",onClick:d[0]||(d[0]=c=>D())},{default:u(()=>[$(_(f(p).confirm),1)]),_:1})]),default:u(()=>[r(J,{lineHeight:"60px"},{default:u(()=>[s("span",{innerHTML:f(p).export_warn(T.num)},null,8,Ne)]),_:1})]),_:1},8,["show","title"]))}}),Oe=["innerHTML"],Ve={class:"app_action flex"},ze={class:"app_action_tools scrollbar"},Ee={class:"app_action_search flex"},Ke={class:"app_ct"},qe={class:"tCenter"},Ge={class:"tCenter"},Je={class:"tCenter"},Qe={class:"flex_center"},Xe={class:"tCenter"},Ze={class:"tCenter"},et={key:1},tt={key:0,class:"tCenter"},at={key:1,class:"tCenter"},lt={class:"tCenter"},st={class:"app_page"},nt=j({__name:"index",setup(T){const B=x(!1),m=x(),S=O().state,l=S.langs,p=ce.isAction,n=x({show:!1,key:"",placeholder:"Fid、名称、接口等",time:[I.Date("Y/m/d",I.StrToTime("-1 year")),I.Date("Y/m/d")],maxDate:I.Date("Y/m/d"),columns:[{label:l.select,value:"",slot:"time"},{label:l.sys_user_type,value:"",slot:"type"},{label:l.sys_user_role,value:"",slot:"role"},{label:l.status,value:"",slot:"status"},{label:l.sys_user_uname,value:"",name:"uname"},{label:l.sys_user_nickname,value:"",name:"nickname"},{label:l.sys_user_department,value:"",name:"department"},{label:l.sys_user_position,value:"",name:"position"},{label:l.sys_user_name,value:"",name:"name"},{label:l.remark,value:"",name:"remark"}],type:"",role:"",status:""}),D=x({time:"",list:{}}),w=x({columns:[{title:"UID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:l.date,index:"date",slot:"date",width:"120px",minWidth:"110px",textAlign:"center"},{title:l.sys_user_type,index:"type",slot:"type",order:"",width:"80px",minWidth:"80px",textAlign:"center"},{title:l.sys_user_image,index:"img",slot:"img",width:"60px",minWidth:"60px",textAlign:"center"},{title:l.sys_user_uname,index:"uname",slot:"uname",order:"",width:"120px"},{title:l.status,index:"status",slot:"status",width:"60px",textAlign:"center"},{title:l.action,index:"action",slot:"action",width:"60px",textAlign:"center"},{title:l.sys_user_perm,index:"perm",slot:"perm",width:"120px",textAlign:"center"},{title:l.sys_user_nickname,index:"nickname"},{title:l.sys_user_department,index:"department"},{title:l.sys_user_position,index:"position"},{title:l.sys_user_name,index:"name"},{title:l.sys_user_gender,index:"gender",slot:"gender",textAlign:"center"},{title:l.sys_user_birthday,index:"birthday"},{title:l.remark,index:"remark"}],data:[],num:0,total:0,order:""}),a=x({total:0,num:1,limit:100}),d=x({show:!1,title:"添加/编辑",type:"",data:{}}),c=x({show:!1,title:"删除",data:[]}),C=x({show:!1,title:"导出",num:0}),k=x({type_name:[],role_name:[],status_name:[]});ue(()=>{S.token&&le()}),ie(()=>{B&&S.isLogin&&b()});const b=()=>{n.value.show=!1,w.value.data=[];const v=U.Loading();R.Post("sys_user/list?lang="+S.lang,{token:S.token,data:W(),page:a.value.num,limit:a.value.limit,order:w.value.order},e=>{v.clear();const{code:t,msg:g,time:z,data:E}=e.data;t===0?(D.value.time=z,w.value.data=E,i()):U.Toast(g)}),a.value.total=0,R.Post("sys_user/total?lang="+S.lang,{token:S.token,data:W()},e=>{const{code:t,msg:g,time:z,data:E}=e.data;t==0?(D.value.time=z,a.value.total=E.total):U.Toast(g)})},W=()=>{const v={key:n.value.key,stime:typeof n.value.time[0]=="string"?n.value.time[0]:I.Date("Y/m/d",n.value.time[0]),etime:typeof n.value.time[1]=="string"?n.value.time[1]:I.Date("Y/m/d",n.value.time[1]),type:n.value.type,role:n.value.role,status:n.value.status};for(let e of n.value.columns)e.name&&(v[e.name]=e.value);return v},V=(v,e)=>{w.value.num=v,w.value.total=e},y=v=>{w.value.order=v,b()},o=()=>{n.value.time=[I.Date("Y/m/d",I.StrToTime("-3 year")),I.Date("Y/m/d")],n.value.key="",n.value.type="",n.value.role="",n.value.status="";for(let v of n.value.columns)v.value="";w.value.order="",a.value.num=1,b()},i=()=>{Q(()=>{m.value.checkboxAll(!1)})},h=(v,e)=>{d.value.show=!0,d.value.type=v,v=="add"?(d.value.title=l.add,d.value.data={}):v=="edit"?(d.value.title=l.edit+"( "+(e.uname||e.tel||e.email||"")+" )",d.value.data=e):v=="copy"&&(d.value.title=l.copy,e.id="",e.uname="",e.tel="",e.email="",d.value.data=e)},H=v=>{v&&(d.value.show=!1,b())},Z=()=>{c.value.show=!0;const v=m.value.getData();let e=[];for(let t of v)e.push(t.id);c.value.data=e},ee=v=>{v&&(c.value.show=!1,b())},te=v=>{C.value.show=!0,C.value.num=v},ae=v=>{v&&(C.value.show=!1,i())},le=()=>{R.Post("sys_user/get_select?lang="+S.lang,{token:S.token},v=>{const{code:e,msg:t,data:g}=v.data;e==0?(k.value.type_name=g.type_name,k.value.role_name=g.role_name,k.value.status_name=g.status_name,B.value=!0,b()):U.Toast(t)})};return(v,e)=>(A(),N(re,null,[r(xe,{time:D.value.time,onRefresh:e[0]||(e[0]=t=>b())},{default:u(()=>[s("span",{innerHTML:f(l).sys_user_total(a.value.total)},null,8,Oe)]),_:1},8,["time"]),s("div",Ve,[s("div",ze,[r(ve,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line"},{action:"export",slot:"export",is_action:!0}]},{add:u(()=>[r(L,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:e[1]||(e[1]=t=>h("add"))},{default:u(()=>[$(_(f(l).add),1)]),_:1})]),del:u(()=>[r(L,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:w.value.num==0,onClick:e[2]||(e[2]=t=>Z())},{default:u(()=>[$(_(f(l).del)+"("+_(w.value.num)+")",1)]),_:1},8,["disabled"])]),line:u(()=>e[23]||(e[23]=[s("span",{class:"line"},"|",-1)])),export:u(()=>[r(L,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!a.value.total,onClick:e[3]||(e[3]=t=>te(a.value.total))},{default:u(()=>[$(_(f(l).export)+"("+_(a.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),s("div",Ee,[r(fe,{show:n.value.show,"onUpdate:show":e[7]||(e[7]=t=>n.value.show=t),keys:n.value.key,"onUpdate:keys":e[8]||(e[8]=t=>n.value.key=t),columns:n.value.columns,onKeyup:e[9]||(e[9]=de(t=>{a.value.num=1,b()},["enter"])),onSearch:e[10]||(e[10]=t=>{a.value.num=1,b()}),onReset:e[11]||(e[11]=t=>o())},{time:u(t=>[r(me,{value:n.value.time,"onUpdate:value":e[4]||(e[4]=g=>n.value.time=g),range:"",maxDate:n.value.maxDate,placeholder:t.label},null,8,["value","maxDate","placeholder"])]),type:u(t=>[$(_(k.value.type_name||"123"),1)]),role:u(t=>[r(K,{value:n.value.role,"onUpdate:value":e[5]||(e[5]=g=>n.value.role=g),options:k.value.role_name,placeholder:t.label,clearable:""},null,8,["value","options","placeholder"])]),status:u(t=>[r(K,{value:n.value.status,"onUpdate:value":e[6]||(e[6]=g=>n.value.status=g),options:k.value.status_name,placeholder:t.label,clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),s("div",Ke,[r(_e,{ref_key:"tableList",ref:m,overflow:"auto",columns:w.value.columns,options:w.value.data,onOrderBy:y,onPartially:V},{id:u(t=>[s("div",qe,_(t.id),1)]),date:u(t=>[s("div",Ge,[r(ge,{title:"注册: "+t.rtime+`
更新: `+t.utime+`
登录: `+t.ltime+`
备注: `+t.remark},{default:u(()=>[$(_(t.ltime.substr(0,10)),1)]),_:2},1032,["title"])])]),type:u(t=>[s("div",Je,_(t.type_name||"-"),1)]),img:u(t=>[s("div",Qe,[r(we,{img:t.img,"onUpdate:img":g=>t.img=g},null,8,["img","onUpdate:img"])])]),uname:u(t=>[$(_(t.uname||t.tel||t.email),1)]),status:u(t=>[s("div",Xe,[s("span",{class:pe(t.status?"c_success":"c_danger")},_(t.status?f(l).enable:f(l).disable),3)])]),action:u(t=>[s("div",Ze,[f(p)("save")?(A(),Y(L,{key:0,onClick:g=>h("copy",t)},{default:u(()=>[$(_(f(l).copy),1)]),_:2},1032,["onClick"])):(A(),N("span",et,"-"))])]),perm:u(t=>[f(p)("save")?(A(),N("div",tt,[t.perm?(A(),Y(L,{key:0,effect:"text",type:"danger",padding:"0 8px",onClick:g=>h("edit",t)},{default:u(()=>e[24]||(e[24]=[$("私有")])),_:2},1032,["onClick"])):t.role?(A(),Y(L,{key:1,effect:"text",type:"primary",padding:"0 8px",onClick:g=>h("edit",t)},{default:u(()=>[$(_(t.role_name),1)]),_:2},1032,["onClick"])):(A(),Y(L,{key:2,effect:"text",type:"info",padding:"0 8px",onClick:g=>h("edit",t)},{default:u(()=>e[25]||(e[25]=[$("设置")])),_:2},1032,["onClick"]))])):(A(),N("div",at,"-"))]),gender:u(t=>[s("div",lt,_(t.gender||"-"),1)]),_:1},8,["columns","options"])]),s("div",st,[r(ye,{total:a.value.total,"onUpdate:total":e[12]||(e[12]=t=>a.value.total=t),page:a.value.num,"onUpdate:page":[e[13]||(e[13]=t=>a.value.num=t),e[14]||(e[14]=t=>b())],limit:a.value.limit,"onUpdate:limit":[e[15]||(e[15]=t=>a.value.limit=t),e[16]||(e[16]=t=>{a.value.num=1,b()})]},null,8,["total","page","limit"])]),r(Ye,{show:d.value.show,"onUpdate:show":e[17]||(e[17]=t=>d.value.show=t),title:d.value.title,data:d.value.data,onSubmit:e[18]||(e[18]=t=>H(t))},null,8,["show","title","data"]),r(Fe,{show:c.value.show,"onUpdate:show":e[19]||(e[19]=t=>c.value.show=t),data:c.value.data,onSubmit:e[20]||(e[20]=t=>ee(t))},null,8,["show","data"]),r(je,{show:C.value.show,"onUpdate:show":e[21]||(e[21]=t=>C.value.show=t),data:W(),order:w.value.order,num:C.value.num,onSubmit:e[22]||(e[22]=t=>ae(t))},null,8,["show","data","order","num"])],64))}}),ft=X(nt,[["__scopeId","data-v-98a7ced8"]]);export{ft as default};
