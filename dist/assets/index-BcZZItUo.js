import{d as F,g as ie,r as x,w as j,y as Z,n as R,s as ee,i as o,f as m,p as V,A as ue,t as c,o as b,_ as J,u as O,c as N,a as u,e as Q,G as de,h as re,b as f,j as M,k as X,l as D,m as P,U as I,R as z,S as W,D as te,F as me,T as B,z as pe,C as ve,E as ge,x as ce}from"./index-QdFGXrH_.js";import{w as fe,a as ye,f as G,b as we,c as _e,d as xe,e as ke,P as be}from"./index-x3mVJUkG.js";import{w as he}from"./index-BJaT0TwY.js";import{w as Se}from"./view-BteC4vyS.js";import{w as Ce}from"./Total-FgaZS3nf.js";import{w as $e}from"./index-Dh2OZf68.js";const Ue={ref:"wmImage"},Te=F({__name:"index",props:{img:{type:String,default:""},imgTitle:{type:String,default:""},width:{type:String,default:"32px"},height:{type:String,default:"32px"},radius:{type:String,default:"50%"},bgColor:{type:String,default:"#00000010"},icoSize:{type:String,default:"18px"},icoColor:{type:String,default:"#00000050"},isView:{type:Boolean,default:!0},redNum:{type:String,default:""},redBgColor:{type:String,default:"#FF3300"}},emits:["imgClick"],setup(v,{emit:L}){const r=v,{proxy:A}=ie(),C=L,l=x(!1),p=x(""),n=x(!1),S=x([]);j(()=>r.img,s=>{_()},{deep:!0}),Z(()=>{_()});const _=()=>{const s=A.$refs.wmImage;s.src=r.img,s.onload=()=>{l.value=!0,p.value=r.img}},a=s=>{C("imgClick",s),r.isView&&(n.value=!0,S.value=[{label:r.imgTitle||s,value:s}])};return(s,y)=>(b(),R(ee,null,[o("div",{class:"wm-image",style:V({width:v.width,height:v.height,lineHeight:"calc("+v.height+" + 4px)",borderRadius:v.radius,backgroundColor:v.bgColor})},[v.redNum!=""?(b(),R("span",{key:0,class:"rednum",style:V({backgroundColor:v.redBgColor})},c(v.redNum),5)):ue("",!0),o("img",Ue,null,512),v.img?l.value?(b(),R("div",{key:3,class:"img",style:V({backgroundImage:p.value?"url("+v.img+")":"",borderRadius:v.radius}),onClick:y[0]||(y[0]=h=>a(v.img))},null,4)):(b(),R("i",{key:2,class:"ui ui_loading loading",style:V({fontSize:v.icoSize})},null,4)):(b(),R("i",{key:1,class:"ui ui_image",style:V({fontSize:v.icoSize,color:v.icoColor})},null,4))],4),m(Se,{show:n.value,"onUpdate:show":y[1]||(y[1]=h=>n.value=h),options:S.value},null,8,["show","options"])],64))}}),De=J(Te,[["__scopeId","data-v-7ee900f5"]]),Ie={class:"label"},Ae={colspan:"3"},Le={class:"label"},Pe={class:"label"},Be={colspan:"4",class:"c_info"},Re={class:"label"},He={colspan:"3"},ze={class:"label"},Me={class:"label"},Ne={class:"label"},Ye={class:"label"},Ve={class:"label"},Fe={colspan:"3"},We=F({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(v,{emit:L}){const r=v,A=L,l=O().state,p=l.langs,n=x(!1),S=x("base"),_=x([{label:p.info,value:"base",slot:"base"},{label:p.sys_user_role,value:"sole",slot:"sole"},{label:p.sys_user_perm,value:"perm",slot:"perm"}]),a=x({id:0,status:!0,uname:"",passwd:"",type:"",role:"",nickname:"",name:"",department:"",position:"",remark:"",perm:""}),s=x({type_name:[],role_name:[],perm:[]});j(()=>r.show,w=>{n.value=w,w&&(a.value.id=r.data.id||0,a.value.status=typeof r.data.status<"u"?r.data.status:!0,a.value.uname=r.data.uname||r.data.tel||r.data.email||"",a.value.passwd=r.data.passwd||"",a.value.nickname=r.data.nickname||"",a.value.name=r.data.name||"",a.value.department=r.data.department||"",a.value.position=r.data.position||"",a.value.remark=r.data.remark||"",y(),a.value.type=typeof r.data.type<"u"?[r.data.type]:[],a.value.role=r.data.role||"",a.value.perm=r.data.perm||"",h())},{deep:!0});const y=()=>{z.Post("sys_user/get_select?lang="+l.lang,{token:l.token},w=>{const{code:i,msg:d,data:T}=w.data;i==0?(s.value.type_name=T.type_name,s.value.role_name=T.role_name,te(()=>{a.value.type=typeof r.data.type<"u"?[parseInt(r.data.type)]:[],a.value.role=r.data.role||""})):I.Toast(d)})},h=()=>{z.Post("sys_user/get_perm?lang="+l.lang,{token:l.token,perm:a.value.perm},w=>{const{code:i,data:d}=w.data;i==0&&(s.value.perm=d)})},$=w=>{let i={},d=[];for(let H of w)d=H.split(":"),i[d[0]]?i[d[0]]+=parseInt(d[1]):i[d[0]]=parseInt(d[1]);let T="";for(let H in i)T+=H+":"+i[H].toString()+" ";a.value.perm=T.trim()},U=w=>!W.IsRight("uname",w.uname)&&!W.IsRight("tel",w.uname)&&!W.IsRight("email",w.uname)?I.Toast(p.sys_user_verify_uname):(!w.id||w.passwd)&&!W.IsRight("passwd",w.passwd)?I.Toast(p.sys_user_verify_passwd):w,Y=()=>{const w=U(a.value);if(!w)return;const i=I.Loading();z.Post("sys_user/save?lang="+l.lang,{token:l.token,data:w},d=>{i.clear();const{code:T,msg:H}=d.data;I.Toast(H),A("submit",T==0)})},E=()=>{A("update:show",!1)};return(w,i)=>(b(),N(Q,{show:n.value,"onUpdate:show":i[12]||(i[12]=d=>n.value=d),title:v.title,width:"720px",bottom:"40px",overflow:S.value=="perm"?"hidden auto":"hidden",onClose:i[13]||(i[13]=d=>E())},{bottom:u(()=>[m(P,{height:"40px",padding:"0 32px",onClick:i[11]||(i[11]=d=>Y())},{default:u(()=>[D(c(f(p).confirm),1)]),_:1})]),default:u(()=>[m(X,{paddingY:"0"},{default:u(()=>[m(fe,{value:S.value,"onUpdate:value":i[10]||(i[10]=d=>S.value=d),columns:_.value},{base:u(()=>[m(re,null,{default:u(()=>[o("tr",null,[o("td",Ie,c(f(p).status),1),o("td",Ae,[m(ye,{value:a.value.status,"onUpdate:value":i[0]||(i[0]=d=>a.value.status=d)},null,8,["value"])])]),o("tr",null,[o("td",Le,c(f(p).sys_user_uname),1),o("td",null,[m(M,{value:a.value.uname,"onUpdate:value":i[1]||(i[1]=d=>a.value.uname=d),placeholder:f(p).sys_user_uname_placeholder,maxlength:"16"},null,8,["value","placeholder"])]),o("td",Pe,c(f(p).sys_user_passwd),1),o("td",null,[m(M,{value:a.value.passwd,"onUpdate:value":i[2]||(i[2]=d=>a.value.passwd=d),placeholder:f(p).sys_user_passwd_placeholder,maxlength:"32"},null,8,["value","placeholder"])])]),o("tr",null,[o("td",Be,[o("b",null,c(f(p).sys_user_base),1)])]),o("tr",null,[o("td",Re,c(f(p).sys_user_type),1),o("td",He,[m(G,{value:a.value.type,"onUpdate:value":i[3]||(i[3]=d=>a.value.type=d),options:s.value.type_name},null,8,["value","options"])])]),o("tr",null,[o("td",ze,c(f(p).sys_user_nickname),1),o("td",null,[m(M,{value:a.value.nickname,"onUpdate:value":i[4]||(i[4]=d=>a.value.nickname=d),maxlength:"16"},null,8,["value"])]),o("td",Me,c(f(p).sys_user_name),1),o("td",null,[m(M,{value:a.value.name,"onUpdate:value":i[5]||(i[5]=d=>a.value.name=d),maxlength:"16"},null,8,["value"])])]),o("tr",null,[o("td",Ne,c(f(p).sys_user_department),1),o("td",null,[m(M,{value:a.value.department,"onUpdate:value":i[6]||(i[6]=d=>a.value.department=d),maxlength:"16"},null,8,["value"])]),o("td",Ye,c(f(p).sys_user_position),1),o("td",null,[m(M,{value:a.value.position,"onUpdate:value":i[7]||(i[7]=d=>a.value.position=d),maxlength:"16"},null,8,["value"])])]),o("tr",null,[o("td",Ve,c(f(p).remark),1),o("td",Fe,[m(M,{value:a.value.remark,"onUpdate:value":i[8]||(i[8]=d=>a.value.remark=d),type:"textarea",height:"120px",maxlength:"32"},null,8,["value"])])])]),_:1})]),sole:u(()=>[m(de,{value:a.value.role,"onUpdate:value":i[9]||(i[9]=d=>a.value.role=d),options:s.value.role_name},null,8,["value","options"])]),perm:u(()=>[m($e,{"onUpdate:value":$,options:s.value.perm},null,8,["options"])]),_:1},8,["value","columns"])]),_:1})]),_:1},8,["show","title","overflow"]))}}),je=J(We,[["__scopeId","data-v-e9f5012c"]]),Oe=["innerHTML"],Ee=F({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(v,{emit:L}){const r=v,A=L,l=O().state,p=l.langs,n=x(!1);j(()=>r.show,a=>{n.value=a},{deep:!0});const S=()=>{const a=I.Loading();z.Post("sys_user/del?lang="+l.lang,{token:l.token,data:r.data},s=>{a.clear();const{code:y,msg:h,data:$}=s.data;I.Toast(h),A("submit",y==0)})},_=()=>{A("update:show",!1)};return(a,s)=>(b(),N(Q,{show:n.value,"onUpdate:show":s[1]||(s[1]=y=>n.value=y),title:v.title||f(p).del,width:"360px",bottom:"40px",onClose:s[2]||(s[2]=y=>_())},{bottom:u(()=>[m(P,{effect:"dark",type:"danger",height:"40px",onClick:s[0]||(s[0]=y=>S())},{default:u(()=>[D(c(f(p).confirm),1)]),_:1})]),default:u(()=>[m(X,{lineHeight:"60px"},{default:u(()=>[o("span",{innerHTML:f(p).del_warn(v.data.length)},null,8,Oe)]),_:1})]),_:1},8,["show","title"]))}}),Ke=["innerHTML"],qe=F({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(v,{emit:L}){const r=v,A=L,l=O().state,p=l.langs,n=x(!1);j(()=>r.show,a=>{n.value=a},{deep:!0});const S=()=>{const a=I.Loading();z.Post("sys_user/export?lang="+l.lang,{token:l.token,data:r.data,order:r.order},s=>{a.clear();const{code:y,msg:h,data:$}=s.data;I.Toast(h),y==0&&me.Down($.path+$.filename,$.filename),A("submit",y==0)})},_=()=>{A("update:show",!1)};return(a,s)=>(b(),N(Q,{show:n.value,"onUpdate:show":s[1]||(s[1]=y=>n.value=y),title:v.title||f(p).export,width:"360px",bottom:"40px",onClose:s[2]||(s[2]=y=>_())},{bottom:u(()=>[m(P,{height:"40px",padding:"0 32px",onClick:s[0]||(s[0]=y=>S())},{default:u(()=>[D(c(f(p).confirm),1)]),_:1})]),default:u(()=>[m(X,{lineHeight:"60px"},{default:u(()=>[o("span",{innerHTML:f(p).export_warn(v.num)},null,8,Ke)]),_:1})]),_:1},8,["show","title"]))}}),Ge=["innerHTML"],Je={class:"app_action flex"},Qe={class:"app_action_tools scrollbar"},Xe={class:"app_action_search flex"},Ze={class:"app_ct"},et={class:"tCenter"},tt={class:"tCenter"},at={class:"tCenter"},lt={class:"flex_center"},st={class:"tCenter"},nt={class:"tCenter"},ot={key:1},it={key:0,class:"tCenter"},ut={key:1,class:"tCenter"},dt={class:"tCenter"},rt={class:"app_page"},mt=F({__name:"index",setup(v){const L=x(!1),r=x(),C=O().state,l=C.langs,p=be.isAction,n=x({show:!1,key:"",placeholder:"Fid、名称、接口等",time:[B.Date("Y/m/d",B.StrToTime("-1 year")),B.Date("Y/m/d")],maxDate:B.Date("Y/m/d"),columns:[{label:l.select,value:"",slot:"time"},{label:l.sys_user_type,value:"",slot:"type"},{label:l.sys_user_role,value:"",slot:"role"},{label:l.status,value:"",slot:"status"},{label:l.sys_user_uname,value:"",name:"uname"},{label:l.sys_user_nickname,value:"",name:"nickname"},{label:l.sys_user_department,value:"",name:"department"},{label:l.sys_user_position,value:"",name:"position"},{label:l.sys_user_name,value:"",name:"name"},{label:l.remark,value:"",name:"remark"}],type:"",role:"",status:""}),S=x({time:"",list:{}}),_=x({columns:[{title:"UID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:l.date,index:"date",slot:"date",width:"120px",minWidth:"110px",textAlign:"center"},{title:l.sys_user_type,index:"type",slot:"type",order:"",width:"80px",minWidth:"80px",textAlign:"center"},{title:l.sys_user_image,index:"img",slot:"img",width:"60px",minWidth:"60px",textAlign:"center"},{title:l.sys_user_uname,index:"uname",slot:"uname",order:"",width:"120px"},{title:l.status,index:"status",slot:"status",width:"60px",textAlign:"center"},{title:l.action,index:"action",slot:"action",width:"60px",textAlign:"center"},{title:l.sys_user_perm,index:"perm",slot:"perm",width:"120px",textAlign:"center"},{title:l.sys_user_nickname,index:"nickname"},{title:l.sys_user_department,index:"department"},{title:l.sys_user_position,index:"position"},{title:l.sys_user_name,index:"name"},{title:l.sys_user_gender,index:"gender",slot:"gender",textAlign:"center"},{title:l.sys_user_birthday,index:"birthday"},{title:l.remark,index:"remark"}],data:[],num:0,total:0,order:""}),a=x({total:0,num:1,limit:100}),s=x({show:!1,title:"添加/编辑",type:"",data:{}}),y=x({show:!1,title:"删除",data:[]}),h=x({show:!1,title:"导出",num:0}),$=x({type_name:[],role_name:[],status_name:[]});Z(()=>{C.token&&oe()}),pe(()=>{L&&U()});const U=()=>{n.value.show=!1,_.value.data=[];const g=I.Loading();z.Post("sys_user/list?lang="+C.lang,{token:C.token,data:Y(),page:a.value.num,limit:a.value.limit,order:_.value.order},e=>{g.clear();const{code:t,msg:k,time:K,data:q}=e.data;t===0?(S.value.time=K,_.value.data=q,d()):I.Toast(k)}),a.value.total=0,z.Post("sys_user/total?lang="+C.lang,{token:C.token,data:Y()},e=>{const{code:t,msg:k,time:K,data:q}=e.data;t==0?(S.value.time=K,a.value.total=q.total):I.Toast(k)})},Y=()=>{const g={key:n.value.key,stime:typeof n.value.time[0]=="string"?n.value.time[0]:B.Date("Y/m/d",n.value.time[0]),etime:typeof n.value.time[1]=="string"?n.value.time[1]:B.Date("Y/m/d",n.value.time[1]),type:n.value.type,role:n.value.role,status:n.value.status};for(let e of n.value.columns)e.name&&(g[e.name]=e.value);return g},E=(g,e)=>{_.value.num=g,_.value.total=e},w=g=>{_.value.order=g,U()},i=()=>{n.value.time=[B.Date("Y/m/d",B.StrToTime("-3 year")),B.Date("Y/m/d")],n.value.key="",n.value.type="",n.value.role="",n.value.status="";for(let g of n.value.columns)g.value="";_.value.order="",a.value.num=1,U()},d=()=>{te(()=>{r.value.checkboxAll(!1)})},T=(g,e)=>{s.value.show=!0,s.value.type=g,g=="add"?(s.value.title=l.add,s.value.data={}):g=="edit"?(s.value.title=l.edit+"( "+(e.uname||e.tel||e.email||"")+" )",s.value.data=e):g=="copy"&&(s.value.title=l.copy,e.id="",e.uname="",e.tel="",e.email="",s.value.data=e)},H=g=>{g&&(s.value.show=!1,U())},ae=()=>{y.value.show=!0;const g=r.value.getData();let e=[];for(let t of g)e.push(t.id);y.value.data=e},le=g=>{g&&(y.value.show=!1,U())},se=g=>{h.value.show=!0,h.value.num=g},ne=g=>{g&&(h.value.show=!1,d())},oe=()=>{z.Post("sys_user/get_select?lang="+C.lang,{token:C.token},g=>{const{code:e,msg:t,data:k}=g.data;e==0?($.value.type_name=k.type_name,$.value.role_name=k.role_name,$.value.status_name=k.status_name,L.value=!0,U()):I.Toast(t)})};return(g,e)=>(b(),R(ee,null,[m(Ce,{time:S.value.time,onRefresh:e[0]||(e[0]=t=>U())},{default:u(()=>[o("span",{innerHTML:f(l).sys_user_total(a.value.total)},null,8,Ge)]),_:1},8,["time"]),o("div",Je,[o("div",Qe,[m(we,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line"},{action:"export",slot:"export",is_action:!0}]},{add:u(()=>[m(P,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:e[1]||(e[1]=t=>T("add"))},{default:u(()=>[D(c(f(l).add),1)]),_:1})]),del:u(()=>[m(P,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:_.value.num==0,onClick:e[2]||(e[2]=t=>ae())},{default:u(()=>[D(c(f(l).del)+"("+c(_.value.num)+")",1)]),_:1},8,["disabled"])]),line:u(()=>e[23]||(e[23]=[o("span",{class:"line"},"|",-1)])),export:u(()=>[m(P,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!a.value.total,onClick:e[3]||(e[3]=t=>se(a.value.total))},{default:u(()=>[D(c(f(l).export)+"("+c(a.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),o("div",Xe,[m(_e,{show:n.value.show,"onUpdate:show":e[7]||(e[7]=t=>n.value.show=t),keys:n.value.key,"onUpdate:keys":e[8]||(e[8]=t=>n.value.key=t),columns:n.value.columns,onKeyup:e[9]||(e[9]=ve(t=>U(),["enter"])),onSearch:e[10]||(e[10]=t=>U()),onReset:e[11]||(e[11]=t=>i())},{time:u(t=>[m(ge,{value:n.value.time,"onUpdate:value":e[4]||(e[4]=k=>n.value.time=k),range:"",maxDate:n.value.maxDate,placeholder:t.label},null,8,["value","maxDate","placeholder"])]),type:u(t=>[D(c($.value.type_name||"123"),1)]),role:u(t=>[m(G,{value:n.value.role,"onUpdate:value":e[5]||(e[5]=k=>n.value.role=k),options:$.value.role_name,placeholder:t.label,clearable:""},null,8,["value","options","placeholder"])]),status:u(t=>[m(G,{value:n.value.status,"onUpdate:value":e[6]||(e[6]=k=>n.value.status=k),options:$.value.status_name,placeholder:t.label,clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),o("div",Ze,[m(xe,{ref_key:"tableList",ref:r,overflow:"auto",columns:_.value.columns,options:_.value.data,onOrderBy:w,onPartially:E},{id:u(t=>[o("div",et,c(t.id),1)]),date:u(t=>[o("div",tt,[m(he,{title:"注册: "+t.rtime+`
更新: `+t.utime+`
登录: `+t.ltime+`
备注: `+t.remark},{default:u(()=>[D(c(t.ltime.substr(0,10)),1)]),_:2},1032,["title"])])]),type:u(t=>[o("div",at,c(t.type_name||"-"),1)]),img:u(t=>[o("div",lt,[m(De,{img:t.img,"onUpdate:img":k=>t.img=k},null,8,["img","onUpdate:img"])])]),uname:u(t=>[D(c(t.uname||t.tel||t.email),1)]),status:u(t=>[o("div",st,[o("span",{class:ce(t.status?"c_success":"c_danger")},c(t.status?f(l).enable:f(l).disable),3)])]),action:u(t=>[o("div",nt,[f(p)("save")?(b(),N(P,{key:0,onClick:k=>T("copy",t)},{default:u(()=>[D(c(f(l).copy),1)]),_:2},1032,["onClick"])):(b(),R("span",ot,"-"))])]),perm:u(t=>[f(p)("save")?(b(),R("div",it,[t.perm?(b(),N(P,{key:0,effect:"text",type:"danger",padding:"0 8px",onClick:k=>T("edit",t)},{default:u(()=>e[24]||(e[24]=[D("私有")])),_:2},1032,["onClick"])):t.role?(b(),N(P,{key:1,effect:"text",type:"primary",padding:"0 8px",onClick:k=>T("edit",t)},{default:u(()=>[D(c(t.role_name),1)]),_:2},1032,["onClick"])):(b(),N(P,{key:2,effect:"text",type:"info",padding:"0 8px",onClick:k=>T("edit",t)},{default:u(()=>e[25]||(e[25]=[D("设置")])),_:2},1032,["onClick"]))])):(b(),R("div",ut,"-"))]),gender:u(t=>[o("div",dt,c(t.gender||"-"),1)]),_:1},8,["columns","options"])]),o("div",rt,[m(ke,{total:a.value.total,"onUpdate:total":e[12]||(e[12]=t=>a.value.total=t),page:a.value.num,"onUpdate:page":[e[13]||(e[13]=t=>a.value.num=t),e[14]||(e[14]=t=>U())],limit:a.value.limit,"onUpdate:limit":[e[15]||(e[15]=t=>a.value.limit=t),e[16]||(e[16]=t=>{a.value.num=1,U()})]},null,8,["total","page","limit"])]),m(je,{show:s.value.show,"onUpdate:show":e[17]||(e[17]=t=>s.value.show=t),title:s.value.title,data:s.value.data,onSubmit:e[18]||(e[18]=t=>H(t))},null,8,["show","title","data"]),m(Ee,{show:y.value.show,"onUpdate:show":e[19]||(e[19]=t=>y.value.show=t),data:y.value.data,onSubmit:e[20]||(e[20]=t=>le(t))},null,8,["show","data"]),m(qe,{show:h.value.show,"onUpdate:show":e[21]||(e[21]=t=>h.value.show=t),data:Y(),order:_.value.order,num:h.value.num,onSubmit:e[22]||(e[22]=t=>ne(t))},null,8,["show","data","order","num"])],64))}}),wt=J(mt,[["__scopeId","data-v-f08a25c4"]]);export{wt as default};
