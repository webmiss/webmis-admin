import{d as W,u as H,r as h,w as j,c as M,a as s,e as K,f as i,l as S,h as at,i as a,t as w,b as x,j as I,K as P,k as O,m as A,U as b,R as D,o as B,G as q,_ as G,F as lt,y as st,z as ot,n as E,D as nt,E as it,s as ut,x as dt,I as rt}from"./index-De4U6Qew.js";import{w as vt,a as pt,b as mt,P as ct}from"./Search-BRk08DvK.js";import{w as ft}from"./Total-DFmTiaob.js";import{w as wt}from"./index-DtELT80z.js";import{w as gt}from"./index-yMd_J0k7.js";const xt={class:"label"},_t={class:"red_dot"},bt={class:"label"},ht={class:"red_dot"},yt={colspan:"3"},kt={class:"label"},$t={colspan:"3"},Ct=W({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,U=T,u=H().state,y=u.langs,o=h(!1),n=h({id:0,status:!0,city:"",class:"",fid:"",sort:"0",shop_id:"",name:"",remark:""}),f=h({city_name:[],class_name:[]});j(()=>c.show,v=>{o.value=v,v&&(n.value.id=c.data.id||0,n.value.status=typeof c.data.status<"u"?c.data.status:!0,n.value.fid=c.data.fid||"",n.value.sort=c.data.sort||"0",n.value.shop_id=c.data.shop_id||"",n.value.name=c.data.name||"",n.value.remark=c.data.remark||"",d())},{deep:!0});const d=()=>{n.value.city=[],n.value.class=[],D.Post("erp_base_shop/get_select?lang="+u.lang,{token:u.token},v=>{const{code:l,msg:p,data:L}=v.data;l==0?(f.value.city_name=L.city_name,f.value.class_name=L.class_name,q(()=>{n.value.city=typeof c.data.city<"u"?[c.data.city]:"",n.value.class=typeof c.data.class<"u"?[c.data.class]:""})):b.Toast(p)})},r=v=>v.fid.length<1?b.Toast("请输入所属事业部"):v.city.length<1?b.Toast("请选择城市"):v.class.length<1?b.Toast("请选择分类"):isNaN(v.sort)?b.Toast("请输入排序数字"):v.name.length<2||v.name.length>32?b.Toast("名称2～32字符!"):v,g=()=>{const v=r(n.value);if(!v)return;const l=b.Loading();D.Post("erp_base_shop/save?lang="+u.lang,{token:u.token,data:v},p=>{l.clear();const{code:L,msg:N}=p.data;b.Toast(N),U("submit",L==0)})},$=()=>{U("update:show",!1)};return(v,l)=>(B(),M(K,{show:o.value,"onUpdate:show":l[9]||(l[9]=p=>o.value=p),title:C.title,width:"720px",bottom:"40px",onClose:l[10]||(l[10]=p=>$())},{bottom:s(()=>[i(A,{height:"40px",padding:"0 32px",onClick:l[8]||(l[8]=p=>g())},{default:s(()=>[S(w(x(y).confirm),1)]),_:1})]),default:s(()=>[i(wt,null,{default:s(()=>[...l[11]||(l[11]=[S("提示: 请认证填写如下信息",-1)])]),_:1}),i(O,null,{default:s(()=>[i(at,null,{default:s(()=>[a("tr",null,[a("td",xt,[a("span",_t,w(x(y).status),1)]),a("td",null,[i(gt,{value:n.value.status,"onUpdate:value":l[0]||(l[0]=p=>n.value.status=p)},null,8,["value"])]),l[12]||(l[12]=a("td",{class:"label"},[a("span",{class:"red_dot"},"所属")],-1)),a("td",null,[i(I,{value:n.value.fid,"onUpdate:value":l[1]||(l[1]=p=>n.value.fid=p),maxlength:"16",placeholder:":FID:FID:"},null,8,["value"])])]),a("tr",null,[l[13]||(l[13]=a("td",{class:"label"},[a("span",{class:"red_dot"},"城市")],-1)),a("td",null,[i(P,{value:n.value.city,"onUpdate:value":l[2]||(l[2]=p=>n.value.city=p),options:f.value.city_name},null,8,["value","options"])]),l[14]||(l[14]=a("td",{class:"label"},[a("span",{class:"red_dot"},"分类")],-1)),a("td",null,[i(P,{value:n.value.class,"onUpdate:value":l[3]||(l[3]=p=>n.value.class=p),options:f.value.class_name},null,8,["value","options"])])]),a("tr",null,[l[15]||(l[15]=a("td",{class:"label"},[a("span",{class:"red_dot"},"店铺ID")],-1)),a("td",null,[i(I,{value:n.value.shop_id,"onUpdate:value":l[4]||(l[4]=p=>n.value.shop_id=p),maxlength:"8"},null,8,["value"])]),l[16]||(l[16]=a("td",{class:"label"},[a("span",{class:"red_dot"},"排序")],-1)),a("td",null,[i(I,{value:n.value.sort,"onUpdate:value":l[5]||(l[5]=p=>n.value.sort=p),maxlength:"4"},null,8,["value"])])]),a("tr",null,[a("td",bt,[a("span",ht,w(x(y).name),1)]),a("td",yt,[i(I,{value:n.value.name,"onUpdate:value":l[6]||(l[6]=p=>n.value.name=p),maxlength:"32"},null,8,["value"])])]),a("tr",null,[a("td",kt,w(x(y).remark),1),a("td",$t,[i(I,{value:n.value.remark,"onUpdate:value":l[7]||(l[7]=p=>n.value.remark=p),type:"textarea",height:"80px",maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),Ut=G(Ct,[["__scopeId","data-v-bb7c5b74"]]),St=["innerHTML"],Tt=W({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,U=T,u=H().state,y=u.langs,o=h(!1);j(()=>c.show,d=>{o.value=d},{deep:!0});const n=()=>{const d=b.Loading();D.Post("erp_base_shop/del?lang="+u.lang,{token:u.token,data:c.data},r=>{d.clear();const{code:g,msg:$}=r.data;b.Toast($),U("submit",g==0)})},f=()=>{U("update:show",!1)};return(d,r)=>(B(),M(K,{show:o.value,"onUpdate:show":r[1]||(r[1]=g=>o.value=g),title:C.title||x(y).del,width:"360px",bottom:"40px",onClose:r[2]||(r[2]=g=>f())},{bottom:s(()=>[i(A,{effect:"dark",type:"danger",height:"40px",onClick:r[0]||(r[0]=g=>n())},{default:s(()=>[S(w(x(y).confirm),1)]),_:1})]),default:s(()=>[i(O,{lineHeight:"60px"},{default:s(()=>[a("span",{innerHTML:x(y).del_warn(C.data.length)},null,8,St)]),_:1})]),_:1},8,["show","title"]))}}),At=["innerHTML"],Dt=W({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,U=T,u=H().state,y=u.langs,o=h(!1);j(()=>c.show,d=>{o.value=d},{deep:!0});const n=()=>{const d=b.Loading();D.Post("erp_base_shop/export?lang="+u.lang,{token:u.token,data:c.data,order:c.order},r=>{d.clear();const{code:g,msg:$,data:v}=r.data;b.Toast($),g==0&&lt.Down(v.path+v.filename,v.filename),U("submit",g==0)})},f=()=>{U("update:show",!1)};return(d,r)=>(B(),M(K,{show:o.value,"onUpdate:show":r[1]||(r[1]=g=>o.value=g),title:C.title||x(y).export,width:"360px",bottom:"40px",onClose:r[2]||(r[2]=g=>f())},{bottom:s(()=>[i(A,{height:"40px",padding:"0 32px",onClick:r[0]||(r[0]=g=>n())},{default:s(()=>[S(w(x(y).confirm),1)]),_:1})]),default:s(()=>[i(O,{lineHeight:"60px"},{default:s(()=>[a("span",{innerHTML:x(y).export_warn(C.num)},null,8,At)]),_:1})]),_:1},8,["show","title"]))}}),Lt=["innerHTML"],Pt={class:"app_action flex"},Bt={class:"app_action_tools scrollbar"},It={class:"app_action_search flex"},Wt={class:"app_ct"},Ht={class:"tCenter"},Mt={class:"tCenter"},Nt={class:"tCenter"},Ft={class:"tCenter"},Rt={class:"tCenter"},jt={class:"tCenter"},Kt={class:"tCenter"},Ot={class:"tCenter"},Vt={class:"tCenter"},zt={key:1},Et={class:"tCenter"},qt={class:"tCenter"},Gt={class:"app_page"},Jt=W({__name:"index",setup(C){const T=h(!1),c=h(),k=H().state,u=k.langs,y=ct.isAction,o=h({show:!1,key:"",placeholder:"名称、备注",columns:[{label:"城市",value:"",slot:"city"},{label:"分类",value:"",slot:"class"},{label:"事业部",value:"",slot:"fid"},{label:"状态",value:"",slot:"status"},{label:u.name,value:"",name:"name"},{label:"制单员",value:"",name:"creator_name"},{label:"操作员",value:"",name:"operator_name"},{label:u.remark,value:"",name:"remark"}],city:"",class:"",fid:"",status:""}),n=h({time:"",list:{}}),f=h({columns:[{title:"ID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:u.date,slot:"date",textAlign:"center",width:"120px",minWidth:"110px"},{title:"城市",index:"city",slot:"city",order:"",textAlign:"center",width:"60px",minWidth:"60px"},{title:"分类",slot:"class",index:"class",order:"",textAlign:"center",width:"60px",minWidth:"60px"},{title:"店铺ID",slot:"shop_id",index:"shop_id",order:"",width:"100px",minWidth:"100px"},{title:u.name,index:"name",order:"",width:"120px",minWidth:"80px"},{title:"所属",index:"fid",slot:"fid",order:"",textAlign:"center",width:"80px",minWidth:"60px"},{title:"排序",slot:"sort",textAlign:"center",width:"60px",minWidth:"60px"},{title:u.status,index:"status",slot:"status",width:"60px",textAlign:"center"},{title:u.action,slot:"action",textAlign:"center",width:"90px"},{title:"制单员",slot:"creator_name",textAlign:"center",width:"90px"},{title:"操作员",slot:"operator_name",textAlign:"center",width:"90px"},{title:u.remark,index:"remark"}],data:[],num:0,total:0,order:""}),d=h({total:0,num:1,limit:100}),r=h({show:!1,title:"添加/编辑",data:{}}),g=h({show:!1,title:"删除",data:[]}),$=h({show:!1,title:"导出",num:0}),v=h({city_name:[],class_name:[],org_name:[],status_name:[]});st(()=>{k.token&&et()}),ot(()=>{T&&k.isLogin&&l()});const l=()=>{o.value.show=!1,f.value.data=[];const m=b.Loading();D.Post("erp_base_shop/list?lang="+k.lang,{token:k.token,data:p(),page:d.value.num,limit:d.value.limit,order:f.value.order},e=>{m.clear();const{code:t,msg:_,time:F,data:R}=e.data;t===0?(n.value.time=F,f.value.data=R,V()):b.Toast(_)}),d.value.total=0,D.Post("erp_base_shop/total?lang="+k.lang,{token:k.token,data:p()},e=>{const{code:t,msg:_,time:F,data:R}=e.data;t==0?(n.value.time=F,d.value.total=R.total):b.Toast(_)})},p=()=>{const m={key:o.value.key,city:o.value.city,class:o.value.class,fid:o.value.fid,status:o.value.status};for(let e of o.value.columns)e.name&&(m[e.name]=e.value);return m},L=(m,e)=>{f.value.num=m,f.value.total=e},N=m=>{f.value.order=m,l()},J=()=>{o.value.key="",o.value.city="",o.value.class="",o.value.fid="",o.value.status="";for(let m of o.value.columns)m.value="";f.value.order="",d.value.num=1,l()},V=()=>{q(()=>{f.value.num=0,c.value.checkboxAll(!1)})},z=(m,e={})=>{r.value.show=!0,r.value.data=e,m=="add"?r.value.title=u.add:m=="edit"&&(r.value.title=u.edit+"( "+e.name+" )")},Q=m=>{m&&(r.value.show=!1,l())},X=()=>{g.value.show=!0;const m=c.value.getData();let e=[];for(let t of m)e.push(t.id);g.value.data=e},Y=m=>{m&&(g.value.show=!1,l())},Z=m=>{$.value.show=!0,$.value.num=m},tt=m=>{m&&($.value.show=!1,V())},et=()=>{D.Post("erp_base_shop/get_select?lang="+k.lang,{token:k.token},m=>{const{code:e,msg:t,data:_}=m.data;e==0?(v.value.city_name=_.city_name,v.value.class_name=_.class_name,v.value.org_name=_.org_name,v.value.status_name=_.status_name,T.value=!0):b.Toast(t)})};return(m,e)=>(B(),E(ut,null,[i(ft,{time:n.value.time,onRefresh:e[0]||(e[0]=t=>l())},{default:s(()=>[a("span",{innerHTML:x(u).sys_role_total(d.value.total)},null,8,Lt)]),_:1},8,["time"]),a("div",Pt,[a("div",Bt,[i(vt,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line1"},{action:"export",slot:"export",is_action:!0}]},{add:s(()=>[i(A,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:e[1]||(e[1]=t=>z("add"))},{default:s(()=>[S(w(x(u).add),1)]),_:1})]),del:s(()=>[i(A,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:f.value.num==0,onClick:e[2]||(e[2]=t=>X())},{default:s(()=>[S(w(x(u).del)+"("+w(f.value.num)+")",1)]),_:1},8,["disabled"])]),line1:s(()=>[...e[24]||(e[24]=[a("span",{class:"line"},"|",-1)])]),export:s(()=>[i(A,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!d.value.total,onClick:e[3]||(e[3]=t=>Z(d.value.total))},{default:s(()=>[S(w(x(u).export)+"("+w(d.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),a("div",It,[i(pt,{show:o.value.show,"onUpdate:show":e[8]||(e[8]=t=>o.value.show=t),keys:o.value.key,"onUpdate:keys":e[9]||(e[9]=t=>o.value.key=t),columns:o.value.columns,onKeyup:e[10]||(e[10]=nt(t=>{d.value.num=1,l()},["enter"])),onSearch:e[11]||(e[11]=t=>{d.value.num=1,l()}),onReset:e[12]||(e[12]=t=>J())},{city:s(t=>[i(P,{value:o.value.city,"onUpdate:value":e[4]||(e[4]=_=>o.value.city=_),options:v.value.city_name,placeholder:t.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),class:s(t=>[i(P,{value:o.value.class,"onUpdate:value":e[5]||(e[5]=_=>o.value.class=_),options:v.value.class_name,placeholder:t.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),fid:s(t=>[i(P,{value:o.value.fid,"onUpdate:value":e[6]||(e[6]=_=>o.value.fid=_),options:v.value.org_name,placeholder:t.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),status:s(t=>[i(P,{value:o.value.status,"onUpdate:value":e[7]||(e[7]=_=>o.value.status=_),options:v.value.status_name,placeholder:t.label,clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),a("div",Wt,[i(it,{ref_key:"tableList",ref:c,overflow:"auto",columns:f.value.columns,options:f.value.data,onOrderBy:N,onPartially:L},{id:s(t=>[a("div",Ht,w(t.id),1)]),date:s(t=>[a("div",Mt,[i(rt,{title:"创建: "+t.ctime+`
更新: `+t.utime},{default:s(()=>[S(w(t.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),city:s(t=>[a("div",Nt,w(t.city),1)]),class:s(t=>[a("div",Ft,w(t.class||"-"),1)]),shop_id:s(t=>[a("div",Rt,[a("b",null,w(t.shop_id),1)])]),fid:s(t=>[a("div",jt,w(t.org_name||"-"),1)]),sort:s(t=>[a("div",Kt,w(t.sort),1)]),status:s(t=>[a("div",Ot,[a("span",{class:dt(t.status?"c_success":"c_danger")},w(t.status?x(u).enable:x(u).disable),3)])]),action:s(t=>[a("div",Vt,[x(y)("save")?(B(),M(A,{key:0,onClick:_=>z("edit",t)},{default:s(()=>[S(w(x(u).edit),1)]),_:1},8,["onClick"])):(B(),E("span",zt,"-"))])]),creator_name:s(t=>[a("div",Et,w(t.creator_name),1)]),operator_name:s(t=>[a("div",qt,w(t.operator_name),1)]),_:1},8,["columns","options"])]),a("div",Gt,[i(mt,{total:d.value.total,"onUpdate:total":e[13]||(e[13]=t=>d.value.total=t),page:d.value.num,"onUpdate:page":[e[14]||(e[14]=t=>d.value.num=t),e[15]||(e[15]=t=>l())],limit:d.value.limit,"onUpdate:limit":[e[16]||(e[16]=t=>d.value.limit=t),e[17]||(e[17]=t=>{d.value.num=1,l()})]},null,8,["total","page","limit"])]),i(Ut,{show:r.value.show,"onUpdate:show":e[18]||(e[18]=t=>r.value.show=t),title:r.value.title,data:r.value.data,onSubmit:e[19]||(e[19]=t=>Q(t))},null,8,["show","title","data"]),i(Tt,{show:g.value.show,"onUpdate:show":e[20]||(e[20]=t=>g.value.show=t),data:g.value.data,onSubmit:e[21]||(e[21]=t=>Y(t))},null,8,["show","data"]),i(Dt,{show:$.value.show,"onUpdate:show":e[22]||(e[22]=t=>$.value.show=t),data:p(),order:f.value.order,num:$.value.num,onSubmit:e[23]||(e[23]=t=>tt(t))},null,8,["show","data","order","num"])],64))}}),ee=G(Jt,[["__scopeId","data-v-a697a397"]]);export{ee as default};
