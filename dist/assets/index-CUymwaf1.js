import{d as W,u as H,r as y,w as j,c as M,a as s,e as O,f as i,l as U,h as lt,i as a,t as g,b as x,j as I,k as V,m as A,U as _,R as D,o as B,G as q,_ as G,F as st,y as ot,z as nt,n as K,D as it,E as dt,s as ut,x as rt,I as vt}from"./index--Aaw8Kh1.js";import{c as P,w as pt,a as mt,b as ct,P as ft}from"./Search-DMryvUDg.js";import{w as gt}from"./Total-C1JsSOot.js";import{w as wt}from"./index-9lX5YKhj.js";import{w as xt}from"./index-Bf39PfWh.js";const _t={class:"label"},bt={class:"red_dot"},yt={class:"label"},ht={class:"red_dot"},kt={colspan:"3"},$t={class:"label"},Ct={colspan:"3"},Ut=W({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,S=T,d=H().state,k=d.langs,o=y(!1),n=y({id:0,state:!0,city:"",class:"",fid:"",sort:"0",shop_id:"",name:"",remark:""}),f=y({city_name:[],class_name:[]});j(()=>c.show,v=>{o.value=v,v&&(n.value.id=c.data.id||0,n.value.state=typeof c.data.state<"u"?c.data.state:!0,n.value.fid=c.data.fid||"",n.value.sort=c.data.sort||"0",n.value.shop_id=c.data.shop_id||"",n.value.name=c.data.name||"",n.value.remark=c.data.remark||"",u())},{deep:!0});const u=()=>{n.value.city=[],n.value.class=[],D.Post("erp_base_shop/get_select?lang="+d.lang,{token:d.token},v=>{const{code:l,msg:m,data:L}=v.data;l==0?(f.value.city_name=L.city_name,f.value.class_name=L.class_name,q(()=>{n.value.city=typeof c.data.city<"u"?[c.data.city]:"",n.value.class=typeof c.data.class<"u"?[c.data.class]:""})):_.Toast(m)})},r=v=>v.fid.length<1?_.Toast("请输入所属事业部"):v.city.length<1?_.Toast("请选择城市"):v.class.length<1?_.Toast("请选择分类"):isNaN(v.sort)?_.Toast("请输入排序数字"):v.name.length<2||v.name.length>32?_.Toast("名称2～32字符!"):v,w=()=>{const v=r(n.value);if(!v)return;const l=_.Loading();D.Post("erp_base_shop/save?lang="+d.lang,{token:d.token,data:v},m=>{l.clear();const{code:L,msg:N}=m.data;_.Toast(N),S("submit",L==0)})},$=()=>{S("update:show",!1)};return(v,l)=>(B(),M(O,{show:o.value,"onUpdate:show":l[9]||(l[9]=m=>o.value=m),title:C.title,width:"720px",bottom:"40px",onClose:l[10]||(l[10]=m=>$())},{bottom:s(()=>[i(A,{height:"40px",padding:"0 32px",onClick:l[8]||(l[8]=m=>w())},{default:s(()=>[U(g(x(k).confirm),1)]),_:1})]),default:s(()=>[i(wt,null,{default:s(()=>l[11]||(l[11]=[U("提示: 请认证填写如下信息")])),_:1}),i(V,null,{default:s(()=>[i(lt,null,{default:s(()=>[a("tr",null,[a("td",_t,[a("span",bt,g(x(k).status),1)]),a("td",null,[i(xt,{value:n.value.state,"onUpdate:value":l[0]||(l[0]=m=>n.value.state=m)},null,8,["value"])]),l[12]||(l[12]=a("td",{class:"label"},[a("span",{class:"red_dot"},"所属")],-1)),a("td",null,[i(I,{value:n.value.fid,"onUpdate:value":l[1]||(l[1]=m=>n.value.fid=m),maxlength:"16",placeholder:":FID:FID:"},null,8,["value"])])]),a("tr",null,[l[13]||(l[13]=a("td",{class:"label"},[a("span",{class:"red_dot"},"城市")],-1)),a("td",null,[i(P,{value:n.value.city,"onUpdate:value":l[2]||(l[2]=m=>n.value.city=m),options:f.value.city_name},null,8,["value","options"])]),l[14]||(l[14]=a("td",{class:"label"},[a("span",{class:"red_dot"},"分类")],-1)),a("td",null,[i(P,{value:n.value.class,"onUpdate:value":l[3]||(l[3]=m=>n.value.class=m),options:f.value.class_name},null,8,["value","options"])])]),a("tr",null,[l[15]||(l[15]=a("td",{class:"label"},[a("span",{class:"red_dot"},"店铺ID")],-1)),a("td",null,[i(I,{value:n.value.shop_id,"onUpdate:value":l[4]||(l[4]=m=>n.value.shop_id=m),maxlength:"8"},null,8,["value"])]),l[16]||(l[16]=a("td",{class:"label"},[a("span",{class:"red_dot"},"排序")],-1)),a("td",null,[i(I,{value:n.value.sort,"onUpdate:value":l[5]||(l[5]=m=>n.value.sort=m),maxlength:"4"},null,8,["value"])])]),a("tr",null,[a("td",yt,[a("span",ht,g(x(k).name),1)]),a("td",kt,[i(I,{value:n.value.name,"onUpdate:value":l[6]||(l[6]=m=>n.value.name=m),maxlength:"32"},null,8,["value"])])]),a("tr",null,[a("td",$t,g(x(k).remark),1),a("td",Ct,[i(I,{value:n.value.remark,"onUpdate:value":l[7]||(l[7]=m=>n.value.remark=m),type:"textarea",height:"80px",maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),St=G(Ut,[["__scopeId","data-v-7944e4fa"]]),Tt=["innerHTML"],At=W({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,S=T,d=H().state,k=d.langs,o=y(!1);j(()=>c.show,u=>{o.value=u},{deep:!0});const n=()=>{const u=_.Loading();D.Post("erp_base_shop/del?lang="+d.lang,{token:d.token,data:c.data},r=>{u.clear();const{code:w,msg:$}=r.data;_.Toast($),S("submit",w==0)})},f=()=>{S("update:show",!1)};return(u,r)=>(B(),M(O,{show:o.value,"onUpdate:show":r[1]||(r[1]=w=>o.value=w),title:C.title||x(k).del,width:"360px",bottom:"40px",onClose:r[2]||(r[2]=w=>f())},{bottom:s(()=>[i(A,{effect:"dark",type:"danger",height:"40px",onClick:r[0]||(r[0]=w=>n())},{default:s(()=>[U(g(x(k).confirm),1)]),_:1})]),default:s(()=>[i(V,{lineHeight:"60px"},{default:s(()=>[a("span",{innerHTML:x(k).del_warn(C.data.length)},null,8,Tt)]),_:1})]),_:1},8,["show","title"]))}}),Dt=["innerHTML"],Lt=W({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(C,{emit:T}){const c=C,S=T,d=H().state,k=d.langs,o=y(!1);j(()=>c.show,u=>{o.value=u},{deep:!0});const n=()=>{const u=_.Loading();D.Post("erp_base_shop/export?lang="+d.lang,{token:d.token,data:c.data,order:c.order},r=>{u.clear();const{code:w,msg:$,data:v}=r.data;_.Toast($),w==0&&st.Down(v.path+v.filename,v.filename),S("submit",w==0)})},f=()=>{S("update:show",!1)};return(u,r)=>(B(),M(O,{show:o.value,"onUpdate:show":r[1]||(r[1]=w=>o.value=w),title:C.title||x(k).export,width:"360px",bottom:"40px",onClose:r[2]||(r[2]=w=>f())},{bottom:s(()=>[i(A,{height:"40px",padding:"0 32px",onClick:r[0]||(r[0]=w=>n())},{default:s(()=>[U(g(x(k).confirm),1)]),_:1})]),default:s(()=>[i(V,{lineHeight:"60px"},{default:s(()=>[a("span",{innerHTML:x(k).export_warn(C.num)},null,8,Dt)]),_:1})]),_:1},8,["show","title"]))}}),Pt=["innerHTML"],Bt={class:"app_action flex"},It={class:"app_action_tools scrollbar"},Wt={class:"app_action_search flex"},Ht={class:"app_ct"},Mt={class:"tCenter"},Nt={class:"tCenter"},Ft={class:"tCenter"},Rt={class:"tCenter"},jt={class:"tCenter"},Ot={class:"tCenter"},Vt={class:"tCenter"},zt={class:"tCenter"},Et={class:"tCenter"},Kt={key:1},qt={class:"tCenter"},Gt={class:"tCenter"},Jt={class:"app_page"},Qt=W({__name:"index",setup(C){const T=y(!1),c=y(),h=H().state,d=h.langs,k=ft.isAction,o=y({show:!1,key:"",placeholder:"名称、备注",columns:[{label:"城市",value:"",slot:"city"},{label:"分类",value:"",slot:"class"},{label:"事业部",value:"",slot:"fid"},{label:"状态",value:"",slot:"state"},{label:d.name,value:"",name:"name"},{label:"制单员",value:"",name:"creator_name"},{label:"操作员",value:"",name:"operator_name"},{label:d.remark,value:"",name:"remark"}],city:"",class:"",fid:"",state:""}),n=y({time:"",list:{}}),f=y({columns:[{title:"ID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:d.date,slot:"date",textAlign:"center",width:"120px",minWidth:"110px"},{title:"城市",index:"city",slot:"city",order:"",textAlign:"center",width:"60px",minWidth:"60px"},{title:"分类",slot:"class",index:"class",order:"",textAlign:"center",width:"60px",minWidth:"60px"},{title:"店铺ID",slot:"shop_id",index:"shop_id",order:"",width:"100px",minWidth:"100px"},{title:d.name,index:"name",order:"",width:"120px",minWidth:"80px"},{title:"所属",index:"fid",slot:"fid",order:"",textAlign:"center",width:"80px",minWidth:"60px"},{title:"排序",slot:"sort",textAlign:"center",width:"60px",minWidth:"60px"},{title:d.status,index:"state",slot:"state",width:"60px",textAlign:"center"},{title:d.action,slot:"action",textAlign:"center",width:"90px"},{title:"制单员",slot:"creator_name",textAlign:"center",width:"90px"},{title:"操作员",slot:"operator_name",textAlign:"center",width:"90px"},{title:d.remark,index:"remark"}],data:[],num:0,total:0,order:""}),u=y({total:0,num:1,limit:100}),r=y({show:!1,title:"添加/编辑",data:{}}),w=y({show:!1,title:"删除",data:[]}),$=y({show:!1,title:"导出",num:0}),v=y({city_name:[],class_name:[],org_name:[],state_name:[]});ot(()=>{h.token&&at()}),nt(()=>{T&&h.isLogin&&l()});const l=()=>{o.value.show=!1,f.value.data=[];const p=_.Loading();D.Post("erp_base_shop/list?lang="+h.lang,{token:h.token,data:m(),page:u.value.num,limit:u.value.limit,order:f.value.order},t=>{p.clear();const{code:e,msg:b,time:F,data:R}=t.data;e===0?(n.value.time=F,f.value.data=R,z()):_.Toast(b)}),u.value.total=0,D.Post("erp_base_shop/total?lang="+h.lang,{token:h.token,data:m()},t=>{const{code:e,msg:b,time:F,data:R}=t.data;e==0?(n.value.time=F,u.value.total=R.total):_.Toast(b)})},m=()=>{const p={key:o.value.key,city:o.value.city,class:o.value.class,fid:o.value.fid,state:o.value.state};for(let t of o.value.columns)t.name&&(p[t.name]=t.value);return p},L=(p,t)=>{f.value.num=p,f.value.total=t},N=p=>{f.value.order=p,l()},J=()=>{o.value.key="",o.value.city="",o.value.class="",o.value.fid="",o.value.state="";for(let p of o.value.columns)p.value="";f.value.order="",u.value.num=1,l()},z=()=>{q(()=>{f.value.num=0,c.value.checkboxAll(!1)})},E=(p,t={})=>{r.value.show=!0,r.value.data=t,p=="add"?r.value.title=d.add:p=="edit"&&(r.value.title=d.edit+"( "+t.name+" )")},Q=p=>{p&&(r.value.show=!1,l())},X=()=>{w.value.show=!0;const p=c.value.getData();let t=[];for(let e of p)t.push(e.id);w.value.data=t},Y=p=>{p&&(w.value.show=!1,l())},Z=p=>{$.value.show=!0,$.value.num=p},tt=p=>{p&&($.value.show=!1,z())},et=()=>{const p=_.Loading();D.Post("erp_base_shop/pull?lang="+h.lang,{token:h.token},t=>{p.clear();const{msg:e}=t.data;_.Toast(e)})},at=()=>{D.Post("erp_base_shop/get_select?lang="+h.lang,{token:h.token},p=>{const{code:t,msg:e,data:b}=p.data;t==0?(v.value.city_name=b.city_name,v.value.class_name=b.class_name,v.value.org_name=b.org_name,v.value.state_name=b.state_name,T.value=!0):_.Toast(e)})};return(p,t)=>(B(),K(ut,null,[i(gt,{time:n.value.time,onRefresh:t[0]||(t[0]=e=>l())},{default:s(()=>[a("span",{innerHTML:x(d).sys_role_total(u.value.total)},null,8,Pt)]),_:1},8,["time"]),a("div",Bt,[a("div",It,[i(pt,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line1"},{action:"save",slot:"down",is_action:!0},{action:"line",slot:"line2"},{action:"export",slot:"export",is_action:!0}]},{add:s(()=>[i(A,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:t[1]||(t[1]=e=>E("add"))},{default:s(()=>[U(g(x(d).add),1)]),_:1})]),del:s(()=>[i(A,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:f.value.num==0,onClick:t[2]||(t[2]=e=>X())},{default:s(()=>[U(g(x(d).del)+"("+g(f.value.num)+")",1)]),_:1},8,["disabled"])]),line1:s(()=>t[25]||(t[25]=[a("span",{class:"line"},"|",-1)])),down:s(()=>[i(A,{effect:"plain",type:"primary",onClick:t[3]||(t[3]=e=>et())},{default:s(()=>t[26]||(t[26]=[U("同步聚水潭店铺")])),_:1})]),line2:s(()=>t[27]||(t[27]=[a("span",{class:"line"},"|",-1)])),export:s(()=>[i(A,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!u.value.total,onClick:t[4]||(t[4]=e=>Z(u.value.total))},{default:s(()=>[U(g(x(d).export)+"("+g(u.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),a("div",Wt,[i(mt,{show:o.value.show,"onUpdate:show":t[9]||(t[9]=e=>o.value.show=e),keys:o.value.key,"onUpdate:keys":t[10]||(t[10]=e=>o.value.key=e),columns:o.value.columns,onKeyup:t[11]||(t[11]=it(e=>{u.value.num=1,l()},["enter"])),onSearch:t[12]||(t[12]=e=>{u.value.num=1,l()}),onReset:t[13]||(t[13]=e=>J())},{city:s(e=>[i(P,{value:o.value.city,"onUpdate:value":t[5]||(t[5]=b=>o.value.city=b),options:v.value.city_name,placeholder:e.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),class:s(e=>[i(P,{value:o.value.class,"onUpdate:value":t[6]||(t[6]=b=>o.value.class=b),options:v.value.class_name,placeholder:e.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),fid:s(e=>[i(P,{value:o.value.fid,"onUpdate:value":t[7]||(t[7]=b=>o.value.fid=b),options:v.value.org_name,placeholder:e.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),state:s(e=>[i(P,{value:o.value.state,"onUpdate:value":t[8]||(t[8]=b=>o.value.state=b),options:v.value.state_name,placeholder:e.label,clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),a("div",Ht,[i(dt,{ref_key:"tableList",ref:c,overflow:"auto",columns:f.value.columns,options:f.value.data,onOrderBy:N,onPartially:L},{id:s(e=>[a("div",Mt,g(e.id),1)]),date:s(e=>[a("div",Nt,[i(vt,{title:"创建: "+e.ctime+`
更新: `+e.utime},{default:s(()=>[U(g(e.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),city:s(e=>[a("div",Ft,g(e.city),1)]),class:s(e=>[a("div",Rt,g(e.class||"-"),1)]),shop_id:s(e=>[a("div",jt,[a("b",null,g(e.shop_id),1)])]),fid:s(e=>[a("div",Ot,g(e.org_name||"-"),1)]),sort:s(e=>[a("div",Vt,g(e.sort),1)]),state:s(e=>[a("div",zt,[a("span",{class:rt(e.state?"c_success":"c_danger")},g(e.state?x(d).enable:x(d).disable),3)])]),action:s(e=>[a("div",Et,[x(k)("save")?(B(),M(A,{key:0,onClick:b=>E("edit",e)},{default:s(()=>[U(g(x(d).edit),1)]),_:2},1032,["onClick"])):(B(),K("span",Kt,"-"))])]),creator_name:s(e=>[a("div",qt,g(e.creator_name),1)]),operator_name:s(e=>[a("div",Gt,g(e.operator_name),1)]),_:1},8,["columns","options"])]),a("div",Jt,[i(ct,{total:u.value.total,"onUpdate:total":t[14]||(t[14]=e=>u.value.total=e),page:u.value.num,"onUpdate:page":[t[15]||(t[15]=e=>u.value.num=e),t[16]||(t[16]=e=>l())],limit:u.value.limit,"onUpdate:limit":[t[17]||(t[17]=e=>u.value.limit=e),t[18]||(t[18]=e=>{u.value.num=1,l()})]},null,8,["total","page","limit"])]),i(St,{show:r.value.show,"onUpdate:show":t[19]||(t[19]=e=>r.value.show=e),title:r.value.title,data:r.value.data,onSubmit:t[20]||(t[20]=e=>Q(e))},null,8,["show","title","data"]),i(At,{show:w.value.show,"onUpdate:show":t[21]||(t[21]=e=>w.value.show=e),data:w.value.data,onSubmit:t[22]||(t[22]=e=>Y(e))},null,8,["show","data"]),i(Lt,{show:$.value.show,"onUpdate:show":t[23]||(t[23]=e=>$.value.show=e),data:m(),order:f.value.order,num:$.value.num,onSubmit:t[24]||(t[24]=e=>tt(e))},null,8,["show","data","order","num"])],64))}}),ae=G(Qt,[["__scopeId","data-v-248fc92c"]]);export{ae as default};
