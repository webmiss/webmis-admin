import{d as B,u as P,r as x,w as W,c as H,a,e as R,f as r,l as S,h as Z,i as o,t as w,b as g,j as I,k as j,m as T,U as k,R as D,o as A,_ as z,F as tt,y as et,z as at,n as V,D as st,E as lt,s as ot,G as nt,x as it,I as dt}from"./index--Aaw8Kh1.js";import{w as ut,a as rt,b as mt,c as pt,P as vt}from"./Search-DMryvUDg.js";import{w as ct}from"./Total-C1JsSOot.js";import{w as ft}from"./index-9lX5YKhj.js";import{w as wt}from"./index-Bf39PfWh.js";const gt={class:"label"},xt={class:"red_dot"},_t={colspan:"3"},ht={class:"label"},bt={class:"red_dot"},kt={style:{width:"30%"}},yt={class:"label"},$t={colspan:"3"},St=B({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,$=C,d=P().state,_=d.langs,u=x(!1),p=x({id:0,state:!0,name:"",sort:"0",remark:""});x({city_name:[],class_name:[]}),W(()=>f.show,s=>{u.value=s,s&&(p.value.id=f.data.id||0,p.value.state=typeof f.data.state<"u"?f.data.state:!0,p.value.name=f.data.name||"",p.value.sort=f.data.sort||"0",p.value.remark=f.data.remark||"")},{deep:!0});const v=s=>s.name.length<2||s.name.length>16?k.Toast("名称2～16字符!"):isNaN(s.sort)?k.Toast("请输入排序数字"):s,n=()=>{const s=v(p.value);if(!s)return;const l=k.Loading();D.Post("erp_base_category/save?lang="+d.lang,{token:d.token,data:s},c=>{l.clear();const{code:h,msg:L}=c.data;k.Toast(L),$("submit",h==0)})},i=()=>{$("update:show",!1)};return(s,l)=>(A(),H(R,{show:u.value,"onUpdate:show":l[5]||(l[5]=c=>u.value=c),title:b.title,width:"720px",bottom:"40px",onClose:l[6]||(l[6]=c=>i())},{bottom:a(()=>[r(T,{height:"40px",padding:"0 32px",onClick:l[4]||(l[4]=c=>n())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[r(ft,null,{default:a(()=>l[7]||(l[7]=[S("提示: 请认证填写如下信息")])),_:1}),r(j,null,{default:a(()=>[r(Z,null,{default:a(()=>[o("tr",null,[o("td",gt,[o("span",xt,w(g(_).status),1)]),o("td",_t,[r(wt,{value:p.value.state,"onUpdate:value":l[0]||(l[0]=c=>p.value.state=c)},null,8,["value"])])]),o("tr",null,[o("td",ht,[o("span",bt,w(g(_).name),1)]),o("td",null,[r(I,{value:p.value.name,"onUpdate:value":l[1]||(l[1]=c=>p.value.name=c),maxlength:"16"},null,8,["value"])]),l[8]||(l[8]=o("td",{class:"label"},[o("span",{class:"red_dot"},"排序")],-1)),o("td",kt,[r(I,{value:p.value.sort,"onUpdate:value":l[2]||(l[2]=c=>p.value.sort=c),maxlength:"4"},null,8,["value"])])]),o("tr",null,[o("td",yt,w(g(_).remark),1),o("td",$t,[r(I,{value:p.value.remark,"onUpdate:value":l[3]||(l[3]=c=>p.value.remark=c),type:"textarea",height:"160px",maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),Ct=z(St,[["__scopeId","data-v-0cca52b8"]]),Tt=["innerHTML"],Ut=B({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,$=C,d=P().state,_=d.langs,u=x(!1);W(()=>f.show,n=>{u.value=n},{deep:!0});const p=()=>{const n=k.Loading();D.Post("erp_base_category/del?lang="+d.lang,{token:d.token,data:f.data},i=>{n.clear();const{code:s,msg:l}=i.data;k.Toast(l),$("submit",s==0)})},v=()=>{$("update:show",!1)};return(n,i)=>(A(),H(R,{show:u.value,"onUpdate:show":i[1]||(i[1]=s=>u.value=s),title:b.title||g(_).del,width:"360px",bottom:"40px",onClose:i[2]||(i[2]=s=>v())},{bottom:a(()=>[r(T,{effect:"dark",type:"danger",height:"40px",onClick:i[0]||(i[0]=s=>p())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[r(j,{lineHeight:"60px"},{default:a(()=>[o("span",{innerHTML:g(_).del_warn(b.data.length)},null,8,Tt)]),_:1})]),_:1},8,["show","title"]))}}),At=["innerHTML"],Lt=B({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,$=C,d=P().state,_=d.langs,u=x(!1);W(()=>f.show,n=>{u.value=n},{deep:!0});const p=()=>{const n=k.Loading();D.Post("erp_base_category/export?lang="+d.lang,{token:d.token,data:f.data,order:f.order},i=>{n.clear();const{code:s,msg:l,data:c}=i.data;k.Toast(l),s==0&&tt.Down(c.path+c.filename,c.filename),$("submit",s==0)})},v=()=>{$("update:show",!1)};return(n,i)=>(A(),H(R,{show:u.value,"onUpdate:show":i[1]||(i[1]=s=>u.value=s),title:b.title||g(_).export,width:"360px",bottom:"40px",onClose:i[2]||(i[2]=s=>v())},{bottom:a(()=>[r(T,{height:"40px",padding:"0 32px",onClick:i[0]||(i[0]=s=>p())},{default:a(()=>[S(w(g(_).confirm),1)]),_:1})]),default:a(()=>[r(j,{lineHeight:"60px"},{default:a(()=>[o("span",{innerHTML:g(_).export_warn(b.num)},null,8,At)]),_:1})]),_:1},8,["show","title"]))}}),Dt=["innerHTML"],Bt={class:"app_action flex"},Pt={class:"app_action_tools scrollbar"},Ht={class:"app_action_search flex"},Mt={class:"app_ct"},Nt={class:"tCenter"},It={class:"tCenter"},Wt={class:"tCenter"},Rt={class:"tCenter"},jt={class:"tCenter"},Ft={key:1},Ot={class:"tCenter"},Vt={class:"tCenter"},zt={class:"app_page"},Et=B({__name:"index",setup(b){const C=x(!1),f=x(),y=P().state,d=y.langs,_=vt.isAction,u=x({show:!1,key:"",placeholder:"名称、备注",columns:[{label:d.name,value:"",name:"name"},{label:"制单员",value:"",name:"creator_name"},{label:"操作员",value:"",name:"operator_name"},{label:d.remark,value:"",name:"remark"}],class:""}),p=x({time:"",list:{}}),v=x({columns:[{title:"ID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:d.date,slot:"date",textAlign:"center",width:"120px",minWidth:"110px"},{title:"名称",index:"name",order:"",width:"160px",minWidth:"160px"},{title:"排序",slot:"sort",textAlign:"center",width:"60px",minWidth:"60px"},{title:d.status,index:"state",slot:"state",width:"60px",textAlign:"center"},{title:d.action,slot:"action",textAlign:"center",width:"90px"},{title:"制单员",slot:"creator_name",textAlign:"center",width:"90px"},{title:"操作员",slot:"operator_name",textAlign:"center",width:"90px"},{title:d.remark,index:"remark"}],data:[],num:0,total:0,order:""}),n=x({total:0,num:1,limit:100}),i=x({show:!1,title:"添加/编辑",data:{}}),s=x({show:!1,title:"删除",data:[]}),l=x({show:!1,title:"导出",num:0}),c=x({class_name:[]});et(()=>{y.token&&(C.value=!0)}),at(()=>{C&&y.isLogin&&h()});const h=()=>{u.value.show=!1,v.value.data=[];const m=k.Loading();D.Post("erp_base_category/list?lang="+y.lang,{token:y.token,data:L(),page:n.value.num,limit:n.value.limit,order:v.value.order},t=>{m.clear();const{code:e,msg:U,time:M,data:N}=t.data;e===0?(p.value.time=M,v.value.data=N,F()):k.Toast(U)}),n.value.total=0,D.Post("erp_base_category/total?lang="+y.lang,{token:y.token,data:L()},t=>{const{code:e,msg:U,time:M,data:N}=t.data;e==0?(p.value.time=M,n.value.total=N.total):k.Toast(U)})},L=()=>{const m={key:u.value.key,class:u.value.class};for(let t of u.value.columns)t.name&&(m[t.name]=t.value);return m},E=(m,t)=>{v.value.num=m,v.value.total=t},K=m=>{v.value.order=m,h()},q=()=>{u.value.key="",u.value.class="";for(let m of u.value.columns)m.value="";v.value.order="",n.value.num=1,h()},F=()=>{nt(()=>{v.value.num=0,f.value.checkboxAll(!1)})},O=(m,t={})=>{i.value.show=!0,i.value.data=t,m=="add"?i.value.title=d.add:m=="edit"&&(i.value.title=d.edit+"( "+t.name+" )")},G=m=>{m&&(i.value.show=!1,h())},J=()=>{s.value.show=!0;const m=f.value.getData();let t=[];for(let e of m)t.push(e.id);s.value.data=t},Q=m=>{m&&(s.value.show=!1,h())},X=m=>{l.value.show=!0,l.value.num=m},Y=m=>{m&&(l.value.show=!1,F())};return(m,t)=>(A(),V(ot,null,[r(ct,{time:p.value.time,onRefresh:t[0]||(t[0]=e=>h())},{default:a(()=>[o("span",{innerHTML:g(d).sys_role_total(n.value.total)},null,8,Dt)]),_:1},8,["time"]),o("div",Bt,[o("div",Pt,[r(ut,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line"},{action:"export",slot:"export",is_action:!0}]},{add:a(()=>[r(T,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:t[1]||(t[1]=e=>O("add"))},{default:a(()=>[S(w(g(d).add),1)]),_:1})]),del:a(()=>[r(T,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:v.value.num==0,onClick:t[2]||(t[2]=e=>J())},{default:a(()=>[S(w(g(d).del)+"("+w(v.value.num)+")",1)]),_:1},8,["disabled"])]),line:a(()=>t[21]||(t[21]=[o("span",{class:"line"},"|",-1)])),export:a(()=>[r(T,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!n.value.total,onClick:t[3]||(t[3]=e=>X(n.value.total))},{default:a(()=>[S(w(g(d).export)+"("+w(n.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),o("div",Ht,[r(rt,{show:u.value.show,"onUpdate:show":t[5]||(t[5]=e=>u.value.show=e),keys:u.value.key,"onUpdate:keys":t[6]||(t[6]=e=>u.value.key=e),columns:u.value.columns,onKeyup:t[7]||(t[7]=st(e=>{n.value.num=1,h()},["enter"])),onSearch:t[8]||(t[8]=e=>{n.value.num=1,h()}),onReset:t[9]||(t[9]=e=>q())},{class:a(e=>[r(pt,{value:u.value.class,"onUpdate:value":t[4]||(t[4]=U=>u.value.class=U),options:c.value.class_name,placeholder:e.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),_:1},8,["show","keys","columns"])])]),o("div",Mt,[r(lt,{ref_key:"tableList",ref:f,overflow:"auto",columns:v.value.columns,options:v.value.data,onOrderBy:K,onPartially:E},{id:a(e=>[o("div",Nt,w(e.id),1)]),date:a(e=>[o("div",It,[r(dt,{title:"创建: "+e.ctime+`
更新: `+e.utime},{default:a(()=>[S(w(e.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),sort:a(e=>[o("div",Wt,w(e.sort),1)]),state:a(e=>[o("div",Rt,[o("span",{class:it(e.state?"c_success":"c_danger")},w(e.state?g(d).enable:g(d).disable),3)])]),action:a(e=>[o("div",jt,[g(_)("save")?(A(),H(T,{key:0,onClick:U=>O("edit",e)},{default:a(()=>[S(w(g(d).edit),1)]),_:2},1032,["onClick"])):(A(),V("span",Ft,"-"))])]),creator_name:a(e=>[o("div",Ot,w(e.creator_name),1)]),operator_name:a(e=>[o("div",Vt,w(e.operator_name),1)]),_:1},8,["columns","options"])]),o("div",zt,[r(mt,{total:n.value.total,"onUpdate:total":t[10]||(t[10]=e=>n.value.total=e),page:n.value.num,"onUpdate:page":[t[11]||(t[11]=e=>n.value.num=e),t[12]||(t[12]=e=>h())],limit:n.value.limit,"onUpdate:limit":[t[13]||(t[13]=e=>n.value.limit=e),t[14]||(t[14]=e=>{n.value.num=1,h()})]},null,8,["total","page","limit"])]),r(Ct,{show:i.value.show,"onUpdate:show":t[15]||(t[15]=e=>i.value.show=e),title:i.value.title,data:i.value.data,onSubmit:t[16]||(t[16]=e=>G(e))},null,8,["show","title","data"]),r(Ut,{show:s.value.show,"onUpdate:show":t[17]||(t[17]=e=>s.value.show=e),data:s.value.data,onSubmit:t[18]||(t[18]=e=>Q(e))},null,8,["show","data"]),r(Lt,{show:l.value.show,"onUpdate:show":t[19]||(t[19]=e=>l.value.show=e),data:L(),order:v.value.order,num:l.value.num,onSubmit:t[20]||(t[20]=e=>Y(e))},null,8,["show","data","order","num"])],64))}}),Xt=z(Et,[["__scopeId","data-v-6a109154"]]);export{Xt as default};
