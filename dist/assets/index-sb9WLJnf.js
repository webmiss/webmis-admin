import{d as B,u as P,r as _,w as I,c as H,a as l,e as F,f as m,l as $,h as Y,i as a,t as c,b as g,j as D,k as W,m as S,U as h,R as A,o as T,_ as V,F as Z,y as tt,z as et,n as O,D as at,E as st,s as ot,G as lt,x as nt,I as it}from"./index-De4U6Qew.js";import{w as dt,a as ut,b as rt,P as mt}from"./Search-BRk08DvK.js";import{w as pt}from"./Total-DFmTiaob.js";import{w as vt}from"./index-DtELT80z.js";import{w as ft}from"./index-yMd_J0k7.js";const wt={class:"label"},ct={class:"red_dot"},gt={colspan:"3"},xt={class:"label"},_t={class:"red_dot"},ht={colspan:"3"},bt={class:"label"},kt={colspan:"3"},yt=B({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,k=C,u=P().state,x=u.langs,v=_(!1),r=_({id:0,status:!0,fid:"0",sort:"0",name:"",remark:""});I(()=>f.show,o=>{v.value=o,o&&(r.value.id=f.data.id||0,r.value.status=typeof f.data.status<"u"?f.data.status:!0,r.value.fid=f.data.fid||"0",r.value.sort=f.data.sort||"0",r.value.name=f.data.name||"",r.value.remark=f.data.remark||"")},{deep:!0});const w=o=>isNaN(o.fid)?h.Toast("请输入FID"):isNaN(o.sort)?h.Toast("请输入排序数字"):o.name.length<2||o.name.length>16?h.Toast("名称2～16字符!"):o,n=()=>{const o=w(r.value);if(!o)return;const s=h.Loading();A.Post("erp_base_organization/save?lang="+u.lang,{token:u.token,data:o},i=>{s.clear();const{code:U,msg:M}=i.data;h.Toast(M),k("submit",U==0)})},d=()=>{k("update:show",!1)};return(o,s)=>(T(),H(F,{show:v.value,"onUpdate:show":s[6]||(s[6]=i=>v.value=i),title:b.title,width:"720px",bottom:"40px",onClose:s[7]||(s[7]=i=>d())},{bottom:l(()=>[m(S,{height:"40px",padding:"0 32px",onClick:s[5]||(s[5]=i=>n())},{default:l(()=>[$(c(g(x).confirm),1)]),_:1})]),default:l(()=>[m(vt,null,{default:l(()=>[...s[8]||(s[8]=[$("提示: 请认证填写如下信息",-1)])]),_:1}),m(W,null,{default:l(()=>[m(Y,null,{default:l(()=>[a("tr",null,[a("td",wt,[a("span",ct,c(g(x).status),1)]),a("td",gt,[m(ft,{value:r.value.status,"onUpdate:value":s[0]||(s[0]=i=>r.value.status=i)},null,8,["value"])])]),a("tr",null,[s[9]||(s[9]=a("td",{class:"label"},[a("span",{class:"red_dot"},"FID")],-1)),a("td",null,[m(D,{value:r.value.fid,"onUpdate:value":s[1]||(s[1]=i=>r.value.fid=i),maxlength:"4"},null,8,["value"])]),s[10]||(s[10]=a("td",{class:"label"},[a("span",{class:"red_dot"},"排序")],-1)),a("td",null,[m(D,{value:r.value.sort,"onUpdate:value":s[2]||(s[2]=i=>r.value.sort=i),maxlength:"4"},null,8,["value"])])]),a("tr",null,[a("td",xt,[a("span",_t,c(g(x).name),1)]),a("td",ht,[m(D,{value:r.value.name,"onUpdate:value":s[3]||(s[3]=i=>r.value.name=i),maxlength:"16"},null,8,["value"])])]),a("tr",null,[a("td",bt,c(g(x).remark),1),a("td",kt,[m(D,{value:r.value.remark,"onUpdate:value":s[4]||(s[4]=i=>r.value.remark=i),type:"textarea",height:"80px",maxlength:"32"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),$t=V(yt,[["__scopeId","data-v-58b66a3e"]]),Ct=["innerHTML"],St=B({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,k=C,u=P().state,x=u.langs,v=_(!1);I(()=>f.show,n=>{v.value=n},{deep:!0});const r=()=>{const n=h.Loading();A.Post("erp_base_organization/del?lang="+u.lang,{token:u.token,data:f.data},d=>{n.clear();const{code:o,msg:s}=d.data;h.Toast(s),k("submit",o==0)})},w=()=>{k("update:show",!1)};return(n,d)=>(T(),H(F,{show:v.value,"onUpdate:show":d[1]||(d[1]=o=>v.value=o),title:b.title||g(x).del,width:"360px",bottom:"40px",onClose:d[2]||(d[2]=o=>w())},{bottom:l(()=>[m(S,{effect:"dark",type:"danger",height:"40px",onClick:d[0]||(d[0]=o=>r())},{default:l(()=>[$(c(g(x).confirm),1)]),_:1})]),default:l(()=>[m(W,{lineHeight:"60px"},{default:l(()=>[a("span",{innerHTML:g(x).del_warn(b.data.length)},null,8,Ct)]),_:1})]),_:1},8,["show","title"]))}}),Tt=["innerHTML"],Ut=B({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(b,{emit:C}){const f=b,k=C,u=P().state,x=u.langs,v=_(!1);I(()=>f.show,n=>{v.value=n},{deep:!0});const r=()=>{const n=h.Loading();A.Post("erp_base_organization/export?lang="+u.lang,{token:u.token,data:f.data,order:f.order},d=>{n.clear();const{code:o,msg:s,data:i}=d.data;h.Toast(s),o==0&&Z.Down(i.path+i.filename,i.filename),k("submit",o==0)})},w=()=>{k("update:show",!1)};return(n,d)=>(T(),H(F,{show:v.value,"onUpdate:show":d[1]||(d[1]=o=>v.value=o),title:b.title||g(x).export,width:"360px",bottom:"40px",onClose:d[2]||(d[2]=o=>w())},{bottom:l(()=>[m(S,{height:"40px",padding:"0 32px",onClick:d[0]||(d[0]=o=>r())},{default:l(()=>[$(c(g(x).confirm),1)]),_:1})]),default:l(()=>[m(W,{lineHeight:"60px"},{default:l(()=>[a("span",{innerHTML:g(x).export_warn(b.num)},null,8,Tt)]),_:1})]),_:1},8,["show","title"]))}}),At=["innerHTML"],Lt={class:"app_action flex"},Dt={class:"app_action_tools scrollbar"},Bt={class:"app_action_search flex"},Pt={class:"app_ct"},Ht={class:"tCenter"},Mt={class:"tCenter"},Nt={class:"tCenter"},zt={class:"tCenter"},It={class:"tCenter"},Ft={class:"tCenter"},Wt={key:1},Rt={class:"tCenter"},jt={class:"tCenter"},Ot={class:"app_page"},Vt=B({__name:"index",setup(b){const C=_(!1),f=_(),y=P().state,u=y.langs,x=mt.isAction,v=_({show:!1,key:"",placeholder:"名称、备注",columns:[{label:u.name,value:"",name:"name"},{label:"制单员",value:"",name:"creator_name"},{label:"操作员",value:"",name:"operator_name"},{label:u.remark,value:"",name:"remark"}]}),r=_({time:"",list:{}}),w=_({columns:[{title:"ID",index:"id",slot:"id",order:"",width:"80px",minWidth:"60px",textAlign:"center"},{title:"Fid",index:"fid",slot:"fid",order:"",textAlign:"center",width:"80px",minWidth:"60px"},{title:u.date,slot:"date",textAlign:"center",width:"120px",minWidth:"110px"},{title:u.name,index:"name",order:"",width:"120px",minWidth:"80px"},{title:"排序",slot:"sort",textAlign:"center",width:"60px",minWidth:"60px"},{title:u.status,index:"status",slot:"status",width:"60px",textAlign:"center"},{title:u.action,slot:"action",textAlign:"center",width:"90px"},{title:"制单员",slot:"creator_name",textAlign:"center",width:"90px"},{title:"操作员",slot:"operator_name",textAlign:"center",width:"90px"},{title:u.remark,index:"remark"}],data:[],num:0,total:0,order:""}),n=_({total:0,num:1,limit:100}),d=_({show:!1,title:"添加/编辑",data:{}}),o=_({show:!1,title:"删除",data:[]}),s=_({show:!1,title:"导出",num:0});tt(()=>{C.value=!0}),et(()=>{C&&y.isLogin&&i()});const i=()=>{v.value.show=!1,w.value.data=[];const p=h.Loading();A.Post("erp_base_organization/list?lang="+y.lang,{token:y.token,data:U(),page:n.value.num,limit:n.value.limit,order:w.value.order},t=>{p.clear();const{code:e,msg:L,time:N,data:z}=t.data;e===0?(r.value.time=N,w.value.data=z,R()):h.Toast(L)}),n.value.total=0,A.Post("erp_base_organization/total?lang="+y.lang,{token:y.token,data:U()},t=>{const{code:e,msg:L,time:N,data:z}=t.data;e==0?(r.value.time=N,n.value.total=z.total):h.Toast(L)})},U=()=>{const p={key:v.value.key};for(let t of v.value.columns)t.name&&(p[t.name]=t.value);return p},M=(p,t)=>{w.value.num=p,w.value.total=t},E=p=>{w.value.order=p,i()},K=()=>{v.value.key="";for(let p of v.value.columns)p.value="";w.value.order="",n.value.num=1,i()},R=()=>{lt(()=>{w.value.num=0,f.value.checkboxAll(!1)})},j=(p,t={})=>{d.value.show=!0,d.value.data=t,p=="add"?d.value.title=u.add:p=="edit"&&(d.value.title=u.edit+"( "+t.name+" )")},q=p=>{p&&(d.value.show=!1,i())},G=()=>{o.value.show=!0;const p=f.value.getData();let t=[];for(let e of p)t.push(e.id);o.value.data=t},J=p=>{p&&(o.value.show=!1,i())},Q=p=>{s.value.show=!0,s.value.num=p},X=p=>{p&&(s.value.show=!1,R())};return(p,t)=>(T(),O(ot,null,[m(pt,{time:r.value.time,onRefresh:t[0]||(t[0]=e=>i())},{default:l(()=>[a("span",{innerHTML:g(u).sys_role_total(n.value.total)},null,8,At)]),_:1},8,["time"]),a("div",Lt,[a("div",Dt,[m(dt,{columns:[{action:"save",slot:"add",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line"},{action:"export",slot:"export",is_action:!0}]},{add:l(()=>[m(S,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:t[1]||(t[1]=e=>j("add"))},{default:l(()=>[$(c(g(u).add),1)]),_:1})]),del:l(()=>[m(S,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:w.value.num==0,onClick:t[2]||(t[2]=e=>G())},{default:l(()=>[$(c(g(u).del)+"("+c(w.value.num)+")",1)]),_:1},8,["disabled"])]),line:l(()=>[...t[20]||(t[20]=[a("span",{class:"line"},"|",-1)])]),export:l(()=>[m(S,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!n.value.total,onClick:t[3]||(t[3]=e=>Q(n.value.total))},{default:l(()=>[$(c(g(u).export)+"("+c(n.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),a("div",Bt,[m(ut,{show:v.value.show,"onUpdate:show":t[4]||(t[4]=e=>v.value.show=e),keys:v.value.key,"onUpdate:keys":t[5]||(t[5]=e=>v.value.key=e),columns:v.value.columns,onKeyup:t[6]||(t[6]=at(e=>{n.value.num=1,i()},["enter"])),onSearch:t[7]||(t[7]=e=>{n.value.num=1,i()}),onReset:t[8]||(t[8]=e=>K())},null,8,["show","keys","columns"])])]),a("div",Pt,[m(st,{ref_key:"tableList",ref:f,overflow:"auto",columns:w.value.columns,options:w.value.data,onOrderBy:E,onPartially:M},{id:l(e=>[a("div",Ht,c(e.id),1)]),fid:l(e=>[a("div",Mt,c(e.fid),1)]),date:l(e=>[a("div",Nt,[m(it,{title:"创建: "+e.ctime+`
更新: `+e.utime},{default:l(()=>[$(c(e.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),sort:l(e=>[a("div",zt,c(e.sort),1)]),status:l(e=>[a("div",It,[a("span",{class:nt(e.status?"c_success":"c_danger")},c(e.status?g(u).enable:g(u).disable),3)])]),action:l(e=>[a("div",Ft,[g(x)("save")?(T(),H(S,{key:0,onClick:L=>j("edit",e)},{default:l(()=>[$(c(g(u).edit),1)]),_:1},8,["onClick"])):(T(),O("span",Wt,"-"))])]),creator_name:l(e=>[a("div",Rt,c(e.creator_name),1)]),operator_name:l(e=>[a("div",jt,c(e.operator_name),1)]),_:1},8,["columns","options"])]),a("div",Ot,[m(rt,{total:n.value.total,"onUpdate:total":t[9]||(t[9]=e=>n.value.total=e),page:n.value.num,"onUpdate:page":[t[10]||(t[10]=e=>n.value.num=e),t[11]||(t[11]=e=>i())],limit:n.value.limit,"onUpdate:limit":[t[12]||(t[12]=e=>n.value.limit=e),t[13]||(t[13]=e=>{n.value.num=1,i()})]},null,8,["total","page","limit"])]),m($t,{show:d.value.show,"onUpdate:show":t[14]||(t[14]=e=>d.value.show=e),title:d.value.title,data:d.value.data,onSubmit:t[15]||(t[15]=e=>q(e))},null,8,["show","title","data"]),m(St,{show:o.value.show,"onUpdate:show":t[16]||(t[16]=e=>o.value.show=e),data:o.value.data,onSubmit:t[17]||(t[17]=e=>J(e))},null,8,["show","data"]),m(Ut,{show:s.value.show,"onUpdate:show":t[18]||(t[18]=e=>s.value.show=e),data:U(),order:w.value.order,num:s.value.num,onSubmit:t[19]||(t[19]=e=>X(e))},null,8,["show","data","order","num"])],64))}}),Qt=V(Vt,[["__scopeId","data-v-1aac6315"]]);export{Qt as default};
