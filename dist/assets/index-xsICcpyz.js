import{d as X,u as Z,r as A,w as te,c as se,a as n,e as J,f as i,h as pe,i as e,t as p,n as R,k as Q,o as T,U as k,R as V,s as ne,j as f,m as I,l as U,b as x,G as re,F as ge,E as we,B as fe,L as ye,D as xe,K as he,M as le,N as Ue,O as $e,T as N,y as Ce,z as Te,A as Ae,H as Se,v as De,x as be,I as Le}from"./index--Aaw8Kh1.js";import{c as z,w as Re,a as Pe,b as Ye,P as We}from"./Search-DMryvUDg.js";import{w as Be}from"./index-CONZkG9F.js";import{w as Fe}from"./Total-C1JsSOot.js";import{w as ke}from"./index-9lX5YKhj.js";const Ne={key:0,class:"c_success"},Ie={key:1,class:"c_danger"},je={key:2},He={key:0},Me={key:1},Oe={class:"c_info"},Ve={class:"c_info"},Ee=X({__name:"SupplierInfo",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show"],setup(W,{emit:H}){const b=W,j=H,C=Z().state;C.langs;const S=A(!1),w=A({});te(()=>b.show,d=>{S.value=d,d&&l(b.data.supplier_name)});const l=d=>{if(!d)return k.Toast("请输入供应商名称");w.value={};const u=k.Loading();V.Post("erp_base_supplier/get_info?lang="+C.lang,{token:C.token,name:d},_=>{u.clear();const{code:g,msg:y,data:Y}=_.data;g==0?w.value=Y:k.Toast(y)})},$=()=>{j("update:show",!1)};return(d,u)=>(T(),se(J,{show:S.value,"onUpdate:show":u[0]||(u[0]=_=>S.value=_),title:W.title,width:"740px",onClose:u[1]||(u[1]=_=>$())},{default:n(()=>[i(Q,null,{default:n(()=>[i(pe,null,{default:n(()=>[e("tr",null,[u[2]||(u[2]=e("td",{class:"label"},"供应商名称",-1)),e("td",null,p(w.value.name||"-"),1),u[3]||(u[3]=e("td",{class:"label"},"状态",-1)),e("td",null,[w.value.state=="1"?(T(),R("span",Ne,"正常")):w.value.state=="0"?(T(),R("span",Ie,"禁用")):(T(),R("span",je,"-"))])]),e("tr",null,[u[4]||(u[4]=e("td",{class:"label"},"手机号码",-1)),e("td",null,[w.value.tel?(T(),R("b",He,p(w.value.tel||"-"),1)):(T(),R("span",Me,"-"))]),u[5]||(u[5]=e("td",{class:"label"},"供应商ID",-1)),e("td",null,p(w.value.supplier_id||"-"),1)]),e("tr",null,[u[6]||(u[6]=e("td",{class:"label"},"创建时间",-1)),e("td",Oe,p(w.value.ctime||"-"),1),u[7]||(u[7]=e("td",{class:"label"},"修改时间",-1)),e("td",Ve,p(w.value.utime||"-"),1)]),e("tr",null,[u[8]||(u[8]=e("td",{class:"label"},"开户银行",-1)),e("td",null,p(w.value.depositbank||"-"),1),u[9]||(u[9]=e("td",{class:"label"},"身份证号",-1)),e("td",null,p(w.value.id_card||"-"),1)]),e("tr",null,[u[10]||(u[10]=e("td",{class:"label"},"账户名称",-1)),e("td",null,p(w.value.bankacount||"-"),1),u[11]||(u[11]=e("td",{class:"label"},"银行卡号",-1)),e("td",null,p(w.value.acountnumber||"-"),1)]),e("tr",null,[u[12]||(u[12]=e("td",{class:"label"},"支付宝姓名",-1)),e("td",null,p(w.value.alipay_name||"-"),1),u[13]||(u[13]=e("td",{class:"label"},"支付宝账号",-1)),e("td",null,p(w.value.alipay_id||"-"),1)])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),Ke=X({__name:"save",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(W,{emit:H}){const b=W,j=H,C=Z().state,S=C.langs,w=A(!1),l=A({type:"",ids:[],sku_id:"",name:"",properties_value:"",short_name:"",unit:"",weight:"",num:"",ratio:"",owner:"",i_id:"",supplier_name:"",cost_price:"",supply_price:"",sale_price:"",supplier_price:"",purchase_price:"",market_price:"",other_price:"",other_price1:"",labels:"",category:"",brand:""}),$=A({labels:[],category:[],brand:[]}),d=A({show:!1,title:"供应商信息",data:{}});te(()=>b.show,P=>{w.value=P,P&&(l.value.type=b.data.type||"",l.value.ids=b.data.ids||[],l.value.sku_id=b.data.sku_id||"",l.value.name=b.data.name||"",l.value.properties_value=b.data.properties_value||"",l.value.short_name=b.data.short_name||"",l.value.cost_price=b.data.cost_price||"",l.value.supply_price=b.data.supply_price||"",l.value.sale_price=b.data.sale_price||"",l.value.purchase_price=b.data.purchase_price||"",l.value.supplier_price=b.data.supplier_price||"",l.value.market_price=b.data.market_price||"",l.value.other_price=b.data.other_price||"",l.value.other_price1=b.data.other_price1||"",l.value.unit=b.data.unit||"",l.value.weight=b.data.weight||"",l.value.num=typeof b.data.num<"u"?b.data.num:"",l.value.ratio=b.data.ratio||"",l.value.brand=b.data.brand||"",l.value.owner=b.data.owner||"",l.value.i_id=b.data.i_id||"",l.value.supplier_name=b.data.supplier_name||"",u())},{deep:!0});const u=()=>{V.Post("erp_goods_info/get_select?lang="+C.lang,{token:C.token},P=>{const{code:r,msg:c,data:F}=P.data;r==0?($.value.labels=F.labels,$.value.category=F.category,$.value.brand=F.brand,re(()=>{l.value.labels=b.data.labels?[b.data.labels]:"",l.value.category=b.data.category?[b.data.category]:"",l.value.brand=b.data.brand?[b.data.brand]:""})):k.Toast(c)})},_=P=>{if(!P)return k.Toast("请输入供应商名称");d.value.show=!0,d.value.data={supplier_name:P}},g=P=>P.ids.length==0?k.Toast("请选择"):P,y=()=>{const P=g(l.value);if(!P)return;const r=k.Loading();V.Post("erp_goods_info/save?lang="+C.lang,{token:C.token,data:P},c=>{r.clear();const{code:F,msg:E}=c.data;k.Toast(E),j("submit",F==0)})},Y=()=>{j("update:show",!1)};return(P,r)=>(T(),R(ne,null,[i(J,{show:w.value,"onUpdate:show":r[24]||(r[24]=c=>w.value=c),title:W.title,width:"900px",bottom:"40px",overflow:"hidden auto",onClose:r[25]||(r[25]=c=>Y())},{bottom:n(()=>[i(I,{height:"40px",padding:"0 32px",onClick:r[23]||(r[23]=c=>y())},{default:n(()=>[U(p(x(S).confirm),1)]),_:1})]),default:n(()=>[i(Q,null,{default:n(()=>[i(pe,null,{default:n(()=>[e("tr",null,[r[27]||(r[27]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品编码")],-1)),e("td",null,[i(f,{value:l.value.sku_id,"onUpdate:value":r[0]||(r[0]=c=>l.value.sku_id=c),placeholder:l.value.type=="edits"?"原始":"",disabled:!0},null,8,["value","placeholder"])]),r[28]||(r[28]=e("td",{class:"label"},[e("span",{class:"red_dot"},"标签")],-1)),e("td",null,[i(z,{value:l.value.labels,"onUpdate:value":r[1]||(r[1]=c=>l.value.labels=c),options:$.value.labels,placeholder:l.value.type=="edits"?"原始":""},null,8,["value","options","placeholder"])])]),e("tr",null,[r[29]||(r[29]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品名称")],-1)),e("td",null,[i(f,{value:l.value.name,"onUpdate:value":r[2]||(r[2]=c=>l.value.name=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[30]||(r[30]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品分类")],-1)),e("td",null,[i(z,{value:l.value.category,"onUpdate:value":r[3]||(r[3]=c=>l.value.category=c),options:$.value.category,placeholder:l.value.type=="edits"?"原始":""},null,8,["value","options","placeholder"])])]),e("tr",null,[r[31]||(r[31]=e("td",{class:"label"},"颜色及规格",-1)),e("td",null,[i(f,{value:l.value.properties_value,"onUpdate:value":r[4]||(r[4]=c=>l.value.properties_value=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[32]||(r[32]=e("td",{class:"label"},[e("span",{class:"red_dot"},"品牌")],-1)),e("td",null,[i(z,{value:l.value.brand,"onUpdate:value":r[5]||(r[5]=c=>l.value.brand=c),options:$.value.brand,placeholder:l.value.type=="edits"?"原始":""},null,8,["value","options","placeholder"])])]),e("tr",null,[r[33]||(r[33]=e("td",{class:"label"},[e("span",{class:"red_dot"},"成本价(元)")],-1)),e("td",null,[i(f,{value:l.value.cost_price,"onUpdate:value":r[6]||(r[6]=c=>l.value.cost_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[34]||(r[34]=e("td",{class:"label"},[e("span",{class:"red_dot"},"标签价(元)")],-1)),e("td",null,[i(f,{value:l.value.sale_price,"onUpdate:value":r[7]||(r[7]=c=>l.value.sale_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[35]||(r[35]=e("td",{class:"label"},"采购价(w)",-1)),e("td",null,[i(f,{value:l.value.purchase_price,"onUpdate:value":r[8]||(r[8]=c=>l.value.purchase_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[36]||(r[36]=e("td",{class:"label"},"吊牌价(w)",-1)),e("td",null,[i(f,{value:l.value.market_price,"onUpdate:value":r[9]||(r[9]=c=>l.value.market_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[37]||(r[37]=e("td",{class:"label"},"供应链价(元)",-1)),e("td",null,[i(f,{value:l.value.supply_price,"onUpdate:value":r[10]||(r[10]=c=>l.value.supply_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[38]||(r[38]=e("td",{class:"label"},"人民币采购价",-1)),e("td",null,[i(f,{value:l.value.supplier_price,"onUpdate:value":r[11]||(r[11]=c=>l.value.supplier_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[39]||(r[39]=e("td",{class:"label"},"参照价(元)",-1)),e("td",null,[i(f,{value:l.value.other_price,"onUpdate:value":r[12]||(r[12]=c=>l.value.other_price=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[40]||(r[40]=e("td",{class:"label"},"其它价格1",-1)),e("td",null,[i(f,{value:l.value.other_price1,"onUpdate:value":r[13]||(r[13]=c=>l.value.other_price1=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[41]||(r[41]=e("td",{class:"label"},"单位",-1)),e("td",null,[i(f,{value:l.value.unit,"onUpdate:value":r[14]||(r[14]=c=>l.value.unit=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[42]||(r[42]=e("td",{class:"label"},"重量",-1)),e("td",null,[i(f,{value:l.value.weight,"onUpdate:value":r[15]||(r[15]=c=>l.value.weight=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[43]||(r[43]=e("td",{class:"label"},"库存",-1)),e("td",null,[i(f,{value:l.value.num,"onUpdate:value":r[16]||(r[16]=c=>l.value.num=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[44]||(r[44]=e("td",{class:"label"},"折扣",-1)),e("td",null,[i(f,{value:l.value.ratio,"onUpdate:value":r[17]||(r[17]=c=>l.value.ratio=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[45]||(r[45]=e("td",{class:"label"},"暗码",-1)),e("td",null,[i(f,{value:l.value.short_name,"onUpdate:value":r[18]||(r[18]=c=>l.value.short_name=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[46]||(r[46]=e("td",{class:"label"},"款式编码",-1)),e("td",null,[i(f,{value:l.value.i_id,"onUpdate:value":r[19]||(r[19]=c=>l.value.i_id=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])])]),e("tr",null,[r[47]||(r[47]=e("td",{class:"label"},[e("span",{class:"red_dot"},"采购员")],-1)),e("td",null,[i(f,{value:l.value.owner,"onUpdate:value":r[20]||(r[20]=c=>l.value.owner=c),placeholder:l.value.type=="edits"?"原始":""},null,8,["value","placeholder"])]),r[48]||(r[48]=e("td",{class:"label"},[e("span",{class:"red_dot"},"供应商")],-1)),e("td",null,[i(f,{value:l.value.supplier_name,"onUpdate:value":r[21]||(r[21]=c=>l.value.supplier_name=c),onIconClick:r[22]||(r[22]=c=>_(l.value.supplier_name)),placeholder:l.value.type=="edits"?"原始":"",icon:"ui ui_search",iconAlign:"right",padding:"0 40px 0 10px"},null,8,["value","placeholder"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]),i(Ee,{show:d.value.show,"onUpdate:show":r[26]||(r[26]=c=>d.value.show=c),title:d.value.title,data:d.value.data},null,8,["show","title","data"])],64))}}),ze=["innerHTML"],qe=X({__name:"del",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Array,default:[]}},emits:["update:show","submit"],setup(W,{emit:H}){const b=W,j=H,C=Z().state,S=C.langs,w=A(!1);te(()=>b.show,d=>{w.value=d},{deep:!0});const l=()=>{const d=k.Loading();V.Post("erp_goods_info/del?lang="+C.lang,{token:C.token,data:b.data},u=>{d.clear();const{code:_,msg:g}=u.data;k.Toast(g),j("submit",_==0)})},$=()=>{j("update:show",!1)};return(d,u)=>(T(),se(J,{show:w.value,"onUpdate:show":u[1]||(u[1]=_=>w.value=_),title:W.title||x(S).del,width:"360px",bottom:"40px",onClose:u[2]||(u[2]=_=>$())},{bottom:n(()=>[i(I,{effect:"dark",type:"danger",height:"40px",onClick:u[0]||(u[0]=_=>l())},{default:n(()=>[U(p(x(S).confirm),1)]),_:1})]),default:n(()=>[i(Q,{lineHeight:"60px"},{default:n(()=>[e("span",{innerHTML:x(S).del_warn(W.data.length)},null,8,ze)]),_:1})]),_:1},8,["show","title"]))}}),Ge=["innerHTML"],Je=X({__name:"export",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},num:{type:Number,default:0},data:{type:Object,default:{}},order:{type:String,default:""}},emits:["update:show","submit"],setup(W,{emit:H}){const b=W,j=H,C=Z().state,S=C.langs,w=A(!1);te(()=>b.show,d=>{w.value=d},{deep:!0});const l=()=>{const d=k.Loading();V.Post("erp_goods_info/export?lang="+C.lang,{token:C.token,data:b.data,order:b.order},u=>{d.clear();const{code:_,msg:g,data:y}=u.data;k.Toast(g),_==0&&ge.Down(y.path+y.filename,y.filename),j("submit",_==0)})},$=()=>{j("update:show",!1)};return(d,u)=>(T(),se(J,{show:w.value,"onUpdate:show":u[1]||(u[1]=_=>w.value=_),title:W.title||x(S).export,width:"360px",bottom:"40px",onClose:u[2]||(u[2]=_=>$())},{bottom:n(()=>[i(I,{height:"40px",padding:"0 32px",onClick:u[0]||(u[0]=_=>l())},{default:n(()=>[U(p(x(S).confirm),1)]),_:1})]),default:n(()=>[i(Q,{lineHeight:"60px"},{default:n(()=>[e("span",{innerHTML:x(S).export_warn(W.num)},null,8,Ge)]),_:1})]),_:1},8,["show","title"]))}}),Qe={class:"goods_info flex"},Xe={class:"goods_info_tools flex"},Ze={class:"goods_info_total scrollbar",style:{"max-width":"calc(100% - 620px)"}},el={class:"tCenter"},ll={class:"copy c_primary"},tl=["onClick"],al={class:"tCenter"},sl={class:"tCenter"},ol={key:0,class:"tRight"},il={key:1,class:"tRight"},ul={class:"tRight"},nl={class:"tRight"},rl={key:0,class:"tRight"},pl={key:1,class:"tRight"},dl={class:"tRight"},vl={class:"tRight"},ml={class:"tCenter"},cl={class:"tCenter"},_l={class:"tCenter"},gl={class:"tCenter"},fl={class:"tCenter"},bl={key:0,class:"tCenter"},wl={key:1,class:"tCenter"},yl={class:"tCenter"},xl={class:"tCenter"},kl={class:"tCenter"},hl={key:0,class:"c_info"},Ul={key:1,class:"c_success"},$l={key:2,class:"c_danger"},Cl={key:3,class:"c_warning"},Tl={key:4,class:"c_info"},Al={class:"c_success"},Sl={class:"c_danger"},Dl={class:"c_warning"},Ll={class:"c_info"},Rl=X({__name:"import",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},selectList:{type:Object,default:{}},data:{type:Object,default:{}}},emits:["update:show","submit"],setup(W,{emit:H}){const b=W,j=H,B=A(),S=Z().state,w=S.langs,l=ye.priceEncode,$=A(!1),d=A({key:"",columns:[{title:"序号",slot:"index",width:"40px",minWidth:"30px",textAlign:"center"},{title:"商品编码",slot:"sku_id",width:"160px"},{title:"暗码",slot:"short_name",textAlign:"center"},{title:"款式编码",slot:"i_id",textAlign:"center"},{title:"商品名称",index:"name"},{title:"颜色及规格",index:"properties_value"},{title:"成本价(元)",slot:"cost_price",textAlign:"center"},{title:"供应链价(元)",slot:"supply_price",textAlign:"center"},{title:"标签价(元)",slot:"sale_price",textAlign:"center"},{title:"采购价(W)",slot:"purchase_price",textAlign:"center"},{title:"人民币采购价(元)",slot:"supplier_price",textAlign:"center"},{title:"吊牌价(W)",slot:"market_price",textAlign:"center"},{title:"单位",slot:"unit",minWidth:"60px",textAlign:"center"},{title:"重量",slot:"weight",minWidth:"60px",textAlign:"center"},{title:"标签",slot:"labels",textAlign:"center"},{title:"分类",slot:"category",textAlign:"center"},{title:"品牌",slot:"brand",textAlign:"center"},{title:"供应商",slot:"supplier_name",textAlign:"center"},{title:"采购员",slot:"owner",textAlign:"center"},{title:"操作",slot:"action",width:"60px",minWidth:"60px",textAlign:"center"},{title:"状态",slot:"status",width:"80px",minWidth:"80px",textAlign:"center"}],list:[],price:{label:"调整价格",value:"price",checked:!1},cost_price:0,sale_price:0,purchase_price:0,market_price:0}),u=A({show:!1,title:"新增商品",cost_price:"0.00",supply_price:"0.00",sale_price:"0.00",purchase_price:"0.00",supplier_price:"0.00",market_price:"0.00",weight:"0.00",unit:"个",sku_id:"",labels:"",name:"",category:"",properties_value:"",brand:"",short_name:"",i_id:"",owner:"",supplier_name:""}),_=A({show:!1,type:"",title:"移除",info:"",data:[]}),g=A({show:!1,refresh:!1,title:"上传资料",s0:0,s1:0,s2:0,s3:0,s4:0}),y=A({labels:[],category:[],brand:[]});te(()=>b.show,v=>{$.value=v,v&&(g.value.refresh=!1,Y())},{deep:!0});const Y=()=>{V.Post("erp_goods_info/get_select?lang="+S.lang,{token:S.token},v=>{const{code:t,msg:s,data:D}=v.data;t==0?(y.value.labels=D.labels,y.value.category=D.category,y.value.brand=D.brand):k.Toast(s)})},P=()=>{const v=d.value.key,t=new RegExp(v.trim().toUpperCase());d.value.key="";const s=d.value.list;for(let D of s)D.display=t.test(D.sku_id)},r=()=>{const v=u.value;if(!v.sku_id)return k.Toast("请输入商品编码");const t=le.Trim(v.sku_id).toUpperCase();for(let D of d.value.list)if(t==D.sku_id)return k.Toast("[ "+t+" ]已存在!");if(!v.name)return k.Toast("请输入商品名称");if(!v.labels||v.labels.length==0)return k.Toast("请选择标签");if(!v.category||v.category.length==0)return k.Toast("请选择分类");if(!v.brand||v.brand.length==0)return k.Toast("请选择品牌");if(!v.properties_value||v.properties_value.length<2)return k.Toast("请输入颜色及规格");if(!v.cost_price||isNaN(parseFloat(v.cost_price)))return k.Toast("请输入成本价");if(!v.sale_price||isNaN(parseFloat(v.sale_price)))return k.Toast("请输入标签价");if(!v.owner)return k.Toast("采购员");if(!v.supplier_name)return k.Toast("供应商");u.value.show=!1;let s="id_1";if(d.value.list.length>0){const O=d.value.list.at(-1).id.split("_");O.length===2&&(s="id_"+(parseInt(O[1])+1))}d.value.list.push({id:s,sku_id:t,i_id:v.i_id,name:v.name,properties_value:v.properties_value,short_name:v.short_name,cost_price:v.cost_price,supply_price:v.supply_price,sale_price:v.sale_price,price:F(parseFloat(v.sale_price)),purchase_price:v.purchase_price,supplier_price:v.supplier_price,market_price:v.market_price,unit:v.unit,weight:v.weight,labels:v.labels[0],category:v.category[0],brand:v.brand[0],supplier_name:v.supplier_name,owner:v.owner,status:"0",display:!0}),E(),ae([t])},c=()=>{ge.Select({mimeType:[]},v=>{ge.FileToBase64(v,t=>{const s=Ue(t,{type:"binary"}),D=s.SheetNames[0],O=$e.sheet_to_json(s.Sheets[D],{raw:!1});if(O.length>3e3)return k.Toast("不能超过3000条");d.value.list=[];let q=0,K="",G=[];for(let L of O){if(!L.商品编码||!L.款式编码||!L.品牌)continue;let h=L.基本售价||L.标签价||0,o=h?F(parseFloat(h)):0;q++,K=le.Trim(L.商品编码).toUpperCase(),G.push(K),d.value.list.push({id:"id_"+q,sku_id:K,i_id:L.款式编码,name:L.商品名称||"",properties_value:L.颜色及规格||"",short_name:L.暗码||"",cost_price:L.成本价||0,supply_price:L.供应链价||0,sale_price:h,price:o,purchase_price:L.采购价||0,supplier_price:L.人民币采购价||0,market_price:L.吊牌价||0,unit:L.单位||"",weight:L.重量||0,labels:L.商品标签||L.标签||"",category:L.分类||"",brand:L.品牌||"",supplier_name:L.供应商名称||L.供应商||"",owner:L.采购员||"",status:"0",display:!0})}E(),ae(G)},"blob")})},F=v=>Math.round(v/10)*10,E=()=>{const v=d.value.list;d.value.cost_price=0,d.value.sale_price=0,d.value.purchase_price=0,d.value.market_price=0;for(let t of v)d.value.cost_price+=parseFloat(t.cost_price),d.value.sale_price+=parseFloat(t.sale_price),d.value.purchase_price+=parseFloat(t.purchase_price),d.value.market_price+=parseFloat(t.market_price)},ae=v=>{if(v.length==0)return;const t=k.Loading();V.Post("erp_goods_info/status?lang="+S.lang,{token:S.token,sku:v},s=>{t.clear();const{code:D,msg:O,data:q}=s.data;if(D==0){const K=d.value.list;for(let G in q)for(let L of K)L.sku_id==G&&(L.status=q[G])}else k.Toast(O)})},oe=(v,t=0)=>{if(_.value.type=v,_.value.data=[],v==="part"){const s=B.value.getData();if(s.length==0)return k.Toast("请选择数据");_.value.show=!0,_.value.title="清空",_.value.info="是否移除选中数据?";for(let D of s)_.value.data.unshift({index:D.index})}else(v="one")&&(_.value.show=!0,_.value.title="移除",_.value.info=d.value.list[t].sku_id,_.value.data.unshift({index:t}))},de=()=>{_.value.show=!1;const v=d.value.list,t=_.value.data;for(let s of t)v.splice(s.index,1);ce(),_.value.data=[],E()},ie=()=>{let v=d.value.list,t=[];for(let s of v){if(s.status===0||s.status===1)return k.Toast("请先上传商品资料!");t.push({sku_id:s.sku_id})}if(t.length==0)return k.Toast("请添加或导入商品资料!");S.print.sku=t,S.print.show=!0},ve=()=>{if(d.value.list.length==0)return k.Toast("请添加或导入商品资料!");g.value.s0=g.value.s1=g.value.s2=g.value.s3=g.value.s4=0;let v=d.value.list;for(let t of v)t.status===0?g.value.s0++:t.status===1?g.value.s1++:t.status===2?g.value.s2++:t.status===3?g.value.s3++:t.status===4&&g.value.s4++;if(g.value.s0>0)return k.Toast("该状态不可用!");g.value.show=!0},ue=()=>{let v=[],t=d.value.list;for(let D of t)D.status!=3&&D.status!=4&&v.push(D);if(v.length==0)return k.Toast("无可上传商品资料!");g.value.show=!1,g.value.refresh=!0;const s=k.Loading();V.Post("erp_goods_info/import?lang="+S.lang,{token:S.token,data:v,price:d.value.price.checked},D=>{s.clear();const{code:O,msg:q}=D.data;if(k.Toast(q),O==0){let K=[];for(let G of v)K.push(G.sku_id);ae(K)}})},me=(v,t)=>{const s=B.value.getData();let D="";for(let O in s)D+=s[O][v]+" ";D?le.CopyText(D):le.CopyText(t)},ce=()=>{re(()=>{B.value.checkboxAll(!1)})},_e=()=>{j("update:show",!1),j("submit",g.value.refresh)};return(v,t)=>(T(),R(ne,null,[i(J,{show:$.value,"onUpdate:show":t[8]||(t[8]=s=>$.value=s),title:W.title,width:"calc(100% - 40px)",top:"56px",bottom:"40px",overflow:"hidden auto",onClose:t[9]||(t[9]=s=>_e())},{top:n(()=>[e("div",Qe,[e("ul",Xe,[e("li",null,[i(f,{value:d.value.key,"onUpdate:value":t[0]||(t[0]=s=>d.value.key=s),onKeyup:t[1]||(t[1]=xe(s=>P(),["enter"])),onIconClick:t[2]||(t[2]=s=>P()),placeholder:x(S).langs.sku_id,maxlength:"32",icon:"ui ui_search",iconAlign:"right",padding:"0 40px 0 10px"},null,8,["value","placeholder"])]),e("li",null,[i(he,{options:d.value.price},null,8,["options"])]),t[38]||(t[38]=e("li",null,"|",-1)),e("li",null,[i(I,{type:"primary",effect:"text",padding:"0 4px",onClick:t[3]||(t[3]=s=>u.value.show=!0)},{default:n(()=>t[34]||(t[34]=[U("添加")])),_:1})]),e("li",null,[i(I,{type:"primary",effect:"text",padding:"0 4px",onClick:t[4]||(t[4]=s=>c())},{default:n(()=>t[35]||(t[35]=[U("导入")])),_:1})]),t[39]||(t[39]=e("li",null,"|",-1)),e("li",null,[i(I,{type:"danger",effect:"text",padding:"0 4px",onClick:t[5]||(t[5]=s=>oe("part"))},{default:n(()=>t[36]||(t[36]=[U("移除")])),_:1})]),t[40]||(t[40]=e("li",null,"|",-1)),e("li",null,[i(I,{type:"primary",effect:"text",padding:"0 4px",onClick:t[6]||(t[6]=s=>ie())},{default:n(()=>t[37]||(t[37]=[U("打印标签")])),_:1})])]),e("div",Ze,[t[41]||(t[41]=U(" 成本价: ")),e("b",null,p(x(l)(d.value.cost_price)),1),t[42]||(t[42]=U(" 元   标签价: ")),e("b",null,p(x(l)(d.value.sale_price)),1),t[43]||(t[43]=U(" 元   采购价: ")),e("b",null,p(x(l)(d.value.purchase_price)),1),t[44]||(t[44]=U(" W   吊牌价: ")),e("b",null,p(x(l)(d.value.market_price)),1),t[45]||(t[45]=U(" W   数量: ")),e("b",null,p(d.value.list.length),1),t[46]||(t[46]=U(" 条 "))])])]),bottom:n(()=>[i(I,{height:"40px",padding:"0 32px",onClick:t[7]||(t[7]=s=>ve())},{default:n(()=>t[47]||(t[47]=[U("上传资料")])),_:1})]),default:n(()=>[i(Q,{paddingY:"4px"},{default:n(()=>[i(we,{ref_key:"tableList",ref:B,columns:d.value.columns,options:d.value.list,maxLen:100},{index:n(s=>[e("div",el,p(s.index+1),1)]),sku_id:n(s=>[e("div",ll,[U(p(s.sku_id),1),e("span",{onClick:D=>me("sku_id",s.sku_id)},"复",8,tl)])]),short_name:n(s=>[e("div",al,p(s.short_name||"-"),1)]),i_id:n(s=>[e("div",sl,p(s.i_id||"-"),1)]),cost_price:n(s=>[s.cost_price>0&&s.status!=1?(T(),R("div",ol,"***")):(T(),R("div",il,p(s.cost_price>0?x(l)(s.cost_price):s.cost_price),1))]),supply_price:n(s=>[e("div",ul,p(s.supply_price>0?x(l)(s.supply_price):"-"),1)]),sale_price:n(s=>[e("div",nl,p(s.sale_price>0?x(l)(d.value.price.checked?s.price:s.sale_price):"-"),1)]),purchase_price:n(s=>[s.purchase_price>0&&s.status!=1?(T(),R("div",rl,"***")):(T(),R("div",pl,p(s.purchase_price>0?x(l)(s.purchase_price):s.purchase_price),1))]),supplier_price:n(s=>[e("div",dl,p(s.supplier_price>0?x(l)(s.supplier_price):"-"),1)]),market_price:n(s=>[e("div",vl,p(s.market_price>0?x(l)(s.market_price):"-"),1)]),unit:n(s=>[e("div",ml,p(s.unit||"-"),1)]),weight:n(s=>[e("div",cl,p(s.weight||"-"),1)]),labels:n(s=>[e("div",_l,p(s.labels||"-"),1)]),category:n(s=>[e("div",gl,p(s.category||"-"),1)]),brand:n(s=>[e("div",fl,p(s.brand||"-"),1)]),supplier_name:n(s=>[s.supplier_name&&s.status!=1?(T(),R("div",bl,"***")):(T(),R("div",wl,p(s.supplier_name),1))]),owner:n(s=>[e("div",yl,p(s.owner||"-"),1)]),action:n(s=>[e("div",xl,[i(I,{type:"danger",effect:"text",padding:"0 4px",onClick:D=>oe("one",s.index)},{default:n(()=>[U(p(x(w).remove),1)]),_:2},1032,["onClick"])])]),status:n(s=>[e("div",kl,[s.status==0?(T(),R("span",hl,"检测中")):s.status==1?(T(),R("span",Ul,"可用")):s.status==2?(T(),R("span",$l,"存在")):s.status==3?(T(),R("span",Cl,"已入库")):s.status==4?(T(),R("span",Tl,"已发货")):fe("",!0)])]),_:1},8,["columns","options"])]),_:1})]),_:1},8,["show","title"]),i(J,{show:u.value.show,"onUpdate:show":t[29]||(t[29]=s=>u.value.show=s),title:u.value.title,width:"820px",bottom:"40px",isClose:!0},{bottom:n(()=>[i(I,{height:"40px",padding:"0 32px",onClick:t[28]||(t[28]=s=>r())},{default:n(()=>[U(p(x(w).confirm),1)]),_:1})]),default:n(()=>[i(Q,null,{default:n(()=>[i(pe,null,{default:n(()=>[e("tr",null,[t[48]||(t[48]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品编码")],-1)),e("td",null,[i(f,{value:u.value.sku_id,"onUpdate:value":t[10]||(t[10]=s=>u.value.sku_id=s)},null,8,["value"])]),t[49]||(t[49]=e("td",{class:"label"},[e("span",{class:"red_dot"},"标签")],-1)),e("td",null,[i(z,{value:u.value.labels,"onUpdate:value":t[11]||(t[11]=s=>u.value.labels=s),options:y.value.labels},null,8,["value","options"])])]),e("tr",null,[t[50]||(t[50]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品名称")],-1)),e("td",null,[i(f,{value:u.value.name,"onUpdate:value":t[12]||(t[12]=s=>u.value.name=s)},null,8,["value"])]),t[51]||(t[51]=e("td",{class:"label"},[e("span",{class:"red_dot"},"商品分类")],-1)),e("td",null,[i(z,{value:u.value.category,"onUpdate:value":t[13]||(t[13]=s=>u.value.category=s),options:y.value.category},null,8,["value","options"])])]),e("tr",null,[t[52]||(t[52]=e("td",{class:"label"},[e("span",{class:"red_dot"},"颜色及规格")],-1)),e("td",null,[i(f,{value:u.value.properties_value,"onUpdate:value":t[14]||(t[14]=s=>u.value.properties_value=s)},null,8,["value"])]),t[53]||(t[53]=e("td",{class:"label"},[e("span",{class:"red_dot"},"品牌")],-1)),e("td",null,[i(z,{value:u.value.brand,"onUpdate:value":t[15]||(t[15]=s=>u.value.brand=s),options:y.value.brand},null,8,["value","options"])])]),e("tr",null,[t[54]||(t[54]=e("td",{class:"label"},[e("span",{class:"red_dot"},"成本价(元)")],-1)),e("td",null,[i(f,{value:u.value.cost_price,"onUpdate:value":t[16]||(t[16]=s=>u.value.cost_price=s)},null,8,["value"])]),t[55]||(t[55]=e("td",{class:"label"},[e("span",{class:"red_dot"},"标签价(元)")],-1)),e("td",null,[i(f,{value:u.value.sale_price,"onUpdate:value":t[17]||(t[17]=s=>u.value.sale_price=s)},null,8,["value"])])]),e("tr",null,[t[56]||(t[56]=e("td",{class:"label"},"采购价(w)",-1)),e("td",null,[i(f,{value:u.value.purchase_price,"onUpdate:value":t[18]||(t[18]=s=>u.value.purchase_price=s)},null,8,["value"])]),t[57]||(t[57]=e("td",{class:"label"},"吊牌价(w)",-1)),e("td",null,[i(f,{value:u.value.market_price,"onUpdate:value":t[19]||(t[19]=s=>u.value.market_price=s)},null,8,["value"])])]),e("tr",null,[t[58]||(t[58]=e("td",{class:"label"},"供应链价(元)",-1)),e("td",null,[i(f,{value:u.value.supply_price,"onUpdate:value":t[20]||(t[20]=s=>u.value.supply_price=s)},null,8,["value"])]),t[59]||(t[59]=e("td",{class:"label"},"人民币采购价",-1)),e("td",null,[i(f,{value:u.value.supplier_price,"onUpdate:value":t[21]||(t[21]=s=>u.value.supplier_price=s)},null,8,["value"])])]),e("tr",null,[t[60]||(t[60]=e("td",{class:"label"},"单位",-1)),e("td",null,[i(f,{value:u.value.unit,"onUpdate:value":t[22]||(t[22]=s=>u.value.unit=s)},null,8,["value"])]),t[61]||(t[61]=e("td",{class:"label"},"重量",-1)),e("td",null,[i(f,{value:u.value.weight,"onUpdate:value":t[23]||(t[23]=s=>u.value.weight=s)},null,8,["value"])])]),e("tr",null,[t[62]||(t[62]=e("td",{class:"label"},"暗码",-1)),e("td",null,[i(f,{value:u.value.short_name,"onUpdate:value":t[24]||(t[24]=s=>u.value.short_name=s)},null,8,["value"])]),t[63]||(t[63]=e("td",{class:"label"},"款式编码",-1)),e("td",null,[i(f,{value:u.value.i_id,"onUpdate:value":t[25]||(t[25]=s=>u.value.i_id=s)},null,8,["value"])])]),e("tr",null,[t[64]||(t[64]=e("td",{class:"label"},[e("span",{class:"red_dot"},"采购员")],-1)),e("td",null,[i(f,{value:u.value.owner,"onUpdate:value":t[26]||(t[26]=s=>u.value.owner=s)},null,8,["value"])]),t[65]||(t[65]=e("td",{class:"label"},[e("span",{class:"red_dot"},"供应商")],-1)),e("td",null,[i(f,{value:u.value.supplier_name,"onUpdate:value":t[27]||(t[27]=s=>u.value.supplier_name=s)},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]),i(J,{show:_.value.show,"onUpdate:show":t[31]||(t[31]=s=>_.value.show=s),title:_.value.title,width:"360px",bottom:"40px",isClose:!0},{bottom:n(()=>[i(I,{effect:"dark",type:"danger",height:"40px",onClick:t[30]||(t[30]=s=>de())},{default:n(()=>[U(p(x(w).confirm),1)]),_:1})]),default:n(()=>[i(Q,{lineHeight:"60px"},{default:n(()=>[U(p(_.value.info),1)]),_:1})]),_:1},8,["show","title"]),i(J,{show:g.value.show,"onUpdate:show":t[33]||(t[33]=s=>g.value.show=s),title:g.value.title,width:"480px",bottom:"40px",isClose:!0},{bottom:n(()=>[i(I,{effect:"dark",height:"40px",onClick:t[32]||(t[32]=s=>ue())},{default:n(()=>[U(p(x(w).confirm),1)]),_:1})]),default:n(()=>[i(ke,null,{default:n(()=>t[66]||(t[66]=[U("提醒: 无法覆盖已入库、已发货状态, 如需修改请联系维护人员")])),_:1}),i(Q,{paddingY:"32px",textAlign:"center"},{default:n(()=>[t[67]||(t[67]=U(" 可用( ")),e("b",Al,p(g.value.s1),1),t[68]||(t[68]=U(" )   存在( ")),e("b",Sl,p(g.value.s2),1),t[69]||(t[69]=U(" )   已入库( ")),e("b",Dl,p(g.value.s3),1),t[70]||(t[70]=U(" )   已发货( ")),e("b",Ll,p(g.value.s4),1),t[71]||(t[71]=U(" )   "))]),_:1})]),_:1},8,["show","title"])],64))}}),Pl=X({__name:"exchange",props:{show:{type:Boolean,default:!1},title:{type:String,default:""},data:{type:Object,default:{}},num:{type:Number,default:0}},emits:["update:show","submit"],setup(W,{emit:H}){const b=W,j=H,C=Z().state,S=C.langs,w=A(!1),l=A({from_price:"",to_price:"",rate:""}),$=A({from_price:[{label:"采购价",value:"purchase_price"}],to_price:[{label:"人民币采购价",value:"supplier_price"},{label:"成本价",value:"cost_price"}]});te(()=>b.show,g=>{w.value=g},{deep:!0});const d=g=>!g.from_price||g.from_price.length==0?k.Toast("请选择换算价格"):!g.to_price||g.to_price.length==0?k.Toast("请选择换算成价格"):!g.rate||isNaN(parseFloat(g.rate))?k.Toast("请输入换算比例"):g,u=()=>{const g=d(l.value);if(!g)return;const y=k.Loading();V.Post("erp_goods_info/exchange?lang="+C.lang,{token:C.token,data:b.data,form:g},Y=>{y.clear();const{code:P,msg:r}=Y.data;k.Toast(r),j("submit",P==0)})},_=()=>{j("update:show",!1)};return(g,y)=>(T(),se(J,{show:w.value,"onUpdate:show":y[4]||(y[4]=Y=>w.value=Y),title:W.title,width:"480px",bottom:"40px",onClose:y[5]||(y[5]=Y=>_())},{bottom:n(()=>[i(I,{height:"40px",padding:"0 32px",onClick:y[3]||(y[3]=Y=>u())},{default:n(()=>[U(p(x(S).confirm),1)]),_:1})]),default:n(()=>[i(ke,null,{default:n(()=>[y[6]||(y[6]=U("提醒: 将替换符合条件 ")),e("b",null,p(W.num),1),y[7]||(y[7]=U(" 条数据"))]),_:1}),i(Q,null,{default:n(()=>[i(pe,null,{default:n(()=>[e("tr",null,[y[8]||(y[8]=e("td",{class:"label"},[e("span",{class:"red_dot"},"换算价格")],-1)),e("td",null,[i(z,{value:l.value.from_price,"onUpdate:value":y[0]||(y[0]=Y=>l.value.from_price=Y),options:$.value.from_price},null,8,["value","options"])])]),e("tr",null,[y[9]||(y[9]=e("td",{class:"label"},[e("span",{class:"red_dot"},"换算成")],-1)),e("td",null,[i(z,{value:l.value.to_price,"onUpdate:value":y[1]||(y[1]=Y=>l.value.to_price=Y),options:$.value.to_price},null,8,["value","options"])])]),e("tr",null,[y[10]||(y[10]=e("td",{class:"label"},[e("span",{class:"red_dot"},"换算比率")],-1)),e("td",null,[i(f,{value:l.value.rate,"onUpdate:value":y[2]||(y[2]=Y=>l.value.rate=Y),placeholder:"例如: 1.1"},null,8,["value"])])])]),_:1})]),_:1})]),_:1},8,["show","title"]))}}),Yl={class:"app_action flex"},Wl={class:"app_action_tools scrollbar"},Bl={key:0,class:"line"},Fl={key:0,class:"line"},Nl={class:"app_action_search flex"},Il={class:"custom_time flex_center"},jl=["onClick"],Hl={class:"flex"},Ml={class:"flex"},Ol={class:"flex"},Vl={class:"flex"},El={class:"flex"},Kl={class:"flex"},zl={class:"flex"},ql={class:"flex"},Gl={class:"app_ct"},Jl={class:"tCenter"},Ql={class:"tCenter"},Xl={class:"flex_center"},Zl=["onClick"],et={class:"copy"},lt=["onClick"],tt={class:"tCenter"},at={class:"tCenter"},st={class:"tRight"},ot={key:0},it={key:1},ut={class:"tRight"},nt={class:"tRight"},rt={class:"tRight"},pt={key:0},dt={key:1},vt={class:"tRight"},mt={class:"tRight"},ct={class:"tRight"},_t={class:"tCenter"},gt={class:"tCenter"},ft={class:"tCenter"},bt={key:1},wt={class:"tCenter"},yt={class:"tCenter"},xt={class:"tCenter"},kt={class:"app_page"},At=X({__name:"index",setup(W){const H=A(!1),b=A(),B=Z().state,C=B.langs,S=We.isAction,w=ye.priceEncode,l=A({show:!1,key:"",placeholder:"商品编码",time:[N.Date("Y/m/d",N.StrToTime("-1 month")),N.Date("Y/m/d")],maxDate:N.Date("Y/m/d"),customTime:{active:"",list:[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"3个月",value:"month"},{label:"近1年",value:"year"}]},columns:[{label:"",value:"",slot:"customTime"},{label:C.select,value:"",slot:"time"},{label:"标签",value:"",slot:"labels"},{label:"商品分类",value:"",slot:"category"},{label:"商品编码, 多条空格分离",value:"",name:"sku_id"},{label:"暗码, 多条空格分离",value:"",name:"short_name"},{label:"款式编码, 多条空格分离",value:"",name:"i_id"},{label:"供应商",value:"",name:"supplier_name"},{label1:"开始库存",label2:"例如: -1",value:"",slot:"num"},{label1:"成本价",label2:"例如: 0.00",value:"",slot:"cost_price"},{label1:"供应链价",label2:"例如: 0.00",value:"",slot:"supply_price"},{label1:"标签价",label2:"例如: 0.00",value:"",slot:"sale_price"},{label1:"采购价",label2:"例如: 0.00",value:"",slot:"purchase_price"},{label1:"人民币采购价",label2:"例如: 0.00",value:"",slot:"supplier_price"},{label1:"吊牌价",label2:"例如: 0.00",value:"",slot:"market_price"},{label1:"重量",label2:"例如: 0.00",value:"",slot:"weight"},{label:"商品名称",value:"",name:"name"},{label:"颜色及规格",value:"",name:"properties_value"},{label:"品牌",value:"",name:"brand"},{label:"采购员",value:"",name:"owner"}],labels:"",category:"",num1:"",num2:"",weight1:"",weight2:"",cost_price1:"",cost_price2:"",supply_price1:"",supply_price2:"",sale_price1:"",sale_price2:"",purchase_price1:"",purchase_price2:"",supplier_price1:"",supplier_price2:"",market_price1:"",market_price2:""}),$=A({time:"",list:{num:0,cost_price:0,sale_price:0,purchase_price:0,market_price:0}}),d=A({columns:[{title:"ID",index:"id",slot:"id",width:"100px",textAlign:"center"},{title:C.date,index:"date",slot:"date",width:"90px",textAlign:"center"},{title:C.img,slot:"img",width:"60px",textAlign:"center"},{title:"商品编码",index:"sku_id",slot:"sku_id",order:"",width:"150px",minWidth:"150px",textAlign:"center"},{title:"暗码",index:"short_name",slot:"short_name",order:"",textAlign:"center"},{title:"款式编码",index:"i_id",slot:"i_id",order:"",textAlign:"center"},{title:"商品名称",index:"name",textAlign:"center"},{title:"颜色及规格",index:"properties_value",textAlign:"center"},{title:"成本价(元)",slot:"cost_price",textAlign:"center"},{title:"供应链价(元)",slot:"supply_price",textAlign:"center"},{title:"标签价(元)",slot:"sale_price",textAlign:"center"},{title:"采购价(W)",slot:"purchase_price",textAlign:"center"},{title:"人民币采购价(元)",slot:"supplier_price",textAlign:"center"},{title:"吊牌价(W)",slot:"market_price",textAlign:"center"},{title:"参照价(元)",slot:"other_price",textAlign:"center"},{title:"单位",slot:"unit",textAlign:"center"},{title:"重量",slot:"weight",textAlign:"center"},{title:"折扣",slot:"ratio",textAlign:"center"},{title:C.action,slot:"action",textAlign:"center",width:"40px"},{title:C.view,slot:"view",textAlign:"center",width:"40px"},{title:"库存",slot:"num",textAlign:"center"},{title:"仓库名称",index:"wms_co_name",order:"",textAlign:"center"},{title:"标签",index:"labels",textAlign:"center"},{title:"商品分类",index:"category",textAlign:"center"},{title:"品牌",index:"brand",textAlign:"center"},{title:"供应商",slot:"supplier_name",textAlign:"center"},{title:"采购员",index:"owner",textAlign:"center"}],data:[],num:0,total:0,order:""}),u=A({total:0,num:1,limit:100}),_=A({show:!1,title:"添加/编辑",data:{}}),g=A({show:!1,title:"删除",data:[]}),y=A({show:!1,title:"导出",num:0}),Y=A({show:!1,title:"导入"}),P=A({show:!1,title:"汇率换算"}),r=A({labels:[],category:[]}),c=A({show:!1,index:0,imgs:[]});Ce(()=>{B.token&&L()}),Te(()=>{H&&B.isLogin&&F()});const F=()=>{l.value.show=!1,d.value.data=[];const h=k.Loading();V.Post("erp_goods_info/list?lang="+B.lang,{token:B.token,data:E(),page:u.value.num,limit:u.value.limit,order:d.value.order},o=>{h.clear();const{code:a,msg:m,data:M,time:ee}=o.data;a==0?($.value.time=ee,d.value.data=M,re(()=>ie())):k.Toast(m)}),u.value.total=0,$.value.list.num=0,$.value.list.cost_price=0,$.value.list.sale_price=0,$.value.list.purchase_price=0,$.value.list.market_price=0,V.Post("erp_goods_info/total?lang="+B.lang,{token:B.token,data:E()},o=>{const{code:a,msg:m,data:M,time:ee}=o.data;a==0?($.value.time=ee,u.value.total=M.total,$.value.list.cost_price=M.cost_price,$.value.list.sale_price=M.sale_price,$.value.list.purchase_price=M.purchase_price,$.value.list.market_price=M.market_price,$.value.list.num=M.num):k.Toast(m)})},E=()=>{const h={key:l.value.key,stime:typeof l.value.time[0]=="string"?l.value.time[0]:N.Date("Y/m/d",l.value.time[0]),etime:typeof l.value.time[1]=="string"?l.value.time[1]:N.Date("Y/m/d",l.value.time[1]),labels:l.value.labels,category:l.value.category,num1:l.value.num1,num2:l.value.num2,cost_price1:l.value.cost_price1,cost_price2:l.value.cost_price2,supply_price1:l.value.supply_price1,supply_price2:l.value.supply_price2,sale_price1:l.value.sale_price1,sale_price2:l.value.sale_price2,purchase_price1:l.value.purchase_price1,purchase_price2:l.value.purchase_price2,supplier_price1:l.value.supplier_price1,supplier_price2:l.value.supplier_price2,market_price1:l.value.market_price1,market_price2:l.value.market_price2,weight1:l.value.weight1,weight2:l.value.weight2};for(let o of l.value.columns)o.name&&(h[o.name]=o.value);return h},ae=(h,o)=>{d.value.num=h,d.value.total=o},oe=h=>{d.value.order=h,F()},de=()=>{l.value.time=[N.Date("Y/m/d",N.StrToTime("-1 month")),N.Date("Y/m/d")],l.value.customTime.active="",l.value.key="",l.value.labels="",l.value.category="",l.value.num1="",l.value.num2="",l.value.cost_price1="",l.value.cost_price2="",l.value.supply_price1="",l.value.supply_price2="",l.value.sale_price1="",l.value.sale_price2="",l.value.purchase_price1="",l.value.purchase_price2="",l.value.supplier_price1="",l.value.supplier_price2="",l.value.market_price1="",l.value.market_price2="",l.value.weight1="",l.value.weight2="";for(let h of l.value.columns)h.value="";d.value.order="",u.value.num=1,F()},ie=()=>{re(()=>{b.value.checkboxAll(!1)})},ve=h=>{switch(l.value.customTime.active=h,h){case"today":l.value.time=[N.Date("Y/m/d"),N.Date("Y/m/d")];break;case"yesterday":l.value.time=[N.Date("Y/m/d",N.StrToTime("-1 day")),N.Date("Y/m/d",N.StrToTime("-1 day"))];break;case"month":l.value.time=[N.Date("Y/m/d",N.StrToTime("-3 month")),N.Date("Y/m/d")];break;case"year":l.value.time=[N.Date("Y/m/d",N.StrToTime("-1 year")),N.Date("Y/m/d")];break}},ue=(h,o={})=>{if(_.value.show=!0,_.value.data=o,_.value.data.type=h,h=="edit")_.value.title=C.edit+"( "+o.sku_id+" )",_.value.data.ids=[o.id];else if(h=="edits"){const a=b.value.getData();let m=[],M=[];for(let ee of a)m.push(ee.id),M.push(ee.sku_id);_.value.title=C.edits,_.value.data.ids=m,_.value.data.sku_id=M.join(",")}},me=h=>{h&&(_.value.show=!1,F())},ce=()=>{g.value.show=!0;const h=b.value.getData();let o=[];for(let a of h)o.push(a.id);g.value.data=o},_e=h=>{h&&(g.value.show=!1,F())},v=h=>{y.value.show=!0,y.value.num=h},t=h=>{h&&(y.value.show=!1,ie())},s=()=>{Y.value.show=!0,Y.value.title="商品资料"},D=h=>{h&&F()},O=()=>{P.value.show=!0},q=h=>{h&&(P.value.show=!1,F())},K=h=>{let o=[],a=0;for(let m of d.value.data)m.img&&(m.img==h&&(c.value.index=a),o.push({label:m.sku_id,value:m.img,other:{颜色及规格:m.properties_value,标签价:m.sale_price+"元",吊牌价:m.market_price+"W"}}),a++);c.value.show=!0,c.value.imgs=o},G=(h,o)=>{const a=b.value.getData();let m="";for(let M in a)m+=a[M][h]+" ";m?le.CopyText(m):le.CopyText(o)},L=()=>{V.Post("erp_goods_info/get_select?lang="+B.lang,{token:B.token},h=>{const{code:o,msg:a,data:m}=h.data;o==0?(r.value.labels=m.labels,r.value.category=m.category,H.value=!0):k.Toast(a)})};return(h,o)=>(T(),R(ne,null,[i(Fe,{time:$.value.time,onRefresh:o[0]||(o[0]=a=>F())},{default:n(()=>[o[46]||(o[46]=U(" 成本金额: ")),e("b",null,p(x(w)($.value.list.cost_price)),1),o[47]||(o[47]=U(" 元   标签金额: ")),e("b",null,p(x(w)($.value.list.sale_price)),1),o[48]||(o[48]=U(" 元   采购金额: ")),e("b",null,p(x(w)($.value.list.purchase_price)),1),o[49]||(o[49]=U(" W   吊牌金额: ")),e("b",null,p(x(w)($.value.list.market_price)),1),o[50]||(o[50]=U(" W   库存: ")),e("b",null,p($.value.list.num),1)]),_:1},8,["time"]),e("div",Yl,[e("div",Wl,[i(Re,{columns:[{action:"import",slot:"import",is_action:!0},{action:"save",slot:"edit",is_action:!0},{action:"del",slot:"del",is_action:!0},{action:"line",slot:"line1"},{action:"exchange",slot:"exchange",is_action:!0},{action:"line",slot:"line2"},{action:"export",slot:"export",is_action:!0}]},{import:n(()=>[i(I,{effect:"dark",type:"primary",icon:"ui ui_add",padding:"0 16px 0 8px",onClick:o[1]||(o[1]=a=>s())},{default:n(()=>[U(p(x(C).add),1)]),_:1})]),edit:n(()=>[i(I,{effect:"plain",type:"primary",icon:"ui ui_edit",padding:"0 16px 0 8px",disabled:d.value.num==0,onClick:o[2]||(o[2]=a=>ue("edits"))},{default:n(()=>[U(p(x(C).edits),1)]),_:1},8,["disabled"])]),del:n(()=>[i(I,{effect:"plain",type:"danger",icon:"ui ui_del",padding:"0 16px 0 8px",disabled:d.value.num==0,onClick:o[3]||(o[3]=a=>ce())},{default:n(()=>[U(p(x(C).del)+"("+p(d.value.num)+")",1)]),_:1},8,["disabled"])]),line1:n(()=>[x(S)("import")?(T(),R("span",Bl,"|")):fe("",!0)]),exchange:n(()=>[i(I,{effect:"plain",icon:"ui ui_edit",padding:"0 16px 0 8px",disabled:!u.value.total,onClick:o[4]||(o[4]=a=>O())},{default:n(()=>[U(p(P.value.title)+"("+p(u.value.total)+")",1)]),_:1},8,["disabled"])]),line2:n(()=>[x(S)("exchange")?(T(),R("span",Fl,"|")):fe("",!0)]),export:n(()=>[i(I,{effect:"plain",icon:"ui ui_export",padding:"0 16px 0 8px",disabled:!u.value.total,onClick:o[5]||(o[5]=a=>v(u.value.total))},{default:n(()=>[U(p(x(C).export)+"("+p(u.value.total)+")",1)]),_:1},8,["disabled"])]),_:1})]),e("div",Nl,[i(Pe,{show:l.value.show,"onUpdate:show":o[25]||(o[25]=a=>l.value.show=a),keys:l.value.key,"onUpdate:keys":o[26]||(o[26]=a=>l.value.key=a),columns:l.value.columns,placeholder:l.value.placeholder,onKeyup:o[27]||(o[27]=xe(a=>{u.value.num=1,F()},["enter"])),onSearch:o[28]||(o[28]=a=>{u.value.num=1,F()}),onReset:o[29]||(o[29]=a=>de())},{customTime:n(a=>[e("ul",Il,[(T(!0),R(ne,null,De(l.value.customTime.list,m=>(T(),R("li",{key:m.value,onClick:M=>ve(m.value),class:be({active:l.value.customTime.active===m.value})},p(m.label),11,jl))),128))])]),time:n(a=>[i(Se,{value:l.value.time,"onUpdate:value":o[6]||(o[6]=m=>l.value.time=m),range:"",maxDate:l.value.maxDate,placeholder:a.label},null,8,["value","maxDate","placeholder"])]),labels:n(a=>[i(z,{value:l.value.labels,"onUpdate:value":o[7]||(o[7]=m=>l.value.labels=m),options:r.value.labels,placeholder:a.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),category:n(a=>[i(z,{value:l.value.category,"onUpdate:value":o[8]||(o[8]=m=>l.value.category=m),options:r.value.category,placeholder:a.label,clearable:"",multiple:""},null,8,["value","options","placeholder"])]),num:n(a=>[e("div",Hl,[i(f,{value:l.value.num1,"onUpdate:value":o[9]||(o[9]=m=>l.value.num1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.num2,"onUpdate:value":o[10]||(o[10]=m=>l.value.num2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),cost_price:n(a=>[e("div",Ml,[i(f,{value:l.value.cost_price1,"onUpdate:value":o[11]||(o[11]=m=>l.value.cost_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.cost_price2,"onUpdate:value":o[12]||(o[12]=m=>l.value.cost_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),supply_price:n(a=>[e("div",Ol,[i(f,{value:l.value.supply_price1,"onUpdate:value":o[13]||(o[13]=m=>l.value.supply_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.supply_price2,"onUpdate:value":o[14]||(o[14]=m=>l.value.supply_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),sale_price:n(a=>[e("div",Vl,[i(f,{value:l.value.sale_price1,"onUpdate:value":o[15]||(o[15]=m=>l.value.sale_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.sale_price2,"onUpdate:value":o[16]||(o[16]=m=>l.value.sale_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),purchase_price:n(a=>[e("div",El,[i(f,{value:l.value.purchase_price1,"onUpdate:value":o[17]||(o[17]=m=>l.value.purchase_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.purchase_price2,"onUpdate:value":o[18]||(o[18]=m=>l.value.purchase_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),supplier_price:n(a=>[e("div",Kl,[i(f,{value:l.value.supplier_price1,"onUpdate:value":o[19]||(o[19]=m=>l.value.supplier_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.supplier_price2,"onUpdate:value":o[20]||(o[20]=m=>l.value.supplier_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),market_price:n(a=>[e("div",zl,[i(f,{value:l.value.market_price1,"onUpdate:value":o[21]||(o[21]=m=>l.value.market_price1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.market_price2,"onUpdate:value":o[22]||(o[22]=m=>l.value.market_price2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),weight:n(a=>[e("div",ql,[i(f,{value:l.value.weight1,"onUpdate:value":o[23]||(o[23]=m=>l.value.weight1=m),width:"49%",placeholder:a.label1},null,8,["value","placeholder"]),i(f,{value:l.value.weight2,"onUpdate:value":o[24]||(o[24]=m=>l.value.weight2=m),width:"49%",placeholder:a.label2},null,8,["value","placeholder"])])]),_:1},8,["show","keys","columns","placeholder"])])]),e("div",Gl,[i(we,{ref_key:"tableList",ref:b,overflow:"auto",columns:d.value.columns,options:d.value.data,onOrderBy:oe,onPartially:ae},{id:n(a=>[e("div",Jl,p(a.id),1)]),date:n(a=>[e("div",Ql,[i(Le,{title:"创建: "+a.ctime+`
更新: `+a.utime},{default:n(()=>[U(p(a.utime=="1970-01-01 08:00:00"?a.ctime.substr(0,10):a.utime.substr(0,10)),1)]),_:2},1032,["title"])])]),img:n(a=>[e("div",Xl,[e("span",{onClick:m=>a.img?K(a.img):""},[i(Be,{img:a.img?a.img+"&x-oss-process=image/resize,h_40":"",isView:!1},null,8,["img"])],8,Zl)])]),sku_id:n(a=>[e("div",et,[e("b",null,p(a.sku_id),1),e("span",{onClick:m=>G("sku_id",a.sku_id)},"复",8,lt)])]),short_name:n(a=>[e("div",tt,p(a.short_name||"-"),1)]),i_id:n(a=>[e("div",at,p(a.i_id||"-"),1)]),cost_price:n(a=>[e("div",st,[a.cost_price==="-"?(T(),R("b",ot,"***")):(T(),R("b",it,p(a.cost_price>0?x(w)(a.cost_price):"-"),1))])]),supply_price:n(a=>[e("div",ut,p(a.supply_price>0?x(w)(a.supply_price):"-"),1)]),sale_price:n(a=>[e("div",nt,p(a.sale_price>0?x(w)(a.sale_price):"-"),1)]),purchase_price:n(a=>[e("div",rt,[a.purchase_price==="-"?(T(),R("b",pt,"***")):(T(),R("b",dt,p(a.purchase_price>0?x(w)(a.purchase_price):"-"),1))])]),supplier_price:n(a=>[e("div",vt,p(a.supplier_price>0?x(w)(a.supplier_price):"-"),1)]),market_price:n(a=>[e("div",mt,p(a.market_price>0?x(w)(a.market_price):"-"),1)]),other_price:n(a=>[e("div",ct,p(a.other_price>0?x(w)(a.other_price):"-"),1)]),unit:n(a=>[e("div",_t,p(a.unit||"-"),1)]),weight:n(a=>[e("div",gt,p(a.weight||"-"),1)]),ratio:n(a=>[e("div",{class:be(["tCenter",a.ratio<1?"c_danger":"c_info"])},p(a.ratio),3)]),action:n(a=>[e("div",ft,[x(S)("save")?(T(),se(I,{key:0,onClick:m=>ue("edit",a)},{default:n(()=>[U(p(x(C).edit),1)]),_:2},1032,["onClick"])):(T(),R("span",bt,"-"))])]),view:n(a=>[e("div",wt,[i(I,{type:"primary",effect:"text",padding:"0 4px",onClick:m=>{x(B).goods.show=!0,x(B).goods.sku_id=a.sku_id}},{default:n(()=>[U(p(x(C).flow),1)]),_:2},1032,["onClick"])])]),num:n(a=>[e("div",yt,[e("b",null,p(a.num),1)])]),supplier_name:n(a=>[e("div",xt,p(a.supplier_name==="-"?"***":a.supplier_name),1)]),_:1},8,["columns","options"])]),e("div",kt,[i(Ye,{total:u.value.total,"onUpdate:total":o[30]||(o[30]=a=>u.value.total=a),page:u.value.num,"onUpdate:page":[o[31]||(o[31]=a=>u.value.num=a),o[32]||(o[32]=a=>F())],limit:u.value.limit,"onUpdate:limit":[o[33]||(o[33]=a=>u.value.limit=a),o[34]||(o[34]=a=>{u.value.num=1,F()})]},null,8,["total","page","limit"])]),i(Ke,{show:_.value.show,"onUpdate:show":o[35]||(o[35]=a=>_.value.show=a),title:_.value.title,data:_.value.data,onSubmit:o[36]||(o[36]=a=>me(a))},null,8,["show","title","data"]),i(qe,{show:g.value.show,"onUpdate:show":o[37]||(o[37]=a=>g.value.show=a),data:g.value.data,onSubmit:o[38]||(o[38]=a=>_e(a))},null,8,["show","data"]),i(Je,{show:y.value.show,"onUpdate:show":o[39]||(o[39]=a=>y.value.show=a),data:E(),order:d.value.order,num:y.value.num,onSubmit:o[40]||(o[40]=a=>t(a))},null,8,["show","data","order","num"]),i(Rl,{show:Y.value.show,"onUpdate:show":o[41]||(o[41]=a=>Y.value.show=a),title:Y.value.title,onSubmit:o[42]||(o[42]=a=>D(a))},null,8,["show","title"]),i(Pl,{show:P.value.show,"onUpdate:show":o[43]||(o[43]=a=>P.value.show=a),title:P.value.title,data:E(),num:u.value.total,onSubmit:o[44]||(o[44]=a=>q(a))},null,8,["show","title","data","num"]),i(Ae,{show:c.value.show,"onUpdate:show":o[45]||(o[45]=a=>c.value.show=a),index:c.value.index,options:c.value.imgs},null,8,["show","index","options"])],64))}});export{At as default};
