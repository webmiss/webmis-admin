"use strict";(self["webpackChunkwebmis_vue"]=self["webpackChunkwebmis_vue"]||[]).push([[789],{211:function(e,t,l){l.d(t,{Z:function(){return c}});var a=l(6252),s=l(3577);function i(e,t,l,i,d,n){return(0,a.wg)(),(0,a.iD)("div",{ref:"Tag",class:(0,s.C_)(["wm-tag",e.effect+"_"+e.type]),style:(0,s.j5)({height:e.height,lineHeight:"calc("+e.height+" - 2px)",padding:e.padding,fontSize:e.fontSize})},[(0,a.WI)(e.$slots,"default",{},void 0,!0)],6)}var d=(0,a.aZ)({name:"Tag",props:{effect:{type:String,default:"plain"},type:{type:String,default:"default"},height:{type:String,default:"28px"},padding:{type:String,default:"0 8px"},fontSize:{type:String,default:"12px"}}}),n=l(3744);const o=(0,n.Z)(d,[["render",i],["__scopeId","data-v-019d18ae"]]);var c=o},2594:function(e,t,l){l.d(t,{Z:function(){return L}});var a=l(6252),s=l(3577),i=l(9963);const d=["onClick"],n={class:"wm-tree_arrow"},o=["id"],c={class:"wm-tree_label"},r=["onClick"],h={key:0,class:"wm-tree_arrow"},w={key:1,class:"wm-tree_arrow_none"},m=["id"],p={class:"wm-tree_label"},u=["onClick"],_={key:0,class:"wm-tree_arrow"},k={key:1,class:"wm-tree_arrow_none"},g=["id"],f={class:"wm-tree_label"},y=["onClick"],b={key:0,class:"wm-tree_arrow"},v={key:1,class:"wm-tree_arrow_none"},x=["id"],D={class:"wm-tree_label"},C=["onClick"],Z={key:0,class:"wm-tree_arrow"},W={key:1,class:"wm-tree_arrow_none"},U=["id"],z={class:"wm-tree_label"},S=["onClick"],I={key:0,class:"wm-tree_arrow"},T={key:1,class:"wm-tree_arrow_none"},P=["id"],O={class:"wm-tree_label"};function H(e,t,l,H,K,F){const M=(0,a.up)("wm-checkbox");return(0,a.wg)(),(0,a.iD)("div",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.menus,((t,l)=>((0,a.wg)(),(0,a.iD)("div",{key:l},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"0px"},onClick:e=>t.show=!t.show},[(0,a._)("span",n,(0,s.zw)(t.show?"-":"+"),1),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,a.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((l=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,o),(0,a._)("span",c,(0,s.zw)(t.label),1)],8,d),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.children,((l,d)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"wm-tree_node",key:d},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"16px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,a.wg)(),(0,a.iD)("span",h,(0,s.zw)(l.show?"-":"+"),1)):((0,a.wg)(),(0,a.iD)("span",w)),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,a.Wm)(M,{checked:l.checked,onClick:(0,i.iM)((t=>e.click(l.id,l.checked=!l.checked,l.children)),["stop"])},null,8,["checked","onClick"])],8,m),(0,a._)("span",p,(0,s.zw)(l.label),1)],8,r),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.children,((t,d)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"wm-tree_node",key:d},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"32px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,a.wg)(),(0,a.iD)("span",_,(0,s.zw)(t.show?"-":"+"),1)):((0,a.wg)(),(0,a.iD)("span",k)),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,a.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((l=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,g),(0,a._)("span",f,(0,s.zw)(t.label),1)],8,u),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.children,((l,d)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"wm-tree_node",key:d},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"48px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,a.wg)(),(0,a.iD)("span",b,(0,s.zw)(l.show?"-":"+"),1)):((0,a.wg)(),(0,a.iD)("span",v)),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,a.Wm)(M,{checked:l.checked,onClick:(0,i.iM)((t=>e.click(l.id,l.checked=!l.checked,l.children)),["stop"])},null,8,["checked","onClick"])],8,x),(0,a._)("span",D,(0,s.zw)(l.label),1)],8,y),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.children,((t,d)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"wm-tree_node",key:d},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"64px"},onClick:e=>t.show=!t.show},[t.children&&t.children.length>0?((0,a.wg)(),(0,a.iD)("span",Z,(0,s.zw)(t.show?"-":"+"),1)):((0,a.wg)(),(0,a.iD)("span",W)),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+t.id},[(0,a.Wm)(M,{checked:t.checked,onClick:(0,i.iM)((l=>e.click(t.id,t.checked=!t.checked,t.children)),["stop"])},null,8,["checked","onClick"])],8,U),(0,a._)("span",z,(0,s.zw)(t.label),1)],8,C),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.children,((l,d)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:"wm-tree_node",key:d},[(0,a._)("div",{class:"wm-tree_content",style:{"padding-left":"80px"},onClick:e=>l.show=!l.show},[l.children&&l.children.length>0?((0,a.wg)(),(0,a.iD)("span",I,(0,s.zw)(l.show?"-":"+"),1)):((0,a.wg)(),(0,a.iD)("span",T)),(0,a._)("span",{class:"wm-tree_checkbox",id:"wm-tree_node_"+l.id},[(0,a.Wm)(M,{checked:l.checked,onClick:(0,i.iM)((t=>e.click(l.id,l.checked=!l.checked,l.children)),["stop"])},null,8,["checked","onClick"])],8,P),(0,a._)("span",O,(0,s.zw)(l.label),1)],8,S),(0,a._)("div",{class:(0,s.C_)("wm-tree_node_"+l.id)},null,2)])),[[i.F8,t.show]]))),128))])),[[i.F8,l.show]]))),128))])),[[i.F8,t.show]]))),128))])),[[i.F8,l.show]]))),128))])),[[i.F8,t.show]]))),128))])))),128))])}l(7658);var K=l(501),F=(0,a.aZ)({name:"Tree",components:{wmCheckbox:K.Z},props:{data:{default:[]}},data(){let e=[],t=[],l="";return{menus:e,perms:l,arrs:t}},watch:{data(e){this.menus=e}},methods:{click(e,t,l){this.setCheckbox(e,t),l&&this.setChecked(t,l)},setChecked(e,t){for(let l in t)t[l].checked=e,this.setCheckbox(t[l].id,t[l].checked),t[l].children&&this.setChecked(e,t[l].children)},setCheckbox(e,t){let l=document.querySelector("#wm-tree_node_"+e+" .checked");l&&(t?l.classList.add("active"):l.classList.remove("active"))},getIds(){return this.arrs=[],this.setIds(this.menus),this.arrs},setIds(e){for(let t in e)e[t].children&&this.setIds(e[t].children),e[t].checked&&this.arrs.push(e[t].id)},getPerms(){return this.perms="",this.setPerms(this.menus),this.perms.trim()},setPerms(e){for(let t in e){let l=0;if(e[t].action)for(let a in e[t].children)e[t].children[a].checked&&(l+=parseInt(e[t].children[a].perm));else e[t].children&&this.setPerms(e[t].children);e[t].checked&&(this.perms+=e[t].id+":"+l+" ")}}}}),M=l(3744);const Y=(0,M.Z)(F,[["render",H],["__scopeId","data-v-4532217d"]]);var L=Y},5838:function(e,t,l){l.r(t),l.d(t,{default:function(){return de}});var a=l(6252),s=l(3577),i=l(9963);const d={class:"app_addr flex"},n={class:"addr flex"},o=(0,a._)("span",null,[(0,a._)("i",{class:"ui ui_arrow_right"})],-1),c={class:"app_addr_more flex"},r=(0,a._)("span",{class:"info"}," ",-1),h=(0,a._)("i",{class:"ui ui_refresh"},null,-1),w=[h],m={class:"app_content flex"},p={class:"app_ct_left"},u={class:"app_action_body flex"},_={class:"app_action_list flex_left"},k=(0,a._)("i",{class:"ui ui_search"},null,-1),g=(0,a._)("li",{class:"line"},"|",-1),f={key:0},y={key:1},b={key:2},v={class:"app_action_list flex_left"},x=(0,a._)("li",{class:"line"},"|",-1),D={class:"app_table scrollbar"},C={width:"60"},Z={width:"120"},W={width:"100"},U=(0,a._)("td",{width:"60",class:"tCenter"},"权限",-1),z=(0,a._)("td",null,"权限值",-1),S={width:"30",class:"checkbox wm-table_checkbox"},I={class:"tCenter"},T={key:2},P={key:0},O=(0,a._)("td",{height:"160",class:"null",colspan:"6"},null,-1),H=[O],K=(0,a._)("td",{class:"lable"},"名称",-1),F=(0,a._)("td",{class:"lable"},"名称",-1);function M(e,t,l,h,O,M){const Y=(0,a.up)("wm-input"),L=(0,a.up)("wm-search"),q=(0,a.up)("wm-button"),B=(0,a.up)("wm-table-order"),$=(0,a.up)("wm-checkbox"),j=(0,a.up)("wm-tag"),J=(0,a.up)("wm-table"),N=(0,a.up)("wm-page"),R=(0,a.up)("wm-table-form"),A=(0,a.up)("wm-dialog"),E=(0,a.up)("wm-row"),V=(0,a.up)("wm-tree");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",d,[(0,a._)("div",n,[(0,a._)("span",null,(0,s.zw)(e.state.menuTitle[1]),1),o,(0,a._)("span",{class:"link",onClick:t[0]||(t[0]=t=>e.$router.replace({path:"/refresh"}))},(0,s.zw)(e.state.menuTitle[2]),1)]),(0,a._)("div",c,[r,(0,a._)("span",{class:"reload",title:"刷新",onClick:t[1]||(t[1]=t=>e.loadData())},w)])]),(0,a._)("div",m,[(0,a.wy)((0,a._)("div",p,[(0,a.Wm)(L,{show:e.sea.show,"onUpdate:show":t[4]||(t[4]=t=>e.sea.show=t),"onUpdate:submit":t[5]||(t[5]=t=>e.subSea())},{default:(0,a.w5)((()=>[(0,a._)("li",null,[(0,a.Wm)(Y,{value:e.sea.form.name,"onUpdate:value":t[2]||(t[2]=t=>e.sea.form.name=t),maxlength:"16",placeholder:"角色名称",clearable:"",onKeyup:t[3]||(t[3]=(0,i.D2)((t=>e.subSea()),["enter"]))},null,8,["value"])])])),_:1},8,["show"])],512),[[i.F8,e.sea.show]]),(0,a._)("div",{class:"app_ct_right",style:(0,s.j5)({width:e.sea.show?"calc(100% - 260px)":""})},[(0,a._)("div",u,[(0,a._)("ul",_,[(0,a._)("li",null,[(0,a.Wm)(q,{type:"primary",effect:"text",padding:"0 4px",class:"flex",onClick:t[6]||(t[6]=t=>e.sea.show=!e.sea.show)},{default:(0,a.w5)((()=>[k,(0,a.Uk)(" 搜索")])),_:1})]),g,e.getters.actionShow("add")?((0,a.wg)(),(0,a.iD)("li",f,[(0,a.Wm)(q,{effect:"text",padding:"0 4px",onClick:t[7]||(t[7]=t=>e.add.show=!0)},{default:(0,a.w5)((()=>[(0,a.Uk)("添加")])),_:1})])):(0,a.kq)("",!0),e.getters.actionShow("edit")?((0,a.wg)(),(0,a.iD)("li",y,[(0,a.Wm)(q,{type:"primary",effect:"text",padding:"0 4px",onClick:t[8]||(t[8]=t=>e.editData())},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:1})])):(0,a.kq)("",!0),e.getters.actionShow("del")?((0,a.wg)(),(0,a.iD)("li",b,[(0,a.Wm)(q,{type:"danger",effect:"text",padding:"0 4px",onClick:t[9]||(t[9]=t=>e.delData())},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:1})])):(0,a.kq)("",!0)]),(0,a._)("ul",v,[(0,a._)("li",null,[(0,a.Wm)(q,{type:"primary",effect:"text",padding:"0 2px"},{default:(0,a.w5)((()=>[(0,a.Uk)("导出")])),_:1})]),x,(0,a._)("li",null,[(0,a.Wm)(q,{type:"primary",effect:"text",padding:"0 2px"},{default:(0,a.w5)((()=>[(0,a.Uk)("打印")])),_:1})])])]),(0,a._)("div",D,[(0,a.Wm)(J,{ref:"Table",data:e.page.list},{title:(0,a.w5)((()=>[(0,a._)("td",C,[(0,a.Uk)("ID"),(0,a.Wm)(B,{value:e.oby.list.id,"onUpdate:value":t[10]||(t[10]=t=>e.OrderBy("id",t))},null,8,["value"])]),(0,a._)("td",Z,[(0,a.Uk)("名称"),(0,a.Wm)(B,{value:e.oby.list.name,"onUpdate:value":t[11]||(t[11]=t=>e.OrderBy("name",t))},null,8,["value"])]),(0,a._)("td",W,[(0,a.Uk)("更新时间"),(0,a.Wm)(B,{value:e.oby.list.utime,"onUpdate:value":t[12]||(t[12]=t=>e.OrderBy("utime",t))},null,8,["value"])]),U,z])),default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.page.list,((t,l)=>((0,a.wg)(),(0,a.iD)("tr",{key:l},[(0,a._)("td",S,[(0,a.Wm)($,{value:t.id},null,8,["value"])]),(0,a._)("td",null,(0,s.zw)(t.id),1),(0,a._)("td",null,[(0,a._)("b",null,(0,s.zw)(t.name),1)]),(0,a._)("td",null,[(0,a.Wm)(j,{size:"medium",title:"创建: "+t.ctime+"\n更新: "+t.utime},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.utime.substr(0,10)),1)])),_:2},1032,["title"])]),(0,a._)("td",I,[e.getters.actionShow("perm")&&!t.perm?((0,a.wg)(),(0,a.j4)(q,{key:0,type:"danger",effect:"text",padding:"0 4px",onClick:l=>e.permData(t.id,t.perm)},{default:(0,a.w5)((()=>[(0,a.Uk)("设置")])),_:2},1032,["onClick"])):e.getters.actionShow("perm")?((0,a.wg)(),(0,a.j4)(q,{key:1,type:"primary",effect:"text",padding:"0 4px",onClick:l=>e.permData(t.id,t.perm)},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"])):((0,a.wg)(),(0,a.iD)("span",T,"-"))]),(0,a._)("td",null,(0,s.zw)(t.perm),1)])))),128)),0==e.page.list.length?((0,a.wg)(),(0,a.iD)("tr",P,H)):(0,a.kq)("",!0)])),_:1},8,["data"])]),(0,a.Wm)(N,{page:e.page.page,limit:e.page.limit,total:e.page.total,"onUpdate:page":e.subPage},null,8,["page","limit","total","onUpdate:page"])],4)]),(0,a.Wm)(A,{title:"添加",width:"420px",show:e.add.show,"onUpdate:show":t[15]||(t[15]=t=>e.add.show=t)},{footer:(0,a.w5)((()=>[(0,a.Wm)(q,{type:"primary",onClick:t[14]||(t[14]=t=>e.subAdd())},{default:(0,a.w5)((()=>[(0,a.Uk)("确 认")])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a._)("tr",null,[K,(0,a._)("td",null,[(0,a.Wm)(Y,{value:e.add.form.name,"onUpdate:value":t[13]||(t[13]=t=>e.add.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])])),_:1})])),_:1},8,["show"]),(0,a.Wm)(A,{title:"编辑",width:"420px",show:e.edit.show,"onUpdate:show":t[18]||(t[18]=t=>e.edit.show=t)},{footer:(0,a.w5)((()=>[(0,a.Wm)(q,{type:"primary",onClick:t[17]||(t[17]=t=>e.subEdit())},{default:(0,a.w5)((()=>[(0,a.Uk)("确 认")])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a._)("tr",null,[F,(0,a._)("td",null,[(0,a.Wm)(Y,{value:e.edit.form.name,"onUpdate:value":t[16]||(t[16]=t=>e.edit.form.name=t),maxlength:"16",placeholder:"角色名称"},null,8,["value"])])])])),_:1})])),_:1},8,["show"]),(0,a.Wm)(A,{title:"删除",width:"360px",show:e.del.show,"onUpdate:show":t[20]||(t[20]=t=>e.del.show=t)},{footer:(0,a.w5)((()=>[(0,a.Wm)(q,{type:"danger",onClick:t[19]||(t[19]=t=>e.subDel())},{default:(0,a.w5)((()=>[(0,a.Uk)("彻底删除")])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Uk)("是否删除已选择数据？")])),_:1})])),_:1},8,["show"]),(0,a.Wm)(A,{title:"权限",width:"540px",show:e.perm.show,"onUpdate:show":t[22]||(t[22]=t=>e.perm.show=t)},{footer:(0,a.w5)((()=>[(0,a.Wm)(q,{type:"primary",onClick:t[21]||(t[21]=t=>e.subPerm())},{default:(0,a.w5)((()=>[(0,a.Uk)("确 认")])),_:1})])),default:(0,a.w5)((()=>[(0,a.Wm)(V,{ref:"perm",data:e.perm.permList},null,8,["data"])])),_:1},8,["show"])])}var Y=l(3907),L=l(8907),q=l(6492),B=l(5783),$=l(2367),j=l(7355),J=l(6615),N=l(1566),R=l(6341),A=l(6534),E=l(3098),V=l(501),G=l(1080),Q=l(8549),X=l(9269),ee=l(6308),te=l(2594),le=l(211),ae=(0,a.aZ)({components:{wmSearch:j.Z,wmMain:J.Z,wmRow:N.Z,wmTable:R.Z,wmTableForm:A.Z,wmTableOrder:E.Z,wmCheckbox:V.Z,wmDialog:G.Z,wmInput:Q.Z,wmButton:X.Z,wmPage:ee.Z,wmTree:te.Z,wmTag:le.Z},data(){const e=(0,Y.oR)(),t=e.state,l=e.getters,a={list:[],page:1,limit:20,total:0},s={show:!1,form:{}},i={name:"",list:{id:"",name:"",utime:""}},d={show:!1,form:{}},n={show:!1,id:"",form:{}},o={show:!1,ids:""},c={show:!1,id:"",perm:"",permList:[]};return{state:t,getters:l,page:a,sea:s,oby:i,add:d,edit:n,del:o,perm:c}},mounted(){$.Z.getItem("token")&&this.loadData()},methods:{loadData(){this.page.list=[],this.page.total=0;const e=(0,L.Z)();(0,B.Z)("api_role/list",{token:$.Z.getItem("token"),page:this.page.page,limit:this.page.limit,data:JSON.stringify(this.sea.form),order:this.oby.name},(t=>{e.clear();const l=t.data;if(0!=l.code)return(0,q.Z)(l.msg);this.page.list=l.list,this.page.total=l.total}))},subPage(e){this.page.page=e,this.loadData()},subSea(){this.page.page=1,this.loadData()},OrderBy(e,t){for(let l in this.oby.list)this.oby.list[l]=l==e?t:"";this.oby.name=t?e+" "+t:"",this.loadData()},subAdd(){this.add.show=!1;const e=JSON.stringify(this.add.form),t=(0,L.Z)();(0,B.Z)("api_role/add",{token:$.Z.getItem("token"),data:e},(e=>{t.clear();const l=e.data;return 0===l.code&&this.loadData(),(0,q.Z)(l.msg)}))},editData(){const e=this.$refs.Table,t=e.getRow();if(!t)return(0,q.Z)("请选择数据!");this.edit.show=!0,this.edit.id=t.id,this.edit.form.name=t.name},subEdit(){this.edit.show=!1;const e=this.edit.id,t=JSON.stringify(this.edit.form),l=(0,L.Z)();(0,B.Z)("api_role/edit",{token:$.Z.getItem("token"),id:e,data:t},(e=>{l.clear();const t=e.data;return 0===t.code&&this.loadData(),(0,q.Z)(t.msg)}))},delData(){const e=this.$refs.Table,t=e.getVals();if(!t)return(0,q.Z)("请选择数据!");this.del.show=!0,this.del.ids=JSON.stringify(t)},subDel(){this.del.show=!1;const e=(0,L.Z)();(0,B.Z)("api_role/del",{token:$.Z.getItem("token"),data:this.del.ids},(t=>{e.clear();const l=t.data;return 0===l.code&&this.loadData(),(0,q.Z)(l.msg)}))},permData(e,t){this.perm.show=!0,this.perm.id=e;const l=(0,L.Z)();(0,B.Z)("api_role/permList",{token:$.Z.getItem("token"),perm:t||""},(e=>{l.clear();const t=e.data;0===t.code?this.perm.permList=t.list:(0,q.Z)(t.msg)}))},subPerm(){this.perm.show=!1;const e=this.$refs.perm,t=(0,L.Z)();(0,B.Z)("api_role/perm",{token:$.Z.getItem("token"),id:this.perm.id,perm:e.getPerms()},(e=>{t.clear();const l=e.data;return 0===l.code&&this.loadData(),(0,q.Z)(l.msg)}))}}}),se=l(3744);const ie=(0,se.Z)(ae,[["render",M]]);var de=ie}}]);